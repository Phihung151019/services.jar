.class public final Lcom/android/server/power/stats/BatteryStatsImpl;
.super Landroid/os/BatteryStats;
.source "qb/104190634 8d7d8e6ef21e39a67cd47e062606d74a8e3763a481f56c365f28d7adc1854ed1"


# static fields
.field public static final CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

.field public static final MAX_WAKELOCKS_PER_UID:I

.field protected static final MOBILE_RADIO_POWER_STATE_UPDATE_FREQ_MS:J = 0x927c0L

.field public static final MODEM_TX_POWER_LEVEL_COUNT:I

.field public static final SUPPORTED_PER_PROCESS_STATE_STANDARD_ENERGY_BUCKETS:[I

.field public static final WAKE_LOCK_WEIGHT:I = 0x32

.field public static final ZERO_LONG_COUNTER:Lcom/android/server/power/stats/BatteryStatsImpl$1;

.field public static final ZERO_LONG_COUNTER_ARRAY:[Landroid/os/BatteryStats$LongCounter;

.field public static final sPrefixPatternSplit:Ljava/util/regex/Pattern;


# instance fields
.field public mAccumulateBatteryUsageStats:Z

.field public final mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

.field public mActiveRat:I

.field public mAlarmManager:Landroid/app/AlarmManager;

.field public mAp_temp:I

.field public mAudioOnNesting:I

.field public mAudioOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mAudioTurnedOnTimers:Ljava/util/ArrayList;

.field public mAutoBrightnessMode:Z

.field public mBatteryCC:I

.field public mBatteryChargeUah:I

.field public mBatteryHealth:I

.field public final mBatteryHistoryDirectory:Lcom/android/server/power/stats/BatteryHistoryDirectory;

.field public mBatteryLevel:I

.field public mBatteryPlugType:I

.field public mBatteryPluggedIn:Z

.field public mBatteryPluggedInRealTimeMs:J

.field public mBatteryRaw:I

.field public mBatterySecCurrentEvent:I

.field public mBatterySecEvent:I

.field public mBatterySecOnline:I

.field public mBatterySecTxShareEvent:I

.field public final mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

.field protected final mBatteryStatsConfig:Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;

.field public mBatteryStatus:I

.field public mBatteryTemperature:I

.field public mBatteryTimeToFullSeconds:J

.field public mBatteryUsageStatsProvider:Lcom/android/server/power/stats/BatteryUsageStatsProvider;

.field public mBatteryVoltageMv:I

.field public mBinderThreadCpuTimesUs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

.field public mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

.field public mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

.field public final mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

.field public mBluetoothScanNesting:I

.field public final mBluetoothScanOnTimers:Ljava/util/ArrayList;

.field public mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mCallback:Lcom/android/server/am/ActivityManagerService;

.field public mCameraOnNesting:I

.field public mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

.field public final mCameraTurnedOnTimers:Ljava/util/ArrayList;

.field public final mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

.field public mCharging:Z

.field public final mCheckinFile:Landroid/util/AtomicFile;

.field public final mClock:Lcom/android/internal/os/Clock;

.field protected final mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

.field public mCoverDisplayHrrBin:I

.field public final mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mCpuPowerBracketMap:[I

.field public mCpuPowerCalculator:Lcom/android/server/power/stats/CpuPowerCalculator;

.field public final mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

.field protected mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

.field public final mCpuTimeReadsTrackingStartTimeMs:J

.field protected mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

.field protected mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

.field protected mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

.field protected mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

.field public mCurStepMode:I

.field public mCurrent:I

.field public final mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

.field public mCustomTelephonyCallback:Lcom/android/server/power/stats/BatteryStatsImpl$CustomTelephonyCallback;

.field public final mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

.field public final mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

.field public final mDailyFile:Landroid/util/AtomicFile;

.field public final mDailyItems:Ljava/util/ArrayList;

.field public mDailyPackageChanges:Ljava/util/ArrayList;

.field public mDailyStartTimeMs:J

.field public final mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

.field public mDeviceIdleMode:I

.field public mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mDeviceIdling:Z

.field public mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mDeviceLightIdling:Z

.field public mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mDischargeAmountScreenDoze:I

.field public mDischargeAmountScreenDozeSinceCharge:I

.field public mDischargeAmountScreenDozeSinceChargePermil:I

.field public mDischargeAmountScreenOff:I

.field public mDischargeAmountScreenOffSinceCharge:I

.field public mDischargeAmountScreenOffSinceChargeCoulombCounter:I

.field public mDischargeAmountScreenOffSinceChargePermil:I

.field public mDischargeAmountScreenOn:I

.field public mDischargeAmountScreenOnSinceCharge:I

.field public mDischargeAmountScreenOnSinceChargeCoulombCounter:I

.field public mDischargeAmountScreenOnSinceChargePermil:I

.field public mDischargeAmountSilentOnScreenOffSinceChargePermil:I

.field public mDischargeAmountSilentOnScreenOnSinceChargePermil:I

.field public mDischargeAmountSubScreenDozeSinceChargePermil:I

.field public mDischargeAmountSubScreenOnSinceChargePermil:I

.field public mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mDischargeCurrentLevel:I

.field public mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mDischargePlugLevel:I

.field public mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mDischargeScreenDozeUnplugLevel:I

.field public mDischargeScreenDozeUnplugLevelPermil:I

.field public mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mDischargeScreenOffUnplugLevel:I

.field public mDischargeScreenOffUnplugLevelCoulombCounter:I

.field public mDischargeScreenOffUnplugLevelPermil:I

.field public mDischargeScreenOnUnplugLevel:I

.field public mDischargeScreenOnUnplugLevelCoulombCounter:I

.field public mDischargeScreenOnUnplugLevelPermil:I

.field public mDischargeSilentOnScreenOffUnplugLevelPermil:I

.field public mDischargeSilentOnScreenOnUnplugLevelPermil:I

.field public final mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

.field public mDischargeSubScreenDozeUnplugLevelPermil:I

.field public mDischargeSubScreenOnUnplugLevelPermil:I

.field public mDischargeUnplugLevel:I

.field public mDisplayId:I

.field public mDisplayMismatchWtfCount:I

.field public final mDrawTimers:Ljava/util/ArrayList;

.field public mEndPlatformVersion:Ljava/lang/String;

.field public final mEnergyConsumerRetriever:Lcom/android/server/am/BatteryStatsService;

.field protected mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

.field public mEstimatedBatteryCapacityMah:I

.field public mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

.field public mFeatureComputeChargeTimeModel:Z

.field public mFlashlightOnNesting:I

.field public mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mFlashlightTurnedOnTimers:Ljava/util/ArrayList;

.field public final mFrameworkEvents:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

.field public final mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

.field public final mFullTimers:Ljava/util/ArrayList;

.field public final mFullWifiLockTimers:Ljava/util/ArrayList;

.field protected mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

.field public mGlobalWifiRunning:Z

.field public mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

.field public mGpsNesting:I

.field public mGpsSignalQualityBin:I

.field public final mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

.field public mHasBluetoothReporting:Z

.field public mHasModemReporting:Z

.field public mHasSpeakerOutReporting:Z

.field public mHasWifiReporting:Z

.field public mHaveBatteryLevel:Z

.field public mHighDischargeAmountSinceCharge:I

.field public final mHistory:Lcom/android/internal/os/BatteryStatsHistory;

.field public mHotspotState:I

.field public mIgnoreNextExternalStats:Z

.field public mInitStepMode:I

.field public mInteractive:Z

.field public mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mIsCoulombCounterReported:Z

.field public final mIsRawSocReported:Z

.field public mIsServiceStateNr:Z

.field public mIsSilentLogOn:Z

.field protected mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

.field public mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

.field public final mKernelMemoryBandwidthStats:Lcom/android/internal/os/KernelMemoryBandwidthStats;

.field public final mKernelMemoryStats:Landroid/util/LongSparseArray;

.field protected mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

.field protected mKernelWakelockReader:Lcom/android/server/power/stats/KernelWakelockReader;

.field public final mKernelWakelockStats:Ljava/util/HashMap;

.field public mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

.field public mLastBatteryCCUpdateTime:J

.field public mLastBatteryRawUpdateTime:J

.field public final mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

.field public mLastCallbackTime:J

.field public mLastChargeStepLevel:I

.field public mLastDischargeStepLevel:I

.field public mLastIdleTimeStartMs:J

.field public mLastLearnedBatteryCapacityUah:I

.field public mLastModemActivityInfo:Landroid/telephony/ModemActivityInfo;

.field public mLastModemNetworkStats:Landroid/net/NetworkStats;

.field protected mLastPartialTimers:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList<",
            "Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;",
            ">;"
        }
    .end annotation
.end field

.field public mLastRpmStatsUpdateTimeMs:J

.field public mLastWakeupElapsedTimeMs:J

.field public mLastWakeupReason:Ljava/lang/String;

.field public mLastWakeupUptimeMs:J

.field public mLastWifiNetworkStats:Landroid/net/NetworkStats;

.field public mLastWriteTimeMs:J

.field public final mLongPlugInAlarmHandler:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda8;

.field public mLongestFullIdleTimeMs:J

.field public mLongestLightIdleTimeMs:J

.field public mLowDischargeAmountSinceCharge:I

.field public mMainDisplayHrrBin:I

.field public final mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mMaxChargeStepLevel:I

.field public mMaxLearnedBatteryCapacityUah:I

.field public mMinDischargeStepLevel:I

.field public mMinLearnedBatteryCapacityUah:I

.field public mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mMobileRadioActiveStartTimeMs:J

.field public mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

.field public mMobileRadioPowerState:I

.field public final mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

.field public mModStepMode:I

.field public mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

.field public mModemIfaces:[Ljava/lang/String;

.field public final mModemNetworkLock:Ljava/lang/Object;

.field public final mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

.field public mMonotonicStartTime:J

.field public mMoveWscLoggingToNotifierEnabled:Z

.field public final mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

.field public final mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public final mNetworkStatsDeltaMap:Ljava/util/HashMap;

.field public mNextMaxDailyDeadlineMs:J

.field public mNextMinDailyDeadlineMs:J

.field public mNoAutoReset:Z

.field public mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mNrState:I

.field public mNumAllUidCpuTimeReads:I

.field public mNumConnectivityChange:I

.field public mNumSingleUidCpuTimeReads:J

.field public mNumUidsRemoved:I

.field public mOnBattery:Z

.field protected mOnBatteryInternal:Z

.field public final mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

.field public final mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

.field public mOtgOnline:I

.field public mPa_temp:I

.field protected mPartialTimers:Ljava/util/ArrayList;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/ArrayList<",
            "Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;",
            ">;"
        }
    .end annotation
.end field

.field protected mPendingRemovedUids:Ljava/util/Queue;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "Ljava/util/Queue<",
            "Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;",
            ">;"
        }
    .end annotation
.end field

.field public mPendingReportCharging:Z

.field public final mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

.field public mPerProcStateCpuTimesAvailable:Z

.field public final mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

.field public mPhoneDataConnectionType:I

.field public final mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mPhoneOn:Z

.field public mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mPhoneServiceState:I

.field public mPhoneServiceStateRaw:I

.field public mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mPhoneSignalStrengthBin:I

.field public mPhoneSignalStrengthBinRaw:I

.field public final mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mPhoneSimStateRaw:I

.field public final mPlatformIdleStateCallback:Lcom/android/server/am/BatteryStatsService;

.field public final mPowerManagerFlags:Lcom/android/server/power/feature/PowerManagerFlags;

.field public final mPowerProfile:Lcom/android/internal/os/PowerProfile;

.field public mPowerSaveModeEnabled:Z

.field public mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

.field public final mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

.field public mPowerStatsStore:Lcom/android/server/power/stats/PowerStatsStore;

.field protected final mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

.field public mPretendScreenOff:Z

.field public mProtectBatteryMode:I

.field public mRealtimeStartUs:J

.field public mRealtimeUs:J

.field public mRecordAllHistory:Z

.field public final mRpmStats:Ljava/util/HashMap;

.field public mSaveBatteryUsageStatsOnReset:Z

.field public final mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mScreenBrightnessBin:I

.field public final mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mScreenHighBrightness:Z

.field public mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

.field public final mScreenOffRpmStats:Ljava/util/HashMap;

.field public mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

.field protected mScreenState:I

.field public final mScreenUsageTimeRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

.field public final mScreenWakeStats:Ljava/util/HashMap;

.field public final mSensorTimers:Landroid/util/SparseArray;

.field public mShuttingDown:Z

.field public mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSkin_temp:I

.field public final mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public final mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

.field public mStartClockTimeMs:J

.field public mStartCount:I

.field public mStartPlatformVersion:Ljava/lang/String;

.field public final mStatsFile:Landroid/util/AtomicFile;

.field public final mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

.field public final mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mSubScreenPolicy:I

.field public mSubScreenState:I

.field public final mSub_batt_temp:I

.field public mSystemDir:Ljava/io/File;

.field public mSystemReady:Z

.field protected mSystemServerCpuThreadReader:Lcom/android/server/power/stats/SystemServerCpuThreadReader;

.field public mSystemServicesReady:Z

.field public mTelephonyManager:Landroid/telephony/TelephonyManager;

.field public mTempTotalCpuSystemTimeUs:J

.field public mTempTotalCpuUserTimeUs:J

.field public mTmpCpuTimeInFreq:[J

.field public final mTmpRailStats:Lcom/android/internal/os/RailStats;

.field public mTmpRpmStats:Lcom/android/internal/os/RpmStats;

.field public final mTmpWakelockStats:Lcom/android/server/power/stats/KernelWakelockStats;

.field public final mTopAppStats:Ljava/util/concurrent/ConcurrentHashMap;

.field public mTxPowerSharingDischargeMah:J

.field public mTxPowerSharingOn:Z

.field public mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mUidStats:Landroid/util/SparseArray;

.field public mUptimeStartUs:J

.field public mUptimeUs:J

.field public mUsbDataState:I

.field protected mUserInfoProvider:Lcom/android/server/power/stats/BatteryStatsImpl$UserInfoProvider;

.field public mVideoOnNesting:I

.field public mVideoOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mVideoTurnedOnTimers:Ljava/util/ArrayList;

.field public mWakeLockAllocationsUs:[[J

.field public mWakeLockImportant:Z

.field public mWakeLockNesting:I

.field public final mWakelockDurationRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

.field public final mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

.field public final mWakeupReasonStats:Ljava/util/HashMap;

.field public mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

.field public final mWifiBatchedScanTimers:Landroid/util/SparseArray;

.field public mWifiFullLockNesting:I

.field public mWifiIfaces:[Ljava/lang/String;

.field public mWifiMulticastNesting:I

.field public final mWifiMulticastTimers:Ljava/util/ArrayList;

.field public mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mWifiNetworkLock:Ljava/lang/Object;

.field public mWifiOn:Z

.field public mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

.field public final mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

.field public mWifiRadioPowerState:I

.field public final mWifiRunningTimers:Ljava/util/ArrayList;

.field public mWifiScanNesting:I

.field public final mWifiScanTimers:Ljava/util/ArrayList;

.field public mWifiSignalStrengthBin:I

.field public final mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public mWifiState:I

.field public final mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mWifiStatsRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

.field public mWifiSupplState:I

.field public final mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

.field public final mWindowTimers:Ljava/util/ArrayList;

.field public final mWriteAsyncRunnable:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

.field public final mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;


# direct methods
.method public static $r8$lambda$4oR0MyxxkPH0JSQXqVxAZgbHyhc(Lcom/android/server/power/stats/BatteryStatsImpl;Lcom/android/internal/os/PowerStats;)V
    .locals 7

    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    iget-wide v0, p1, Lcom/android/internal/os/PowerStats;->durationMs:J

    const-wide/16 v2, 0x0

    cmp-long v0, v0, v2

    if-lez v0, :cond_0

    monitor-enter p0

    :try_start_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    move-object v6, p1

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordPowerStats(JJLcom/android/internal/os/PowerStats;)V

    monitor-exit p0

    return-void

    :catchall_0
    move-exception v0

    move-object p1, v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw p1

    :cond_0
    return-void
.end method

.method public static -$$Nest$mretrieveBluetoothScanTimesLocked(Lcom/android/server/power/stats/BatteryStatsImpl;Lcom/android/server/power/stats/BluetoothPowerStatsCollector$$ExternalSyntheticLambda0;)V
    .locals 10

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    const-wide/16 v2, 0x3e8

    mul-long/2addr v0, v2

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    add-int/lit8 v4, v4, -0x1

    :goto_0
    if-ltz v4, :cond_3

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5, v4}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v5, :cond_0

    goto :goto_1

    :cond_0
    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 v6, 0x0

    invoke-virtual {v5, v0, v1, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v5

    const-wide/16 v7, 0x0

    cmp-long v7, v5, v7

    if-eqz v7, :cond_2

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v7, v4}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v7

    const-wide/16 v8, 0x1f4

    add-long/2addr v5, v8

    div-long/2addr v5, v2

    iget-object v8, p1, Lcom/android/server/power/stats/BluetoothPowerStatsCollector$$ExternalSyntheticLambda0;->f$0:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    iget-object v9, v8, Lcom/android/server/power/stats/PowerStatsCollector;->mUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v9, v7}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v7

    iget-object v9, v8, Lcom/android/server/power/stats/BluetoothPowerStatsCollector;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v9, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BluetoothPowerStatsCollector$UidStats;

    if-nez v9, :cond_1

    new-instance v9, Lcom/android/server/power/stats/BluetoothPowerStatsCollector$UidStats;

    invoke-direct {v9}, Ljava/lang/Object;-><init>()V

    iget-object v8, v8, Lcom/android/server/power/stats/BluetoothPowerStatsCollector;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v8, v7, v9}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    :cond_1
    iget-wide v7, v9, Lcom/android/server/power/stats/BluetoothPowerStatsCollector$UidStats;->scanTime:J

    add-long/2addr v7, v5

    iput-wide v7, v9, Lcom/android/server/power/stats/BluetoothPowerStatsCollector$UidStats;->scanTime:J

    :cond_2
    :goto_1
    add-int/lit8 v4, v4, -0x1

    goto :goto_0

    :cond_3
    return-void
.end method

.method public static -$$Nest$mretrieveWifiScanTimesLocked(Lcom/android/server/power/stats/BatteryStatsImpl;Lcom/android/server/power/stats/WifiPowerStatsCollector$$ExternalSyntheticLambda1;)V
    .locals 22

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v1

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    add-int/lit8 v5, v5, -0x1

    :goto_0
    if-ltz v5, :cond_7

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v6

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v7, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    const/4 v8, 0x0

    invoke-virtual {v7, v1, v2, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getWifiScanTime(JI)J

    move-result-wide v9

    const-wide/16 v11, 0x0

    move-wide/from16 v16, v3

    move v13, v8

    move-wide v14, v11

    :goto_1
    const/4 v3, 0x5

    if-ge v13, v3, :cond_0

    invoke-virtual {v7, v13, v1, v2, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getWifiBatchedScanTime(IJI)J

    move-result-wide v3

    add-long/2addr v14, v3

    add-int/lit8 v13, v13, 0x1

    goto :goto_1

    :cond_0
    cmp-long v3, v9, v11

    if-nez v3, :cond_2

    cmp-long v3, v14, v11

    if-eqz v3, :cond_1

    goto :goto_2

    :cond_1
    move-object/from16 v3, p1

    move-wide/from16 v18, v1

    goto/16 :goto_4

    :cond_2
    :goto_2
    const-wide/16 v3, 0x1f4

    add-long/2addr v9, v3

    div-long v9, v9, v16

    add-long/2addr v14, v3

    div-long v14, v14, v16

    move-object/from16 v3, p1

    iget-object v4, v3, Lcom/android/server/power/stats/WifiPowerStatsCollector$$ExternalSyntheticLambda1;->f$0:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    iget-object v7, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mLastScanTimes:Landroid/util/SparseArray;

    invoke-virtual {v7, v6}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;

    if-nez v7, :cond_3

    new-instance v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;

    invoke-direct {v7}, Ljava/lang/Object;-><init>()V

    iget-object v8, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mLastScanTimes:Landroid/util/SparseArray;

    invoke-virtual {v8, v6, v7}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    :cond_3
    move-wide/from16 v18, v1

    iget-wide v0, v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->basicScanTimeMs:J

    sub-long v0, v9, v0

    invoke-static {v11, v12, v0, v1}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v0

    move-wide/from16 v20, v0

    iget-wide v0, v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->batchedScanTimeMs:J

    sub-long v0, v14, v0

    invoke-static {v11, v12, v0, v1}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v0

    cmp-long v2, v20, v11

    if-nez v2, :cond_4

    cmp-long v2, v0, v11

    if-eqz v2, :cond_6

    :cond_4
    iget-object v2, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mScanTimes:Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;

    iget-wide v11, v2, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->basicScanTimeMs:J

    add-long v11, v11, v20

    iput-wide v11, v2, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->basicScanTimeMs:J

    iget-wide v11, v2, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->batchedScanTimeMs:J

    add-long/2addr v11, v0

    iput-wide v11, v2, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->batchedScanTimeMs:J

    iget-object v2, v4, Lcom/android/server/power/stats/PowerStatsCollector;->mUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v2, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v2

    iget-object v6, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mPowerStats:Lcom/android/internal/os/PowerStats;

    iget-object v6, v6, Lcom/android/internal/os/PowerStats;->uidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, [J

    if-nez v6, :cond_5

    iget-object v6, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mLayout:Lcom/android/server/power/stats/format/WifiPowerStatsLayout;

    iget v6, v6, Lcom/android/server/power/stats/format/PowerStatsLayout;->mUidStatsArrayLength:I

    new-array v6, v6, [J

    iget-object v8, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mPowerStats:Lcom/android/internal/os/PowerStats;

    iget-object v8, v8, Lcom/android/internal/os/PowerStats;->uidStats:Landroid/util/SparseArray;

    invoke-virtual {v8, v2, v6}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    iget-object v2, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mLayout:Lcom/android/server/power/stats/format/WifiPowerStatsLayout;

    iget v4, v2, Lcom/android/server/power/stats/format/WifiPowerStatsLayout;->mUidScanTimePosition:I

    aput-wide v20, v6, v4

    iget v2, v2, Lcom/android/server/power/stats/format/WifiPowerStatsLayout;->mUidBatchScanTimePosition:I

    aput-wide v0, v6, v2

    goto :goto_3

    :cond_5
    iget-object v2, v4, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mLayout:Lcom/android/server/power/stats/format/WifiPowerStatsLayout;

    iget v4, v2, Lcom/android/server/power/stats/format/WifiPowerStatsLayout;->mUidScanTimePosition:I

    aget-wide v11, v6, v4

    add-long v11, v11, v20

    aput-wide v11, v6, v4

    iget v2, v2, Lcom/android/server/power/stats/format/WifiPowerStatsLayout;->mUidBatchScanTimePosition:I

    aget-wide v11, v6, v2

    add-long/2addr v11, v0

    aput-wide v11, v6, v2

    :cond_6
    :goto_3
    iput-wide v9, v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->basicScanTimeMs:J

    iput-wide v14, v7, Lcom/android/server/power/stats/WifiPowerStatsCollector$WifiScanTimes;->batchedScanTimeMs:J

    :goto_4
    add-int/lit8 v5, v5, -0x1

    move-object/from16 v0, p0

    move-wide/from16 v3, v16

    move-wide/from16 v1, v18

    goto/16 :goto_0

    :cond_7
    return-void
.end method

.method public static -$$Nest$smdetachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)V
    .locals 1

    if-eqz p0, :cond_0

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mScanTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->detach()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->detach()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mRxTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mTxTimeMillis:[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->detach()V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mMonitoredRailChargeConsumedMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->detach()V

    :cond_0
    return-void
.end method

.method static constructor <clinit>()V
    .locals 4

    invoke-static {}, Landroid/os/BatteryStats;->isLowRamDevice()Z

    move-result v0

    if-eqz v0, :cond_0

    const/16 v0, 0x28

    goto :goto_0

    :cond_0
    const/16 v0, 0xc8

    :goto_0
    sput v0, Lcom/android/server/power/stats/BatteryStatsImpl;->MAX_WAKELOCKS_PER_UID:I

    invoke-static {}, Landroid/os/BatteryStats;->getCellSignalStrengthLevelCount()I

    move-result v0

    sput v0, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    invoke-static {}, Landroid/os/BatteryStats;->getModemTxPowerLevelCount()I

    move-result v0

    sput v0, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$1;

    invoke-direct {v0}, Landroid/os/BatteryStats$LongCounter;-><init>()V

    sput-object v0, Lcom/android/server/power/stats/BatteryStatsImpl;->ZERO_LONG_COUNTER:Lcom/android/server/power/stats/BatteryStatsImpl$1;

    const/4 v1, 0x1

    new-array v1, v1, [Landroid/os/BatteryStats$LongCounter;

    const/4 v2, 0x0

    aput-object v0, v1, v2

    sput-object v1, Lcom/android/server/power/stats/BatteryStatsImpl;->ZERO_LONG_COUNTER_ARRAY:[Landroid/os/BatteryStats$LongCounter;

    const/4 v0, 0x3

    const/4 v1, 0x7

    const/4 v2, 0x4

    const/4 v3, 0x5

    filled-new-array {v0, v1, v2, v3}, [I

    move-result-object v0

    sput-object v0, Lcom/android/server/power/stats/BatteryStatsImpl;->SUPPORTED_PER_PROCESS_STATE_STANDARD_ENERGY_BUCKETS:[I

    const-string/jumbo v0, "[#/]"

    invoke-static {v0}, Ljava/util/regex/Pattern;->compile(Ljava/lang/String;)Ljava/util/regex/Pattern;

    move-result-object v0

    sput-object v0, Lcom/android/server/power/stats/BatteryStatsImpl;->sPrefixPatternSplit:Ljava/util/regex/Pattern;

    return-void
.end method

.method public constructor <init>(Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;Lcom/android/internal/os/MonotonicClock;Ljava/io/File;Landroid/os/Handler;Lcom/android/server/am/BatteryStatsService;Lcom/android/server/am/BatteryStatsService;Lcom/android/server/am/BatteryStatsService$3;Lcom/android/internal/os/PowerProfile;Lcom/android/internal/os/CpuScalingPolicies;Lcom/android/server/power/stats/PowerStatsUidResolver;)V
    .locals 28

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-object/from16 v2, p3

    const/4 v3, 0x0

    const/4 v4, 0x1

    sget-object v5, Lcom/android/internal/os/Clock;->SYSTEM_CLOCK:Lcom/android/internal/os/Clock;

    const/4 v6, 0x0

    if-eqz v2, :cond_0

    new-instance v7, Lcom/android/server/power/stats/BatteryHistoryDirectory;

    new-instance v8, Ljava/io/File;

    const-string/jumbo v9, "battery-history"

    invoke-direct {v8, v2, v9}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    iget v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;->mMaxHistorySizeBytes:I

    invoke-direct {v7, v8, v9}, Lcom/android/server/power/stats/BatteryHistoryDirectory;-><init>(Ljava/io/File;I)V

    move-object v13, v7

    goto :goto_0

    :cond_0
    move-object v13, v6

    :goto_0
    new-instance v7, Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-direct {v7}, Ljava/lang/Object;-><init>()V

    new-instance v16, Lcom/android/internal/os/BatteryStatsHistory$TraceDelegate;

    invoke-direct/range {v16 .. v16}, Lcom/android/internal/os/BatteryStatsHistory$TraceDelegate;-><init>()V

    new-instance v17, Lcom/android/internal/os/BatteryStatsHistory$EventLogger;

    invoke-direct/range {v17 .. v17}, Lcom/android/internal/os/BatteryStatsHistory$EventLogger;-><init>()V

    invoke-direct {v0}, Landroid/os/BatteryStats;-><init>()V

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsRawSocReported:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsCoulombCounterReported:Z

    const-wide/16 v8, 0x0

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryRawUpdateTime:J

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryCCUpdateTime:J

    const/4 v10, -0x1

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryRaw:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryCC:I

    new-instance v11, Lcom/android/server/power/stats/KernelWakelockStats;

    invoke-direct {v11}, Lcom/android/server/power/stats/KernelWakelockStats;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpWakelockStats:Lcom/android/server/power/stats/KernelWakelockStats;

    new-instance v11, Landroid/util/LongSparseArray;

    invoke-direct {v11}, Landroid/util/LongSparseArray;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    new-instance v11, Landroid/util/SparseBooleanArray;

    invoke-direct {v11}, Landroid/util/SparseBooleanArray;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMoveWscLoggingToNotifierEnabled:Z

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$2;

    invoke-direct {v11, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$2;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenUsageTimeRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$2;

    invoke-direct {v11, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$2;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStatsRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$2;

    invoke-direct {v11, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$2;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockDurationRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$2;

    iput-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerProcStateCpuTimesAvailable:Z

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v11

    iput-wide v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuTimeReadsTrackingStartTimeMs:J

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRpmStats:Lcom/android/internal/os/RpmStats;

    const-wide/16 v11, -0x3e8

    iput-wide v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastRpmStatsUpdateTimeMs:J

    new-instance v11, Ljava/util/LinkedList;

    invoke-direct {v11}, Ljava/util/LinkedList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$5;

    invoke-direct {v11, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$5;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUserInfoProvider:Lcom/android/server/power/stats/BatteryStatsImpl$UserInfoProvider;

    new-instance v11, Landroid/util/SparseArray;

    invoke-direct {v11}, Landroid/util/SparseArray;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFullTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWindowTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDrawTimers:Ljava/util/ArrayList;

    new-instance v11, Landroid/util/SparseArray;

    invoke-direct {v11}, Landroid/util/SparseArray;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSensorTimers:Landroid/util/SparseArray;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiRunningTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFullWifiLockTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanTimers:Ljava/util/ArrayList;

    new-instance v11, Landroid/util/SparseArray;

    invoke-direct {v11}, Landroid/util/SparseArray;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiBatchedScanTimers:Landroid/util/SparseArray;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAudioTurnedOnTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mVideoTurnedOnTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightTurnedOnTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraTurnedOnTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanOnTimers:Ljava/util/ArrayList;

    new-instance v11, Ljava/util/ArrayList;

    invoke-direct {v11}, Ljava/util/ArrayList;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;-><init>(Z)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;-><init>(Z)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemServicesReady:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingReportCharging:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsServiceStateNr:Z

    new-instance v11, Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-direct {v11}, Landroid/os/BatteryStats$HistoryEventTracker;-><init>()V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    new-instance v11, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    invoke-direct {v11, v0}, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedInRealTimeMs:J

    const/16 v11, 0x80

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAp_temp:I

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPa_temp:I

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSkin_temp:I

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSub_batt_temp:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurrent:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOtgOnline:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecTxShareEvent:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecOnline:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecCurrentEvent:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecEvent:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    const/4 v11, 0x5

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenPolicy:I

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v12, Ljava/util/concurrent/ConcurrentHashMap;

    invoke-direct {v12}, Ljava/util/concurrent/ConcurrentHashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTopAppStats:Ljava/util/concurrent/ConcurrentHashMap;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightness:Z

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrBin:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrBin:I

    const/4 v12, 0x4

    new-array v14, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayMismatchWtfCount:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUsbDataState:I

    const/16 v12, 0xe

    iput v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHotspotState:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityBin:I

    const/4 v12, 0x2

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthBin:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthBinRaw:I

    sget v12, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionType:I

    sget v12, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrState:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveRat:I

    const/4 v12, 0x3

    new-array v14, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    iput-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    const/16 v14, 0xa

    new-array v15, v14, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-array v15, v14, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasBluetoothReporting:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasModemReporting:Z

    const/16 v15, 0x10

    new-array v12, v15, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-array v12, v15, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasSpeakerOutReporting:Z

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastCallbackTime:J

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiState:I

    const/16 v12, 0x8

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplState:I

    const/16 v12, 0xd

    new-array v12, v12, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthBin:I

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerState:I

    iput v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiRadioPowerState:I

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerCalculator:Lcom/android/server/power/stats/CpuPowerCalculator;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    iput-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCharging:Z

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    new-instance v12, Landroid/os/BatteryStats$LevelStepTracker;

    const/16 v15, 0xc8

    invoke-direct {v12, v15}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    new-instance v12, Landroid/os/BatteryStats$LevelStepTracker;

    const/16 v14, 0x190

    invoke-direct {v12, v14}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    new-instance v12, Landroid/os/BatteryStats$LevelStepTracker;

    invoke-direct {v12, v15}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    new-instance v12, Landroid/os/BatteryStats$LevelStepTracker;

    invoke-direct {v12, v14}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    new-instance v12, Ljava/util/ArrayList;

    invoke-direct {v12}, Ljava/util/ArrayList;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWriteTimeMs:J

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceState:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceStateRaw:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSimStateRaw:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    const-wide/16 v14, -0x1

    iput-wide v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTimeToFullSeconds:J

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAlarmManager:Landroid/app/AlarmManager;

    new-instance v12, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda8;

    invoke-direct {v12, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda8;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongPlugInAlarmHandler:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda8;

    new-instance v12, Ljava/util/HashMap;

    invoke-direct {v12}, Ljava/util/HashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    new-instance v12, Ljava/util/HashMap;

    invoke-direct {v12}, Ljava/util/HashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    new-instance v12, Ljava/util/HashMap;

    invoke-direct {v12}, Ljava/util/HashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    new-instance v12, Ljava/util/HashMap;

    invoke-direct {v12}, Ljava/util/HashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupReason:Ljava/lang/String;

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupUptimeMs:J

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupElapsedTimeMs:J

    new-instance v12, Ljava/util/HashMap;

    invoke-direct {v12}, Ljava/util/HashMap;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    new-instance v12, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-direct {v12, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastNesting:I

    new-instance v12, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

    invoke-direct {v12}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkEvents:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

    new-instance v12, Lcom/android/server/power/feature/PowerManagerFlags;

    invoke-direct {v12}, Lcom/android/server/power/feature/PowerManagerFlags;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerManagerFlags:Lcom/android/server/power/feature/PowerManagerFlags;

    new-instance v12, Ljava/lang/Object;

    invoke-direct {v12}, Ljava/lang/Object;-><init>()V

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiNetworkLock:Ljava/lang/Object;

    sget-object v12, Llibcore/util/EmptyArray;->STRING:[Ljava/lang/String;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiIfaces:[Ljava/lang/String;

    new-instance v14, Ljava/lang/Object;

    invoke-direct {v14}, Ljava/lang/Object;-><init>()V

    iput-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemNetworkLock:Ljava/lang/Object;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemIfaces:[Ljava/lang/String;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemActivityInfo:Landroid/telephony/ModemActivityInfo;

    new-instance v20, Landroid/os/SpeakerOutEnergyInfo;

    new-array v12, v4, [J

    aput-wide v8, v12, v3

    new-array v14, v4, [J

    aput-wide v8, v14, v3

    const/16 v25, 0x0

    const-wide/16 v21, 0x0

    move-object/from16 v23, v12

    move-object/from16 v24, v14

    invoke-direct/range {v20 .. v25}, Landroid/os/SpeakerOutEnergyInfo;-><init>(J[J[JI)V

    move-object/from16 v8, v20

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

    new-instance v8, Landroid/os/RemoteCallbackList;

    invoke-direct {v8}, Landroid/os/RemoteCallbackList;-><init>()V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

    new-instance v8, Ljava/util/HashMap;

    invoke-direct {v8}, Ljava/util/HashMap;-><init>()V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkStatsDeltaMap:Ljava/util/HashMap;

    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    invoke-direct {v8}, Ljava/lang/Object;-><init>()V

    new-instance v9, Landroid/util/SparseLongArray;

    invoke-direct {v9}, Landroid/util/SparseLongArray;-><init>()V

    iput-object v9, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidRxBytes:Landroid/util/SparseLongArray;

    new-instance v9, Landroid/util/SparseLongArray;

    invoke-direct {v9}, Landroid/util/SparseLongArray;-><init>()V

    iput-object v9, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidTxBytes:Landroid/util/SparseLongArray;

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iput-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFeatureComputeChargeTimeModel:Z

    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    invoke-direct {v8, v4, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;-><init>(ILjava/lang/Object;)V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteAsyncRunnable:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    new-instance v8, Ljava/util/concurrent/locks/ReentrantLock;

    invoke-direct {v8}, Ljava/util/concurrent/locks/ReentrantLock;-><init>()V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v5}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v8

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastCallbackTime:J

    invoke-static {}, Landroid/os/BatteryStats;->isKernelStatsAvailable()Z

    move-result v8

    if-nez v8, :cond_1

    goto :goto_1

    :cond_1
    new-instance v8, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    invoke-direct {v8, v4, v5}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;-><init>(ZLcom/android/internal/os/Clock;)V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    new-instance v8, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-direct {v8, v4, v5}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;-><init>(ZLcom/android/internal/os/Clock;)V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    new-instance v8, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    invoke-direct {v8, v4, v5}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;-><init>(ZLcom/android/internal/os/Clock;)V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    new-instance v8, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    invoke-direct {v8, v4, v5}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;-><init>(ZLcom/android/internal/os/Clock;)V

    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    new-instance v5, Lcom/android/server/power/stats/KernelWakelockReader;

    invoke-direct {v5}, Lcom/android/server/power/stats/KernelWakelockReader;-><init>()V

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockReader:Lcom/android/server/power/stats/KernelWakelockReader;

    new-instance v5, Lcom/android/internal/os/KernelMemoryBandwidthStats;

    invoke-direct {v5}, Lcom/android/internal/os/KernelMemoryBandwidthStats;-><init>()V

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryBandwidthStats:Lcom/android/internal/os/KernelMemoryBandwidthStats;

    new-instance v5, Lcom/android/internal/os/RailStats;

    invoke-direct {v5}, Lcom/android/internal/os/RailStats;-><init>()V

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    :goto_1
    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsConfig:Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;

    move-object/from16 v1, p2

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    invoke-virtual/range {p4 .. p4}, Landroid/os/Handler;->getLooper()Landroid/os/Looper;

    move-result-object v5

    invoke-direct {v1, v0, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/os/Looper;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    invoke-direct {v5, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;)V

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    move-object/from16 v1, p8

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    move-object/from16 v1, p9

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    move-object/from16 v5, p10

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    iput-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v1}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v1

    array-length v5, v1

    new-array v5, v5, [Lcom/android/internal/os/KernelCpuSpeedReader;

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    move v5, v3

    :goto_2
    array-length v7, v1

    if-ge v5, v7, :cond_2

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    aget v8, v1, v5

    invoke-virtual {v7, v8}, Lcom/android/internal/os/CpuScalingPolicies;->getRelatedCpus(I)[I

    move-result-object v7

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    aget v9, v1, v5

    invoke-virtual {v8, v9}, Lcom/android/internal/os/CpuScalingPolicies;->getFrequencies(I)[I

    move-result-object v8

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    new-instance v12, Lcom/android/internal/os/KernelCpuSpeedReader;

    aget v7, v7, v3

    array-length v8, v8

    invoke-direct {v12, v7, v8}, Lcom/android/internal/os/KernelCpuSpeedReader;-><init>(II)V

    aput-object v12, v9, v5

    add-int/2addr v5, v4

    goto :goto_2

    :cond_2
    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v5}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result v5

    new-array v5, v5, [I

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerBracketMap:[I

    array-length v5, v1

    move v7, v3

    move v8, v7

    :goto_3
    if-ge v7, v5, :cond_4

    aget v9, v1, v7

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v12, v9}, Lcom/android/internal/os/CpuScalingPolicies;->getFrequencies(I)[I

    move-result-object v12

    array-length v12, v12

    move v14, v3

    :goto_4
    if-ge v14, v12, :cond_3

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerBracketMap:[I

    add-int/lit8 v20, v8, 0x1

    move/from16 v21, v4

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-virtual {v4, v9, v14}, Lcom/android/internal/os/PowerProfile;->getCpuPowerBracketForScalingStep(II)I

    move-result v4

    aput v4, v15, v8

    add-int/lit8 v14, v14, 0x1

    move/from16 v8, v20

    move/from16 v4, v21

    goto :goto_4

    :cond_3
    move/from16 v21, v4

    add-int/lit8 v7, v7, 0x1

    goto :goto_3

    :cond_4
    move/from16 v21, v4

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    if-ne v1, v10, :cond_5

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-virtual {v1}, Lcom/android/internal/os/PowerProfile;->getBatteryCapacity()D

    move-result-wide v4

    double-to-int v1, v4

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    :cond_5
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-virtual {v1}, Lcom/android/internal/os/PowerProfile;->getNumDisplays()I

    move-result v1

    new-array v4, v1, [Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    iput-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    move v4, v3

    :goto_5
    if-ge v4, v1, :cond_7

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    new-instance v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v7}, Ljava/lang/Object;-><init>()V

    iput v3, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    iput v10, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput v3, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenStateAtLastEnergyMeasurement:I

    new-instance v22, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/16 v24, 0x0

    const/16 v27, 0x0

    const/16 v25, 0x0

    move-object/from16 v23, v8

    move-object/from16 v26, v9

    invoke-direct/range {v22 .. v27}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v8, v22

    iput-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v22, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-direct/range {v22 .. v27}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v8, v22

    iput-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v8, v3

    :goto_6
    if-ge v8, v11, :cond_6

    iget-object v9, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v22, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/16 v24, 0x0

    const/16 v27, 0x0

    const/16 v25, 0x0

    invoke-direct/range {v22 .. v27}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v22, v9, v8

    add-int/lit8 v8, v8, 0x1

    goto :goto_6

    :cond_6
    aput-object v7, v5, v4

    add-int/lit8 v4, v4, 0x1

    goto :goto_5

    :cond_7
    if-eqz v2, :cond_8

    new-instance v1, Landroid/util/AtomicFile;

    new-instance v4, Ljava/io/File;

    const-string/jumbo v5, "batterystats.bin"

    invoke-direct {v4, v2, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-direct {v1, v4}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    new-instance v1, Landroid/util/AtomicFile;

    new-instance v4, Ljava/io/File;

    const-string/jumbo v5, "batterystats-checkin.bin"

    invoke-direct {v4, v2, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-direct {v1, v4}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCheckinFile:Landroid/util/AtomicFile;

    new-instance v1, Landroid/util/AtomicFile;

    new-instance v4, Ljava/io/File;

    const-string/jumbo v5, "batterystats-daily.xml"

    invoke-direct {v4, v2, v5}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-direct {v1, v4}, Landroid/util/AtomicFile;-><init>(Ljava/io/File;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyFile:Landroid/util/AtomicFile;

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    goto :goto_7

    :cond_8
    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCheckinFile:Landroid/util/AtomicFile;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyFile:Landroid/util/AtomicFile;

    iput-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    :goto_7
    iput-object v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHistoryDirectory:Lcom/android/server/power/stats/BatteryHistoryDirectory;

    new-instance v10, Lcom/android/internal/os/BatteryStatsHistory;

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->MAX_HISTORY_BUFFER:I

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    const/4 v11, 0x0

    const/16 v18, 0x3

    const/16 v19, 0xa

    invoke-direct/range {v10 .. v17}, Lcom/android/internal/os/BatteryStatsHistory;-><init>(Landroid/os/Parcel;ILcom/android/internal/os/BatteryStatsHistory$BatteryHistoryStore;Lcom/android/internal/os/Clock;Lcom/android/internal/os/MonotonicClock;Lcom/android/internal/os/BatteryStatsHistory$TraceDelegate;Lcom/android/internal/os/BatteryStatsHistory$EventLogger;)V

    iput-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    new-instance v1, Lcom/android/server/power/stats/CpuPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/CpuPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/WakelockPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/ScreenPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;

    invoke-direct {v4, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-direct {v1, v2, v4}, Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/WifiPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;

    invoke-direct {v4, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-direct {v1, v2, v4}, Lcom/android/server/power/stats/WifiPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;

    invoke-direct {v4, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-direct {v1, v2, v4}, Lcom/android/server/power/stats/BluetoothPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda11;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v4, Lcom/android/server/power/stats/CameraPowerStatsCollector;

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-static/range {v18 .. v18}, Landroid/os/BatteryConsumer;->powerComponentIdToString(I)Ljava/lang/String;

    move-result-object v7

    new-instance v10, Lcom/android/server/power/stats/format/BinaryStatePowerStatsLayout;

    invoke-direct {v10}, Lcom/android/server/power/stats/format/BinaryStatePowerStatsLayout;-><init>()V

    const/4 v9, -0x1

    const/4 v6, 0x3

    const/4 v8, 0x7

    invoke-direct/range {v4 .. v10}, Lcom/android/server/power/stats/EnergyConsumerPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;ILjava/lang/String;IILcom/android/server/power/stats/format/EnergyConsumerPowerStatsLayout;)V

    iput-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v1, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v4, v1}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v5, Lcom/android/server/power/stats/GnssPowerStatsCollector;

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-static/range {v19 .. v19}, Landroid/os/BatteryConsumer;->powerComponentIdToString(I)Ljava/lang/String;

    move-result-object v8

    new-instance v11, Lcom/android/server/power/stats/format/GnssPowerStatsLayout;

    invoke-direct {v11}, Lcom/android/server/power/stats/format/GnssPowerStatsLayout;-><init>()V

    const/4 v10, -0x1

    const/16 v7, 0xa

    const/4 v9, 0x4

    invoke-direct/range {v5 .. v11}, Lcom/android/server/power/stats/EnergyConsumerPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;ILjava/lang/String;IILcom/android/server/power/stats/format/EnergyConsumerPowerStatsLayout;)V

    iput-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v1, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v5, v1}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    new-instance v1, Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsCollector;->addConsumer(Ljava/util/function/Consumer;)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    add-int/lit8 v1, v1, 0x1

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->initTimersAndCounters()V

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v1

    const-wide/16 v4, 0x3e8

    mul-long/2addr v1, v4

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v6}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v6

    mul-long/2addr v6, v4

    invoke-virtual {v0, v1, v2, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->initTimes(JJ)V

    sget-object v1, Landroid/os/Build;->ID:Ljava/lang/String;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEndPlatformVersion:Ljava/lang/String;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartPlatformVersion:Ljava/lang/String;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->initDischarge()V

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateDailyDeadlineLocked()V

    move-object/from16 v1, p5

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPlatformIdleStateCallback:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v1, p6

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerRetriever:Lcom/android/server/am/BatteryStatsService;

    move-object/from16 v1, p7

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUserInfoProvider:Lcom/android/server/power/stats/BatteryStatsImpl$UserInfoProvider;

    new-instance v1, Ljava/io/File;

    const-string v2, "/sys/class/power_supply/battery/batt_read_raw_soc"

    invoke-direct {v1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z

    move-result v2

    if-eqz v2, :cond_9

    invoke-virtual {v1}, Ljava/io/File;->canRead()Z

    move-result v1

    if-eqz v1, :cond_9

    move/from16 v1, v21

    iput-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsRawSocReported:Z

    :cond_9
    new-instance v1, Ljava/io/File;

    const-string v2, "/sys/class/power_supply/battery/cc_info"

    invoke-direct {v1, v2}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    invoke-virtual {v1}, Ljava/io/File;->exists()Z

    move-result v2

    if-eqz v2, :cond_a

    invoke-virtual {v1}, Ljava/io/File;->canRead()Z

    move-result v1

    if-eqz v1, :cond_a

    const/4 v1, 0x1

    iput-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsCoulombCounterReported:Z

    :cond_a
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$9;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$9;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/PowerStatsUidResolver;->addListener(Lcom/android/server/power/stats/PowerStatsUidResolver$Listener;)V

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v0, 0x15

    invoke-static {v0, v3}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    return-void
.end method

.method public static synthetic access$000()Z
    .locals 1

    invoke-static {}, Landroid/os/BatteryStats;->isLowRamDevice()Z

    move-result v0

    return v0
.end method

.method public static synthetic access$100()Z
    .locals 1

    invoke-static {}, Landroid/os/BatteryStats;->isLowRamDevice()Z

    move-result v0

    return v0
.end method

.method public static createWakeLockData(Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;J)Landroid/os/WakeLockStats$WakeLockData;
    .locals 10

    if-nez p0, :cond_0

    sget-object p0, Landroid/os/WakeLockStats$WakeLockData;->EMPTY:Landroid/os/WakeLockStats$WakeLockData;

    return-object p0

    :cond_0
    const-wide/16 v0, 0x3e8

    mul-long v2, p1, v0

    const/4 v4, 0x0

    invoke-virtual {p0, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v2

    div-long v6, v2, v0

    const-wide/16 v0, 0x0

    cmp-long v2, v6, v0

    if-nez v2, :cond_1

    sget-object p0, Landroid/os/WakeLockStats$WakeLockData;->EMPTY:Landroid/os/WakeLockStats$WakeLockData;

    return-object p0

    :cond_1
    new-instance v4, Landroid/os/WakeLockStats$WakeLockData;

    iget v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mCount:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v2

    if-eqz v2, :cond_2

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;->getCurrentDurationMsLocked(J)J

    move-result-wide v0

    :cond_2
    move-wide v8, v0

    invoke-direct/range {v4 .. v9}, Landroid/os/WakeLockStats$WakeLockData;-><init>(IJJ)V

    return-object v4
.end method

.method public static detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V
    .locals 0

    if-eqz p0, :cond_0

    invoke-interface {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;->detach()V

    :cond_0
    return-void
.end method

.method public static detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V
    .locals 2

    if-eqz p0, :cond_0

    const/4 v0, 0x0

    :goto_0
    array-length v1, p0

    if-ge v0, v1, :cond_0

    aget-object v1, p0, v0

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_0
    return-void
.end method

.method public static detachIfNotNull([[Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V
    .locals 2

    if-eqz p0, :cond_0

    const/4 v0, 0x0

    :goto_0
    array-length v1, p0

    if-ge v0, v1, :cond_0

    aget-object v1, p0, v0

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_0
    return-void
.end method

.method public static dumpEnergyConsumerStatsLocked(Ljava/io/PrintWriter;Ljava/lang/String;Lcom/android/internal/power/EnergyConsumerStats;)V
    .locals 2

    if-nez p2, :cond_0

    return-void

    :cond_0
    new-instance v0, Landroid/util/IndentingPrintWriter;

    const-string v1, "    "

    invoke-direct {v0, p0, v1}, Landroid/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V

    invoke-virtual {v0}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;

    const-string p0, "%s:\n"

    filled-new-array {p1}, [Ljava/lang/Object;

    move-result-object p1

    invoke-virtual {v0, p0, p1}, Landroid/util/IndentingPrintWriter;->printf(Ljava/lang/String;[Ljava/lang/Object;)Ljava/io/PrintWriter;

    invoke-virtual {v0}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;

    invoke-virtual {p2, v0}, Lcom/android/internal/power/EnergyConsumerStats;->dump(Ljava/io/PrintWriter;)V

    invoke-virtual {v0}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;

    return-void
.end method

.method public static encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;
    .locals 6

    if-nez p0, :cond_0

    const-string/jumbo p0, "NULL"

    return-object p0

    :cond_0
    sget-object v0, Lcom/android/server/power/stats/BatteryStatsImpl;->sPrefixPatternSplit:Ljava/util/regex/Pattern;

    const/4 v1, 0x0

    invoke-virtual {v0, p0, v1}, Ljava/util/regex/Pattern;->split(Ljava/lang/CharSequence;I)[Ljava/lang/String;

    move-result-object v0

    array-length v2, v0

    const/4 v3, 0x1

    if-ne v2, v3, :cond_1

    return-object p0

    :cond_1
    array-length p0, v0

    sub-int/2addr p0, v3

    aget-object p0, v0, p0

    :try_start_0
    const-string/jumbo v2, "[^a-zA-Z0-9]"

    const-string v4, ""

    invoke-virtual {p0, v2, v4}, Ljava/lang/String;->replaceAll(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object p0

    invoke-static {p0}, Ljava/lang/Long;->parseLong(Ljava/lang/String;)J
    :try_end_0
    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_0

    move p0, v3

    goto :goto_0

    :catch_0
    move p0, v1

    :goto_0
    move v2, v1

    :goto_1
    array-length v4, v0

    sub-int/2addr v4, p0

    if-ge v2, v4, :cond_3

    aget-object v4, v0, v2

    const-string v5, "@SyncManager@"

    invoke-virtual {v4, v5}, Ljava/lang/String;->contains(Ljava/lang/CharSequence;)Z

    move-result v4

    if-eqz v4, :cond_2

    goto :goto_2

    :cond_2
    sget-object v4, Landroid/util/Patterns;->PHONE:Ljava/util/regex/Pattern;

    aget-object v5, v0, v2

    invoke-virtual {v4, v5}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v4

    const-string/jumbo v5, "Numbers"

    invoke-virtual {v4, v5}, Ljava/util/regex/Matcher;->replaceAll(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    aput-object v4, v0, v2

    sget-object v5, Landroid/util/Patterns;->EMAIL_ADDRESS:Ljava/util/regex/Pattern;

    invoke-virtual {v5, v4}, Ljava/util/regex/Pattern;->matcher(Ljava/lang/CharSequence;)Ljava/util/regex/Matcher;

    move-result-object v4

    const-string/jumbo v5, "eM_ADDR"

    invoke-virtual {v4, v5}, Ljava/util/regex/Matcher;->replaceAll(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    aput-object v4, v0, v2

    :goto_2
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    :cond_3
    array-length v2, v0

    sub-int/2addr v2, p0

    invoke-static {v0, v1, v2}, Ljava/util/Arrays;->copyOfRange([Ljava/lang/Object;II)[Ljava/lang/Object;

    move-result-object v1

    check-cast v1, [Ljava/lang/CharSequence;

    const-string v2, "/"

    invoke-static {v2, v1}, Ljava/lang/String;->join(Ljava/lang/CharSequence;[Ljava/lang/CharSequence;)Ljava/lang/String;

    move-result-object v1

    if-eqz p0, :cond_4

    const-string p0, "#"

    invoke-static {v1, p0}, Lcom/android/internal/util/jobs/Preconditions$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object p0

    array-length v1, v0

    sub-int/2addr v1, v3

    aget-object v0, v0, v1

    invoke-virtual {p0, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    :cond_4
    return-object v1
.end method

.method public static excludeFromStringArray(Ljava/lang/String;[Ljava/lang/String;)[Ljava/lang/String;
    .locals 3

    invoke-static {p1, p0}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result p0

    if-ltz p0, :cond_2

    array-length v0, p1

    add-int/lit8 v0, v0, -0x1

    new-array v0, v0, [Ljava/lang/String;

    if-lez p0, :cond_0

    const/4 v1, 0x0

    invoke-static {p1, v1, v0, v1, p0}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    :cond_0
    array-length v1, p1

    add-int/lit8 v1, v1, -0x1

    if-ge p0, v1, :cond_1

    add-int/lit8 v1, p0, 0x1

    array-length v2, p1

    sub-int/2addr v2, p0

    add-int/lit8 v2, v2, -0x1

    invoke-static {p1, v1, v0, p0, v2}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    :cond_1
    return-object v0

    :cond_2
    return-object p1
.end method

.method public static getBatteryLevel()I
    .locals 4

    const-string v0, "/sys/class/power_supply/battery/capacity"

    :try_start_0
    new-instance v1, Ljava/io/FileReader;

    invoke-direct {v1, v0}, Ljava/io/FileReader;-><init>(Ljava/lang/String;)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    :try_start_1
    new-instance v0, Ljava/io/BufferedReader;

    const/16 v2, 0x8

    invoke-direct {v0, v1, v2}, Ljava/io/BufferedReader;-><init>(Ljava/io/Reader;I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    invoke-virtual {v0}, Ljava/io/BufferedReader;->readLine()Ljava/lang/String;

    move-result-object v2

    if-nez v2, :cond_0

    const-string v2, "BatteryStatsImpl"

    const-string v3, "Cannot read the path :: /sys/class/power_supply/battery/capacity"

    invoke-static {v2, v3}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    :try_start_3
    invoke-virtual {v0}, Ljava/io/BufferedReader;->close()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    :try_start_4
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_0

    const/4 v0, -0x2

    goto :goto_4

    :catchall_0
    move-exception v0

    goto :goto_2

    :catchall_1
    move-exception v2

    goto :goto_0

    :cond_0
    :try_start_5
    invoke-virtual {v2}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object v2

    invoke-static {v2}, Ljava/lang/Byte;->parseByte(Ljava/lang/String;)B

    move-result v2
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    :try_start_6
    invoke-virtual {v0}, Ljava/io/BufferedReader;->close()V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_7
    .catch Ljava/io/IOException; {:try_start_7 .. :try_end_7} :catch_0

    move v0, v2

    goto :goto_4

    :goto_0
    :try_start_8
    invoke-virtual {v0}, Ljava/io/BufferedReader;->close()V
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    goto :goto_1

    :catchall_2
    move-exception v0

    :try_start_9
    invoke-virtual {v2, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V

    :goto_1
    throw v2
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    :goto_2
    :try_start_a
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_3

    goto :goto_3

    :catchall_3
    move-exception v1

    :try_start_b
    invoke-virtual {v0, v1}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V

    :goto_3
    throw v0
    :try_end_b
    .catch Ljava/io/IOException; {:try_start_b .. :try_end_b} :catch_0

    :catch_0
    const/4 v0, -0x1

    :goto_4
    if-gez v0, :cond_1

    const/16 v0, 0x64

    :cond_1
    return v0
.end method

.method public static getIntFromFile(Ljava/lang/String;)I
    .locals 4

    const-string v0, "Cannot read the path :: "

    :try_start_0
    new-instance v1, Ljava/io/FileReader;

    invoke-direct {v1, p0}, Ljava/io/FileReader;-><init>(Ljava/lang/String;)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    :try_start_1
    new-instance v2, Ljava/io/BufferedReader;

    const/16 v3, 0x8

    invoke-direct {v2, v1, v3}, Ljava/io/BufferedReader;-><init>(Ljava/io/Reader;I)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    invoke-virtual {v2}, Ljava/io/BufferedReader;->readLine()Ljava/lang/String;

    move-result-object v3

    if-nez v3, :cond_0

    const-string v3, "BatteryStatsImpl"

    invoke-virtual {v0, p0}, Ljava/lang/String;->concat(Ljava/lang/String;)Ljava/lang/String;

    move-result-object p0

    invoke-static {v3, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_1

    :try_start_3
    invoke-virtual {v2}, Ljava/io/BufferedReader;->close()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    const/4 p0, -0x2

    :try_start_4
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_0

    return p0

    :catchall_0
    move-exception p0

    goto :goto_2

    :catchall_1
    move-exception p0

    goto :goto_0

    :cond_0
    :try_start_5
    invoke-virtual {v3}, Ljava/lang/String;->trim()Ljava/lang/String;

    move-result-object p0

    invoke-static {p0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result p0
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    :try_start_6
    invoke-virtual {v2}, Ljava/io/BufferedReader;->close()V
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    :try_start_7
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_7
    .catch Ljava/io/IOException; {:try_start_7 .. :try_end_7} :catch_0

    return p0

    :goto_0
    :try_start_8
    invoke-virtual {v2}, Ljava/io/BufferedReader;->close()V
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_2

    goto :goto_1

    :catchall_2
    move-exception v0

    :try_start_9
    invoke-virtual {p0, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V

    :goto_1
    throw p0
    :try_end_9
    .catchall {:try_start_9 .. :try_end_9} :catchall_0

    :goto_2
    :try_start_a
    invoke-virtual {v1}, Ljava/io/FileReader;->close()V
    :try_end_a
    .catchall {:try_start_a .. :try_end_a} :catchall_3

    goto :goto_3

    :catchall_3
    move-exception v0

    :try_start_b
    invoke-virtual {p0, v0}, Ljava/lang/Throwable;->addSuppressed(Ljava/lang/Throwable;)V

    :goto_3
    throw p0
    :try_end_b
    .catch Ljava/io/IOException; {:try_start_b .. :try_end_b} :catch_0

    :catch_0
    const/4 p0, -0x1

    return p0
.end method

.method public static getPowerManagerWakeLockLevel(I)I
    .locals 3

    const/4 v0, 0x1

    if-eqz p0, :cond_3

    if-eq p0, v0, :cond_2

    const/4 v0, 0x2

    const/4 v1, -0x1

    const-string v2, "BatteryStatsImpl"

    if-eq p0, v0, :cond_1

    const/16 v0, 0x12

    if-eq p0, v0, :cond_0

    const-string v0, "Illegal wakelock type in batterystats: "

    invoke-static {p0, v0, v2}, Lcom/android/server/NandswapManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V

    return v1

    :cond_0
    const/16 p0, 0x80

    return p0

    :cond_1
    const-string p0, "Illegal window wakelock type observed in batterystats."

    invoke-static {v2, p0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    return v1

    :cond_2
    const/16 p0, 0x1a

    return p0

    :cond_3
    return v0
.end method

.method public static readDailyItemTagDetailsLocked(Lcom/android/modules/utils/TypedXmlPullParser;Landroid/os/BatteryStats$DailyItem;ZLjava/lang/String;)V
    .locals 7

    const/4 v0, 0x0

    const-string/jumbo v1, "n"

    const/4 v2, -0x1

    invoke-interface {p0, v0, v1, v2}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeInt(Ljava/lang/String;Ljava/lang/String;I)I

    move-result v1

    const-string v3, "BatteryStatsImpl"

    if-ne v1, v2, :cond_0

    new-instance p1, Ljava/lang/StringBuilder;

    const-string/jumbo p2, "Missing \'n\' attribute at "

    invoke-direct {p1, p2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->getPositionDescription()Ljava/lang/String;

    move-result-object p2

    invoke-virtual {p1, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p1

    invoke-static {v3, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    invoke-static {p0}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    return-void

    :cond_0
    new-instance v2, Landroid/os/BatteryStats$LevelStepTracker;

    invoke-direct {v2, v1}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I)V

    if-eqz p2, :cond_1

    iput-object v2, p1, Landroid/os/BatteryStats$DailyItem;->mChargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    goto :goto_0

    :cond_1
    iput-object v2, p1, Landroid/os/BatteryStats$DailyItem;->mDischargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    :goto_0
    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result p1

    const/4 p2, 0x0

    :cond_2
    :goto_1
    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->next()I

    move-result v4

    const/4 v5, 0x1

    if-eq v4, v5, :cond_6

    const/4 v5, 0x3

    if-ne v4, v5, :cond_3

    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result v6

    if-le v6, p1, :cond_6

    :cond_3
    if-eq v4, v5, :cond_2

    const/4 v5, 0x4

    if-ne v4, v5, :cond_4

    goto :goto_1

    :cond_4
    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v4

    const-string/jumbo v5, "s"

    invoke-virtual {v5, v4}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_5

    if-ge p2, v1, :cond_2

    const-string/jumbo v4, "v"

    invoke-interface {p0, v0, v4}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeValue(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    if-eqz v4, :cond_2

    invoke-virtual {v2, p2, v4}, Landroid/os/BatteryStats$LevelStepTracker;->decodeEntryAt(ILjava/lang/String;)V

    add-int/lit8 p2, p2, 0x1

    goto :goto_1

    :cond_5
    const-string/jumbo v4, "Unknown element under <"

    const-string v5, ">: "

    invoke-static {v4, p3, v5}, Lcom/android/internal/util/jobs/DumpUtils$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-interface {p0}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v3, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    invoke-static {p0}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    goto :goto_1

    :cond_6
    iput p2, v2, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    return-void
.end method

.method public static resetIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;J)Z
    .locals 1

    if-eqz p0, :cond_0

    const/4 v0, 0x0

    invoke-interface {p0, p1, p2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;->reset(JZ)Z

    move-result p0

    return p0

    :cond_0
    const/4 p0, 0x1

    return p0
.end method

.method public static resetIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;J)Z
    .locals 3

    const/4 v0, 0x1

    if-eqz p0, :cond_0

    const/4 v1, 0x0

    :goto_0
    array-length v2, p0

    if-ge v1, v2, :cond_0

    aget-object v2, p0, v1

    invoke-static {v2, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;J)Z

    move-result v2

    and-int/2addr v0, v2

    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_0
    return v0
.end method

.method public static writeDailyLevelSteps(Lcom/android/modules/utils/TypedXmlSerializer;Ljava/lang/String;Landroid/os/BatteryStats$LevelStepTracker;Ljava/lang/StringBuilder;)V
    .locals 6

    if-eqz p2, :cond_1

    const/4 v0, 0x0

    invoke-interface {p0, v0, p1}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    const-string/jumbo v1, "n"

    iget v2, p2, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    invoke-interface {p0, v0, v1, v2}, Lcom/android/modules/utils/TypedXmlSerializer;->attributeInt(Ljava/lang/String;Ljava/lang/String;I)Lorg/xmlpull/v1/XmlSerializer;

    const/4 v1, 0x0

    move v2, v1

    :goto_0
    iget v3, p2, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    if-ge v2, v3, :cond_0

    const-string/jumbo v3, "s"

    invoke-interface {p0, v0, v3}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    invoke-virtual {p3, v1}, Ljava/lang/StringBuilder;->setLength(I)V

    invoke-virtual {p2, v2, p3}, Landroid/os/BatteryStats$LevelStepTracker;->encodeEntryAt(ILjava/lang/StringBuilder;)V

    const-string/jumbo v4, "v"

    invoke-virtual {p3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-interface {p0, v0, v4, v5}, Lcom/android/modules/utils/TypedXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    invoke-interface {p0, v0, v3}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_0
    invoke-interface {p0, v0, p1}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    :cond_1
    return-void
.end method


# virtual methods
.method public final addCpuStatsLocked(IIIIIIII)V
    .locals 4

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuUserTimeMs:J

    int-to-long v2, p1

    add-long/2addr v0, v2

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuUserTimeMs:J

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuSystemTimeMs:J

    int-to-long p1, p2

    add-long/2addr v0, p1

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuSystemTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatUserTimeMs:J

    int-to-long v0, p3

    add-long/2addr p1, v0

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatUserTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSystemTimeMs:J

    int-to-long p3, p4

    add-long/2addr p1, p3

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSystemTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIOWaitTimeMs:J

    int-to-long p3, p5

    add-long/2addr p1, p3

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIOWaitTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIrqTimeMs:J

    int-to-long p3, p6

    add-long/2addr p1, p3

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIrqTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSoftIrqTimeMs:J

    int-to-long p3, p7

    add-long/2addr p1, p3

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSoftIrqTimeMs:J

    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIdleTimeMs:J

    int-to-long p3, p8

    add-long/2addr p1, p3

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIdleTimeMs:J

    return-void
.end method

.method public final canReadTimeToFullNow()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFeatureComputeChargeTimeModel:Z

    return p0
.end method

.method public final canTrustSecPowerProfile()Z
    .locals 7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v0}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v0

    array-length v1, v0

    const/4 v2, 0x0

    move v3, v2

    move v4, v3

    :goto_0
    if-ge v3, v1, :cond_0

    aget v5, v0, v3

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v6, v5}, Lcom/android/internal/os/CpuScalingPolicies;->getFrequencies(I)[I

    move-result-object v5

    array-length v5, v5

    add-int/2addr v4, v5

    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-virtual {p0}, Lcom/android/internal/os/PowerProfile;->getAllFrequencies()I

    move-result p0

    if-ne v4, p0, :cond_1

    const/4 p0, 0x1

    return p0

    :cond_1
    return v2
.end method

.method public final checkProtectBatteryType()V
    .locals 4

    new-instance v0, Ljava/lang/StringBuilder;

    const-string/jumbo v1, "Something was wrong with protect_battery ("

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    const-string v2, ")"

    const-string v3, "BatteryStatsImpl"

    invoke-static {v1, v2, v3, v0}, Lcom/android/server/UiModeManagerService$15$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/StringBuilder;)V

    const/4 v0, 0x0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0, v0}, Lcom/android/internal/os/BatteryStatsHistory;->setProtectBatteryState(I)V

    return-void
.end method

.method public final clearPendingRemovedUidsLocked()V
    .locals 5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-wide v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->UID_REMOVE_DELAY_MS:J

    sub-long/2addr v0, v2

    :goto_0
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    invoke-interface {v2}, Ljava/util/Queue;->isEmpty()Z

    move-result v2

    if-nez v2, :cond_0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    invoke-interface {v2}, Ljava/util/Queue;->peek()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;

    iget-wide v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;->mUidRemovalTimestamp:J

    cmp-long v2, v2, v0

    if-gez v2, :cond_0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    invoke-interface {v2}, Ljava/util/Queue;->poll()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    iget v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;->mStartUid:I

    iget v4, v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;->mEndUid:I

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;->this$0:Lcom/android/server/power/stats/BatteryStatsImpl;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->removeCpuStatsForUidRangeLocked(II)V

    goto :goto_0

    :cond_0
    return-void
.end method

.method public final clearRemovedUserUidsLocked(I)V
    .locals 5

    const/4 v0, 0x0

    invoke-static {p1, v0}, Landroid/os/UserHandle;->getUid(II)I

    move-result v0

    const v1, 0x1869f

    invoke-static {p1, v1}, Landroid/os/UserHandle;->getUid(II)I

    move-result p1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    const/4 v2, 0x0

    invoke-virtual {v1, v0, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1, p1, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1, v0}, Landroid/util/SparseArray;->indexOfKey(I)I

    move-result v1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, p1}, Landroid/util/SparseArray;->indexOfKey(I)I

    move-result v2

    move v3, v1

    :goto_0
    if-gt v3, v2, :cond_1

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v4, v3}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-eqz v4, :cond_0

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->detachFromTimeBase()V

    :cond_0
    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    :cond_1
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    sub-int/2addr v2, v1

    add-int/lit8 v2, v2, 0x1

    invoke-virtual {v3, v1, v2}, Landroid/util/SparseArray;->removeAtRange(II)V

    invoke-virtual {p0, v0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->removeCpuStatsForUidRangeLocked(II)V

    return-void
.end method

.method public final collectPowerStatsSamples()V
    .locals 3

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->schedulePowerStatsSampleCollection()V

    new-instance v0, Landroid/os/ConditionVariable;

    invoke-direct {v0}, Landroid/os/ConditionVariable;-><init>()V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    const/4 v2, 0x0

    invoke-direct {v1, v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;-><init>(ILjava/lang/Object;)V

    invoke-virtual {p0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    invoke-virtual {v0}, Landroid/os/ConditionVariable;->block()V

    return-void
.end method

.method public final commitCurrentHistoryBatchLocked()V
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->commitCurrentHistoryBatchLocked()V

    return-void
.end method

.method public final computeBatteryRealtime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide p0

    return-wide p0
.end method

.method public final computeBatteryScreenOffRealtime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide p0

    return-wide p0
.end method

.method public final computeBatteryScreenOffUptime(JI)J
    .locals 2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getUptime(J)J

    move-result-wide p0

    add-long/2addr p0, v0

    return-wide p0
.end method

.method public final computeBatteryTimeRemaining(J)J
    .locals 2

    iget-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-nez p1, :cond_0

    goto :goto_0

    :cond_0
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget p2, p1, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    const/4 v0, 0x1

    if-ge p2, v0, :cond_1

    goto :goto_0

    :cond_1
    invoke-virtual {p1}, Landroid/os/BatteryStats$LevelStepTracker;->computeTimePerLevel()J

    move-result-wide p1

    const-wide/16 v0, 0x0

    cmp-long v0, p1, v0

    if-gtz v0, :cond_2

    :goto_0
    const-wide/16 p0, -0x1

    return-wide p0

    :cond_2
    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    int-to-long v0, p0

    mul-long/2addr p1, v0

    const-wide/16 v0, 0x3e8

    mul-long/2addr p1, v0

    return-wide p1
.end method

.method public final computeBatteryUptime(JI)J
    .locals 2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getUptime(J)J

    move-result-wide p0

    add-long/2addr p0, v0

    return-wide p0
.end method

.method public final computeChargeTimeRemaining(J)J
    .locals 3

    iget-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz p1, :cond_0

    goto :goto_1

    :cond_0
    iget-wide p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTimeToFullSeconds:J

    const-wide/16 v0, 0x0

    cmp-long v2, p1, v0

    if-ltz v2, :cond_1

    const-wide/32 v0, 0xf4240

    :goto_0
    mul-long/2addr p1, v0

    return-wide p1

    :cond_1
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget p2, p1, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    const/4 v2, 0x1

    if-ge p2, v2, :cond_2

    goto :goto_1

    :cond_2
    invoke-virtual {p1}, Landroid/os/BatteryStats$LevelStepTracker;->computeTimePerLevel()J

    move-result-wide p1

    cmp-long v0, p1, v0

    if-gtz v0, :cond_3

    :goto_1
    const-wide/16 p0, -0x1

    return-wide p0

    :cond_3
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    const/16 v1, 0x64

    if-eqz v0, :cond_5

    if-eq v0, v2, :cond_4

    const/4 v2, 0x2

    if-eq v0, v2, :cond_4

    const/4 v2, 0x3

    if-eq v0, v2, :cond_5

    const/4 v2, 0x4

    if-eq v0, v2, :cond_5

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->checkProtectBatteryType()V

    goto :goto_2

    :cond_4
    const/16 v1, 0x50

    :cond_5
    :goto_2
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    invoke-static {v1, v0}, Ljava/lang/Math;->max(II)I

    move-result v0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    sub-int/2addr v0, p0

    int-to-long v0, v0

    mul-long/2addr p1, v0

    const-wide/16 v0, 0x3e8

    goto :goto_0
.end method

.method public final computeRealtime(JI)J
    .locals 4

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeUs:J

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    sub-long/2addr p1, v2

    add-long/2addr p1, v0

    return-wide p1
.end method

.method public final computeUptime(JI)J
    .locals 4

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUptimeUs:J

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUptimeStartUs:J

    sub-long/2addr p1, v2

    add-long/2addr p1, v0

    return-wide p1
.end method

.method public final distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V
    .locals 18

    move-object/from16 v0, p4

    invoke-virtual {v0}, Landroid/util/SparseDoubleArray;->size()I

    move-result v1

    add-int/lit8 v1, v1, -0x1

    const-wide/16 v2, 0x0

    move-wide v4, v2

    :goto_0
    if-ltz v1, :cond_0

    invoke-virtual {v0, v1}, Landroid/util/SparseDoubleArray;->valueAt(I)D

    move-result-wide v6

    add-double/2addr v4, v6

    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    :cond_0
    move-wide/from16 v6, p5

    invoke-static {v4, v5, v6, v7}, Ljava/lang/Math;->max(DD)D

    move-result-wide v4

    cmpg-double v1, v4, v2

    if-gtz v1, :cond_1

    goto :goto_2

    :cond_1
    invoke-virtual {v0}, Landroid/util/SparseDoubleArray;->size()I

    move-result v1

    add-int/lit8 v1, v1, -0x1

    :goto_1
    if-ltz v1, :cond_3

    invoke-virtual {v0, v1}, Landroid/util/SparseDoubleArray;->keyAt(I)I

    move-result v2

    move-object/from16 v3, p0

    iget-object v6, v3, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-virtual {v0, v1}, Landroid/util/SparseDoubleArray;->valueAt(I)D

    move-result-wide v6

    move-wide/from16 v8, p2

    long-to-double v10, v8

    mul-double/2addr v10, v6

    div-double/2addr v10, v4

    const-wide/high16 v6, 0x3fe0000000000000L    # 0.5

    add-double/2addr v10, v6

    double-to-long v14, v10

    iget-object v6, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v6, :cond_2

    new-instance v6, Lcom/android/internal/power/EnergyConsumerStats;

    iget-object v7, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v7, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-direct {v6, v7}, Lcom/android/internal/power/EnergyConsumerStats;-><init>(Lcom/android/internal/power/EnergyConsumerStats$Config;)V

    iput-object v6, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    :cond_2
    iget-object v12, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    move/from16 v13, p1

    move-wide/from16 v16, p7

    invoke-virtual/range {v12 .. v17}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJJ)V

    add-int/lit8 v1, v1, -0x1

    goto :goto_1

    :cond_3
    :goto_2
    return-void
.end method

.method public final dump(Landroid/content/Context;Ljava/io/PrintWriter;IIJLandroid/os/BatteryStats$BatteryStatsDumpHelper;)V
    .locals 1

    invoke-super/range {p0 .. p7}, Landroid/os/BatteryStats;->dump(Landroid/content/Context;Ljava/io/PrintWriter;IIJLandroid/os/BatteryStats$BatteryStatsDumpHelper;)V

    monitor-enter p0

    :try_start_0
    const-string/jumbo p1, "Per process state tracking available: "

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {p1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->isFastCpuTimesReader()Z

    move-result p1

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->println(Z)V

    const-string/jumbo p1, "Total cpu time reads: "

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-wide p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumSingleUidCpuTimeReads:J

    invoke-virtual {p2, p3, p4}, Ljava/io/PrintWriter;->println(J)V

    const-string p1, "Batching Duration (min): "

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide p3

    iget-wide p5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuTimeReadsTrackingStartTimeMs:J

    sub-long/2addr p3, p5

    const-wide/32 p5, 0xea60

    div-long/2addr p3, p5

    invoke-virtual {p2, p3, p4}, Ljava/io/PrintWriter;->println(J)V

    const-string p1, "All UID cpu time reads since the later of device start or stats reset: "

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->println(I)V

    const-string/jumbo p1, "UIDs removed since the later of device start or stats reset: "

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    invoke-virtual {p2, p1}, Ljava/io/PrintWriter;->println(I)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {p1, p2}, Lcom/android/server/power/stats/PowerStatsUidResolver;->dump(Ljava/io/PrintWriter;)V

    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V

    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->dumpConstantsLocked(Ljava/io/PrintWriter;)V

    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/CpuPowerStatsCollector;->ensureInitialized$1()Z

    move-result p3

    if-nez p3, :cond_0

    goto :goto_1

    :cond_0
    iget-object p3, p1, Lcom/android/server/power/stats/CpuPowerStatsCollector;->mLayout:Lcom/android/server/power/stats/format/CpuPowerStatsLayout;

    if-nez p3, :cond_1

    goto :goto_1

    :cond_1
    const-string p3, "CPU power brackets; cluster/freq in MHz(avg current in mA):"

    invoke-virtual {p2, p3}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    const/4 p3, 0x0

    :goto_0
    iget-object p4, p1, Lcom/android/server/power/stats/CpuPowerStatsCollector;->mLayout:Lcom/android/server/power/stats/format/CpuPowerStatsLayout;

    iget p4, p4, Lcom/android/server/power/stats/format/CpuPowerStatsLayout;->mUidPowerBracketCount:I

    if-ge p3, p4, :cond_2

    const-string p4, "    "

    invoke-virtual {p2, p4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p2, p3}, Ljava/io/PrintWriter;->print(I)V

    const-string p4, ": "

    invoke-virtual {p2, p4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, p3}, Lcom/android/server/power/stats/CpuPowerStatsCollector;->getCpuPowerBracketDescription(I)Ljava/lang/String;

    move-result-object p4

    invoke-virtual {p2, p4}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    add-int/lit8 p3, p3, 0x1

    goto :goto_0

    :cond_2
    :goto_1
    invoke-virtual {p2}, Ljava/io/PrintWriter;->println()V

    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->dumpEnergyConsumerStatsLocked(Ljava/io/PrintWriter;)V

    monitor-exit p0

    return-void

    :catchall_0
    move-exception v0

    move-object p1, v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw p1
.end method

.method public final dumpConstantsLocked(Ljava/io/PrintWriter;)V
    .locals 4

    new-instance v0, Landroid/util/IndentingPrintWriter;

    const-string v1, "    "

    invoke-direct {v0, p1, v1}, Landroid/util/IndentingPrintWriter;-><init>(Ljava/io/Writer;Ljava/lang/String;)V

    const-string p1, "BatteryStats constants:"

    invoke-virtual {v0, p1}, Landroid/util/IndentingPrintWriter;->println(Ljava/lang/String;)V

    invoke-virtual {v0}, Landroid/util/IndentingPrintWriter;->increaseIndent()Landroid/util/IndentingPrintWriter;

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    invoke-virtual {p0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const-string/jumbo p1, "track_cpu_active_cluster_time"

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    const-string p1, "="

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->TRACK_CPU_ACTIVE_CLUSTER_TIME:Z

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Z)V

    const-string/jumbo v1, "kernel_uid_readers_throttle_time"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->KERNEL_UID_READERS_THROTTLE_TIME:J

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->println(J)V

    const-string/jumbo v1, "external_stats_collection_rate_limit_ms"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->EXTERNAL_STATS_COLLECTION_RATE_LIMIT_MS:J

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->println(J)V

    const-string/jumbo v1, "battery_level_collection_delay_ms"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->BATTERY_LEVEL_COLLECTION_DELAY_MS:J

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->println(J)V

    const-string/jumbo v1, "procstate_change_collection_delay_ms"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PROC_STATE_CHANGE_COLLECTION_DELAY_MS:J

    invoke-virtual {v0, v1, v2}, Ljava/io/PrintWriter;->println(J)V

    const-string/jumbo v1, "max_history_size"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->MAX_HISTORY_SIZE:I

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(I)V

    const-string/jumbo v1, "max_history_buffer_kb"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->MAX_HISTORY_BUFFER:I

    div-int/lit16 v1, v1, 0x400

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(I)V

    const-string/jumbo v1, "battery_charged_delay_ms"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->BATTERY_CHARGED_DELAY_MS:I

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(I)V

    const-string/jumbo v1, "battery_charging_enforce_level"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->BATTERY_CHARGING_ENFORCE_LEVEL:I

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(I)V

    const-string/jumbo v1, "per_uid_modem_power_model"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PER_UID_MODEM_MODEL:I

    const/4 v2, 0x1

    if-eq v1, v2, :cond_1

    const/4 v2, 0x2

    if-eq v1, v2, :cond_0

    new-instance v2, Ljava/lang/StringBuilder;

    const-string/jumbo v3, "Unexpected per uid modem model ("

    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v3, ")"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    const-string v3, "BatteryStatsImpl"

    invoke-static {v3, v2}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    new-instance v2, Ljava/lang/StringBuilder;

    const-string/jumbo v3, "unknown_"

    invoke-direct {v2, v3}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    goto :goto_0

    :cond_0
    const-string/jumbo v1, "modem_activity_info_rx_tx"

    goto :goto_0

    :cond_1
    const-string/jumbo v1, "mobile_radio_active_time"

    :goto_0
    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    const-string/jumbo v1, "phone_on_external_stats_collection"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PHONE_ON_EXTERNAL_STATS_COLLECTION:Z

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->println(Z)V

    const-string/jumbo v1, "reset_while_plugged_in_minimum_duration_hours"

    invoke-virtual {v0, v1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v0, p1}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->RESET_WHILE_PLUGGED_IN_MINIMUM_DURATION_HOURS:I

    invoke-virtual {v0, p0}, Ljava/io/PrintWriter;->println(I)V

    invoke-virtual {v0}, Landroid/util/IndentingPrintWriter;->decreaseIndent()Landroid/util/IndentingPrintWriter;

    return-void
.end method

.method public final dumpCpuStatsLocked(Ljava/io/PrintWriter;)V
    .locals 11

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0

    const-string/jumbo v1, "Per UID CPU user & system time in ms:"

    invoke-virtual {p1, v1}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    const/4 v1, 0x0

    move v2, v1

    :goto_0
    const-string v3, ": "

    const-string v4, "  "

    if-ge v2, v0, :cond_0

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(I)V

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    const-wide/16 v7, 0x3e8

    div-long/2addr v3, v7

    invoke-virtual {p1, v3, v4}, Ljava/io/PrintWriter;->print(J)V

    const-string v3, " "

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    div-long/2addr v3, v7

    invoke-virtual {p1, v3, v4}, Ljava/io/PrintWriter;->println(J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_0
    const-string/jumbo v2, "Per UID CPU active time in ms:"

    invoke-virtual {p1, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    move v2, v1

    :goto_1
    if-ge v2, v0, :cond_2

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getCpuActiveTime()J

    move-result-wide v7

    const-wide/16 v9, 0x0

    cmp-long v7, v7, v9

    if-lez v7, :cond_1

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(I)V

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getCpuActiveTime()J

    move-result-wide v5

    invoke-virtual {p1, v5, v6}, Ljava/io/PrintWriter;->println(J)V

    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    :cond_2
    const-string/jumbo v2, "Per UID CPU cluster time in ms:"

    invoke-virtual {p1, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    move v2, v1

    :goto_2
    if-ge v2, v0, :cond_4

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getCpuClusterTimes()[J

    move-result-object v6

    if-eqz v6, :cond_3

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(I)V

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-static {v6}, Ljava/util/Arrays;->toString([J)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_3
    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    :cond_4
    const-string/jumbo v2, "Per UID CPU frequency time in ms:"

    invoke-virtual {p1, v2}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    move v2, v1

    :goto_3
    if-ge v2, v0, :cond_6

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v6, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v6, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->nullIfAllZeros(Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;I)[J

    move-result-object v6

    if-eqz v6, :cond_5

    invoke-virtual {p1, v4}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->print(I)V

    invoke-virtual {p1, v3}, Ljava/io/PrintWriter;->print(Ljava/lang/String;)V

    invoke-static {v6}, Ljava/util/Arrays;->toString([J)Ljava/lang/String;

    move-result-object v5

    invoke-virtual {p1, v5}, Ljava/io/PrintWriter;->println(Ljava/lang/String;)V

    :cond_5
    add-int/lit8 v2, v2, 0x1

    goto :goto_3

    :cond_6
    return-void
.end method

.method public final dumpEnergyConsumerStatsLocked(Ljava/io/PrintWriter;)V
    .locals 5

    const/4 v0, 0x0

    new-array v1, v0, [Ljava/lang/Object;

    const-string/jumbo v2, "On-battery energy consumer stats (microcoulombs) \n"

    invoke-virtual {p1, v2, v1}, Ljava/io/PrintWriter;->printf(Ljava/lang/String;[Ljava/lang/Object;)Ljava/io/PrintWriter;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_0

    const-string p0, "    Not supported on this device.\n"

    new-array v0, v0, [Ljava/lang/Object;

    invoke-virtual {p1, p0, v0}, Ljava/io/PrintWriter;->printf(Ljava/lang/String;[Ljava/lang/Object;)Ljava/io/PrintWriter;

    return-void

    :cond_0
    const-string/jumbo v2, "global usage"

    invoke-static {p1, v2, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->dumpEnergyConsumerStatsLocked(Ljava/io/PrintWriter;Ljava/lang/String;Lcom/android/internal/power/EnergyConsumerStats;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    :goto_0
    if-ge v0, v1, :cond_1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v0}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v2

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v3, v2}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    new-instance v3, Ljava/lang/StringBuilder;

    const-string/jumbo v4, "uid "

    invoke-direct {v3, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    iget v4, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    invoke-static {p1, v3, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->dumpEnergyConsumerStatsLocked(Ljava/io/PrintWriter;Ljava/lang/String;Lcom/android/internal/power/EnergyConsumerStats;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_1
    return-void
.end method

.method public final ensureKernelSingleUidTimeReaderLocked()V
    .locals 3

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-nez v0, :cond_2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    if-eqz v0, :cond_0

    goto :goto_1

    :cond_0
    new-instance v0, Lcom/android/internal/os/KernelSingleUidTimeReader;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v2}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result v2

    invoke-direct {v0, v2}, Lcom/android/internal/os/KernelSingleUidTimeReader;-><init>(I)V

    iput-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->perClusterTimesAvailable()Z

    move-result v0

    if-eqz v0, :cond_1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelSingleUidTimeReader;->singleUidCpuTimesAvailable()Z

    move-result v0

    if-eqz v0, :cond_1

    goto :goto_0

    :cond_1
    const/4 v1, 0x0

    :goto_0
    iput-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerProcStateCpuTimesAvailable:Z

    :cond_2
    :goto_1
    return-void
.end method

.method public final evaluateOverallScreenBrightnessBinLocked()I
    .locals 7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v0, v0

    const/4 v1, -0x1

    const/4 v2, 0x0

    move v3, v1

    :goto_0
    if-ge v2, v0, :cond_2

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v4, v4, v2

    iget v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    const/4 v6, 0x2

    if-ne v5, v6, :cond_0

    iget v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    goto :goto_1

    :cond_0
    move v4, v1

    :goto_1
    if-le v4, v3, :cond_1

    move v3, v4

    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_2
    return v3
.end method

.method public final fillLowPowerStats()V
    .locals 16

    move-object/from16 v1, p0

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPlatformIdleStateCallback:Lcom/android/server/am/BatteryStatsService;

    if-nez v0, :cond_0

    goto/16 :goto_5

    :cond_0
    new-instance v2, Lcom/android/internal/os/RpmStats;

    invoke-direct {v2}, Lcom/android/internal/os/RpmStats;-><init>()V

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v3

    iget-wide v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastRpmStatsUpdateTimeMs:J

    sub-long v5, v3, v5

    const-wide/16 v7, 0x3e8

    cmp-long v0, v5, v7

    if-ltz v0, :cond_6

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPlatformIdleStateCallback:Lcom/android/server/am/BatteryStatsService;

    iget-object v5, v0, Lcom/android/server/am/BatteryStatsService;->mPowerStatsLock:Ljava/lang/Object;

    monitor-enter v5

    :try_start_0
    iget-object v6, v0, Lcom/android/server/am/BatteryStatsService;->mPowerStatsInternal:Landroid/power/PowerStatsInternal;

    if-eqz v6, :cond_4

    iget-object v6, v0, Lcom/android/server/am/BatteryStatsService;->mEntityNames:Ljava/util/Map;

    check-cast v6, Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->isEmpty()Z

    move-result v6

    if-nez v6, :cond_4

    iget-object v6, v0, Lcom/android/server/am/BatteryStatsService;->mStateNames:Ljava/util/Map;

    check-cast v6, Ljava/util/HashMap;

    invoke-virtual {v6}, Ljava/util/HashMap;->isEmpty()Z

    move-result v6

    if-eqz v6, :cond_1

    goto/16 :goto_2

    :cond_1
    monitor-exit v5
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    :try_start_1
    iget-object v5, v0, Lcom/android/server/am/BatteryStatsService;->mPowerStatsInternal:Landroid/power/PowerStatsInternal;

    const/4 v6, 0x0

    new-array v7, v6, [I

    invoke-virtual {v5, v7}, Landroid/power/PowerStatsInternal;->getStateResidencyAsync([I)Ljava/util/concurrent/CompletableFuture;

    move-result-object v5

    sget-object v7, Ljava/util/concurrent/TimeUnit;->MILLISECONDS:Ljava/util/concurrent/TimeUnit;

    const-wide/16 v8, 0x7d0

    invoke-virtual {v5, v8, v9, v7}, Ljava/util/concurrent/CompletableFuture;->get(JLjava/util/concurrent/TimeUnit;)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, [Landroid/hardware/power/stats/StateResidencyResult;
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    if-nez v5, :cond_2

    goto :goto_3

    :cond_2
    move v7, v6

    :goto_0
    array-length v8, v5

    if-ge v7, v8, :cond_5

    aget-object v8, v5, v7

    iget-object v9, v0, Lcom/android/server/am/BatteryStatsService;->mEntityNames:Ljava/util/Map;

    iget v10, v8, Landroid/hardware/power/stats/StateResidencyResult;->id:I

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    check-cast v9, Ljava/util/HashMap;

    invoke-virtual {v9, v10}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-virtual {v2, v9}, Lcom/android/internal/os/RpmStats;->getSubsystem(Ljava/lang/String;)Lcom/android/internal/os/RpmStats$PowerStateSubsystem;

    move-result-object v9

    move v10, v6

    :goto_1
    iget-object v11, v8, Landroid/hardware/power/stats/StateResidencyResult;->stateResidencyData:[Landroid/hardware/power/stats/StateResidency;

    array-length v12, v11

    if-ge v10, v12, :cond_3

    aget-object v11, v11, v10

    iget-object v12, v0, Lcom/android/server/am/BatteryStatsService;->mStateNames:Ljava/util/Map;

    iget v13, v8, Landroid/hardware/power/stats/StateResidencyResult;->id:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    check-cast v12, Ljava/util/HashMap;

    invoke-virtual {v12, v13}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Ljava/util/Map;

    iget v13, v11, Landroid/hardware/power/stats/StateResidency;->id:I

    invoke-static {v13}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v13

    invoke-interface {v12, v13}, Ljava/util/Map;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Ljava/lang/String;

    iget-wide v13, v11, Landroid/hardware/power/stats/StateResidency;->totalTimeInStateMs:J

    move v15, v7

    iget-wide v6, v11, Landroid/hardware/power/stats/StateResidency;->totalStateEntryCount:J

    long-to-int v6, v6

    invoke-virtual {v9, v12, v13, v14, v6}, Lcom/android/internal/os/RpmStats$PowerStateSubsystem;->putState(Ljava/lang/String;JI)V

    add-int/lit8 v10, v10, 0x1

    move v7, v15

    const/4 v6, 0x0

    goto :goto_1

    :cond_3
    move v15, v7

    add-int/lit8 v7, v15, 0x1

    const/4 v6, 0x0

    goto :goto_0

    :catch_0
    move-exception v0

    const-string v5, "BatteryStatsService"

    const-string v6, "Failed to getStateResidencyAsync"

    invoke-static {v5, v6, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    goto :goto_3

    :catchall_0
    move-exception v0

    goto :goto_4

    :cond_4
    :goto_2
    :try_start_2
    monitor-exit v5
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    :cond_5
    :goto_3
    monitor-enter p0

    :try_start_3
    iput-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRpmStats:Lcom/android/internal/os/RpmStats;

    iput-wide v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastRpmStatsUpdateTimeMs:J

    monitor-exit p0

    goto :goto_5

    :catchall_1
    move-exception v0

    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    throw v0

    :goto_4
    :try_start_4
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    throw v0

    :cond_6
    :goto_5
    return-void
.end method

.method public forceRecordAllHistory()V
    .locals 1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0}, Lcom/android/internal/os/BatteryStatsHistory;->forceRecordAllHistory()V

    const/4 v0, 0x1

    iput-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    return-void
.end method

.method public final gatBatteryHistoryResetLevel()I
    .locals 3

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    const/16 v1, 0x5a

    if-eqz v0, :cond_1

    const/4 v2, 0x1

    if-eq v0, v2, :cond_0

    const/4 v2, 0x2

    if-eq v0, v2, :cond_0

    const/4 v2, 0x3

    if-eq v0, v2, :cond_1

    const/4 v2, 0x4

    if-eq v0, v2, :cond_1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->checkProtectBatteryType()V

    return v1

    :cond_0
    const/16 p0, 0x46

    return p0

    :cond_1
    return v1
.end method

.method public final getActiveRadioDurationMs(IIIJ)J
    .locals 2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object p0, p0, p1

    const-wide/16 v0, 0x0

    if-nez p0, :cond_0

    return-wide v0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length p1, p0

    if-ltz p2, :cond_3

    if-lt p2, p1, :cond_1

    goto :goto_0

    :cond_1
    aget-object p0, p0, p2

    array-length p1, p0

    if-ltz p3, :cond_3

    if-lt p3, p1, :cond_2

    goto :goto_0

    :cond_2
    aget-object p0, p0, p3

    const-wide/16 p1, 0x3e8

    mul-long/2addr p4, p1

    const/4 p3, 0x0

    invoke-virtual {p0, p4, p5, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p3

    div-long/2addr p3, p1

    return-wide p3

    :cond_3
    :goto_0
    return-wide v0
.end method

.method public final getActiveRxRadioDurationMs(IIJ)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object p0, p0, p1

    const-wide/16 p3, -0x1

    if-nez p0, :cond_0

    return-wide p3

    :cond_0
    const/4 p1, 0x0

    invoke-virtual {p0, p2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getRxDurationCounter(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object p0

    if-nez p0, :cond_1

    return-wide p3

    :cond_1
    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getActiveTxRadioDurationMs(IIIJ)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object p0, p0, p1

    const-wide/16 p4, -0x1

    if-nez p0, :cond_0

    return-wide p4

    :cond_0
    const/4 p1, 0x0

    invoke-virtual {p0, p2, p3, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getTxDurationCounter(IIZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object p0

    if-nez p0, :cond_1

    return-wide p4

    :cond_1
    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getBatteryCCInfo()I
    .locals 4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryCCUpdateTime:J

    sub-long/2addr v0, v2

    const-wide/16 v2, 0x0

    invoke-static {v0, v1, v2, v3}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v0

    const-wide/16 v2, 0x3e8

    cmp-long v0, v0, v2

    if-gez v0, :cond_0

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryCC:I

    if-ltz v0, :cond_0

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsCoulombCounterReported:Z

    if-eqz v1, :cond_0

    return v0

    :cond_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsCoulombCounterReported:Z

    if-eqz v0, :cond_2

    const-string v0, "/sys/class/power_supply/battery/cc_info"

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getIntFromFile(Ljava/lang/String;)I

    move-result v0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryCC:I

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryCCUpdateTime:J

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryCC:I

    const/4 v0, -0x1

    if-ne p0, v0, :cond_1

    goto :goto_0

    :cond_1
    return p0

    :cond_2
    :goto_0
    const/4 p0, 0x0

    return p0
.end method

.method public final getBatteryPermil()I
    .locals 4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryRawUpdateTime:J

    sub-long/2addr v0, v2

    const-wide/16 v2, 0x0

    invoke-static {v0, v1, v2, v3}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v0

    const-wide/16 v2, 0x3e8

    cmp-long v0, v0, v2

    if-gez v0, :cond_0

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryRaw:I

    if-ltz v0, :cond_0

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsRawSocReported:Z

    if-eqz v1, :cond_0

    div-int/lit8 v0, v0, 0xa

    return v0

    :cond_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsRawSocReported:Z

    if-eqz v0, :cond_2

    const-string v0, "/sys/class/power_supply/battery/batt_read_raw_soc"

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getIntFromFile(Ljava/lang/String;)I

    move-result v0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryRaw:I

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryRawUpdateTime:J

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryRaw:I

    if-gez p0, :cond_1

    invoke-static {}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryLevel()I

    move-result p0

    :goto_0
    mul-int/lit8 p0, p0, 0xa

    return p0

    :cond_1
    div-int/lit8 p0, p0, 0xa

    return p0

    :cond_2
    invoke-static {}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryLevel()I

    move-result p0

    goto :goto_0
.end method

.method public final getBatteryRealtime(J)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getRealtime(J)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getBatteryStatsSession()Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;
    .locals 15

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    const-wide/16 v2, 0x3e8

    mul-long/2addr v0, v2

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->computeBatteryTimeRemaining(J)J

    move-result-wide v4

    const-wide/16 v6, 0x0

    cmp-long v8, v4, v6

    const-wide/16 v9, -0x1

    if-ltz v8, :cond_0

    div-long/2addr v4, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    move-object v14, p0

    goto :goto_1

    :cond_0
    move-wide v4, v9

    :goto_0
    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->computeChargeTimeRemaining(J)J

    move-result-wide v0

    cmp-long v6, v0, v6

    if-ltz v6, :cond_1

    div-long v9, v0, v2

    :cond_1
    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v7, v4

    iget-wide v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicStartTime:J

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getStartClockTime()J

    move-result-wide v5

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    int-to-long v11, v0

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getCustomEnergyConsumerNames()[Ljava/lang/String;

    move-result-object v13
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-object v14, p0

    :try_start_1
    invoke-direct/range {v1 .. v14}, Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;-><init>(Lcom/android/internal/os/BatteryStatsHistory;JJJJJ[Ljava/lang/String;Lcom/android/server/power/stats/BatteryStatsImpl;)V

    monitor-exit v14

    return-object v1

    :catchall_1
    move-exception v0

    :goto_1
    monitor-exit v14
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0
.end method

.method public final getBatteryUptime(J)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getUptime(J)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getBluetoothBatteryStats()Landroid/os/BluetoothBatteryStats;
    .locals 25

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v1

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6}, Landroid/util/SparseArray;->size()I

    move-result v6

    add-int/lit8 v6, v6, -0x1

    :goto_0
    if-ltz v6, :cond_7

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v7, v6}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    const/4 v9, 0x0

    const-wide/16 v10, 0x0

    if-eqz v8, :cond_0

    invoke-virtual {v8, v1, v2, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v12

    div-long/2addr v12, v3

    move-wide/from16 v16, v12

    goto :goto_1

    :cond_0
    move-wide/from16 v16, v10

    :goto_1
    iget-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v8, :cond_1

    invoke-virtual {v8, v1, v2, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v12

    div-long/2addr v12, v3

    move-wide/from16 v18, v12

    goto :goto_2

    :cond_1
    move-wide/from16 v18, v10

    :goto_2
    iget-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-eqz v8, :cond_2

    iget-object v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->mCount:Ljava/util/concurrent/atomic/AtomicInteger;

    invoke-virtual {v8}, Ljava/util/concurrent/atomic/AtomicInteger;->get()I

    move-result v8

    move/from16 v20, v8

    goto :goto_3

    :cond_2
    move/from16 v20, v9

    :goto_3
    iget-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    if-eqz v8, :cond_3

    invoke-virtual {v8}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getRxTimeCounter()Landroid/os/BatteryStats$LongCounter;

    move-result-object v12

    invoke-virtual {v12, v9}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v12

    move-wide/from16 v21, v12

    goto :goto_4

    :cond_3
    move-wide/from16 v21, v10

    :goto_4
    if-eqz v8, :cond_4

    invoke-virtual {v8}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getTxTimeCounters()[Landroid/os/BatteryStats$LongCounter;

    move-result-object v8

    aget-object v8, v8, v9

    invoke-virtual {v8, v9}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v8

    move-wide/from16 v23, v8

    goto :goto_5

    :cond_4
    move-wide/from16 v23, v10

    :goto_5
    cmp-long v8, v16, v10

    if-nez v8, :cond_5

    cmp-long v8, v18, v10

    if-nez v8, :cond_5

    if-nez v20, :cond_5

    cmp-long v8, v21, v10

    if-nez v8, :cond_5

    cmp-long v8, v23, v10

    if-eqz v8, :cond_6

    :cond_5
    new-instance v14, Landroid/os/BluetoothBatteryStats$UidStats;

    iget v15, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-direct/range {v14 .. v24}, Landroid/os/BluetoothBatteryStats$UidStats;-><init>(IJJIJJ)V

    invoke-virtual {v5, v14}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_6
    add-int/lit8 v6, v6, -0x1

    goto :goto_0

    :cond_7
    new-instance v0, Landroid/os/BluetoothBatteryStats;

    invoke-direct {v0, v5}, Landroid/os/BluetoothBatteryStats;-><init>(Ljava/util/List;)V

    return-object v0
.end method

.method public final getBluetoothControllerActivity()Landroid/os/BatteryStats$ControllerActivityCounter;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    return-object p0
.end method

.method public final getBluetoothEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x5

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getBluetoothScanTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getCameraEnergyConsumptionUC()J
    .locals 2

    const/16 v0, 0x8

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getCameraOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getCellularBatteryStats()Landroid/os/connectivity/CellularBatteryStats;
    .locals 33

    move-object/from16 v0, p0

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v1

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v6, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v6, v6, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getIdleTimeCounter()Landroid/os/BatteryStats$LongCounter;

    move-result-object v8

    const/4 v9, 0x0

    invoke-virtual {v8, v9}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v22

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getRxTimeCounter()Landroid/os/BatteryStats$LongCounter;

    move-result-object v8

    invoke-virtual {v8, v9}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v24

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v8, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mMonitoredRailChargeConsumedMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v12, v8, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    sget v8, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    new-array v14, v8, [J

    move v15, v9

    :goto_0
    if-ge v15, v8, :cond_0

    invoke-virtual {v0, v15, v1, v2, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPhoneDataConnectionTime(IJI)J

    move-result-wide v16

    div-long v16, v16, v3

    aput-wide v16, v14, v15

    add-int/lit8 v15, v15, 0x1

    goto :goto_0

    :cond_0
    sget v8, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    new-array v15, v8, [J

    move-wide/from16 v16, v3

    move v3, v9

    :goto_1
    if-ge v3, v8, :cond_1

    invoke-virtual {v0, v3, v1, v2, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPhoneSignalStrengthTime(IJI)J

    move-result-wide v18

    div-long v18, v18, v16

    aput-wide v18, v15, v3

    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    :cond_1
    sget v3, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getTxTimeCounters()[Landroid/os/BatteryStats$LongCounter;

    move-result-object v4

    array-length v4, v4

    invoke-static {v3, v4}, Ljava/lang/Math;->min(II)I

    move-result v3

    new-array v4, v3, [J

    move v8, v9

    :goto_2
    if-ge v8, v3, :cond_2

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getTxTimeCounters()[Landroid/os/BatteryStats$LongCounter;

    move-result-object v18

    move/from16 v19, v3

    aget-object v3, v18, v8

    invoke-virtual {v3, v9}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v20

    aput-wide v20, v4, v8

    add-int/lit8 v8, v8, 0x1

    move/from16 v3, v19

    goto :goto_2

    :cond_2
    new-instance v3, Landroid/os/connectivity/CellularBatteryStats;

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide v18

    div-long v18, v18, v16

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v5, v1, v2, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v1

    div-long v1, v1, v16

    const/4 v5, 0x1

    move-wide/from16 v31, v12

    invoke-virtual {v0, v5, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityPackets(II)J

    move-result-wide v12

    invoke-virtual {v0, v5, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityBytes(II)J

    move-result-wide v16

    move-object/from16 v28, v14

    move-object/from16 v29, v15

    move-wide/from16 v14, v16

    invoke-virtual {v0, v9, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityPackets(II)J

    move-result-wide v16

    invoke-virtual {v0, v9, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityBytes(II)J

    move-result-wide v8

    move-wide/from16 v20, v18

    move-wide/from16 v18, v8

    move-wide/from16 v8, v20

    move-object/from16 v30, v4

    move-wide/from16 v20, v6

    move-wide/from16 v26, v10

    move-wide v10, v1

    move-object v7, v3

    invoke-direct/range {v7 .. v32}, Landroid/os/connectivity/CellularBatteryStats;-><init>(JJJJJJJJJJ[J[J[JJ)V

    return-object v7
.end method

.method public final getChargeLevelStepTracker()Landroid/os/BatteryStats$LevelStepTracker;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    return-object p0
.end method

.method public final getCoverDisplayHighRefreshRateTime(JI)J
    .locals 5

    const-wide/16 v0, 0x0

    const/4 v2, 0x0

    :goto_0
    const/4 v3, 0x4

    if-ge v2, v3, :cond_1

    if-eqz v2, :cond_0

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v3, v3, v2

    invoke-virtual {v3, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v3

    add-long/2addr v3, v0

    move-wide v0, v3

    :cond_0
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_1
    return-wide v0
.end method

.method public final getCoverDisplayRefreshRateTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getCpuEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x3

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getCpuScalingPolicies()Lcom/android/internal/os/CpuScalingPolicies;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    return-object p0
.end method

.method public final getCurrentDailyStartTime()J
    .locals 2

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    return-wide v0
.end method

.method public final getCustomEnergyConsumerBatteryConsumptionUC()[J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez p0, :cond_0

    const/4 p0, 0x0

    return-object p0

    :cond_0
    invoke-virtual {p0}, Lcom/android/internal/power/EnergyConsumerStats;->getAccumulatedCustomBucketCharges()[J

    move-result-object p0

    return-object p0
.end method

.method public final getCustomEnergyConsumerNames()[Ljava/lang/String;
    .locals 4

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    const/4 v1, 0x0

    if-nez v0, :cond_0

    new-array v0, v1, [Ljava/lang/String;

    monitor-exit p0

    return-object v0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    invoke-virtual {v0}, Lcom/android/internal/power/EnergyConsumerStats$Config;->getCustomBucketNames()[Ljava/lang/String;

    move-result-object v0

    :goto_0
    array-length v2, v0

    if-ge v1, v2, :cond_2

    aget-object v2, v0, v1

    invoke-static {v2}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v2

    if-eqz v2, :cond_1

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "CUSTOM_1000"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    aput-object v2, v0, v1

    :cond_1
    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_2
    monitor-exit p0

    return-object v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDailyChargeLevelStepTracker()Landroid/os/BatteryStats$LevelStepTracker;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    return-object p0
.end method

.method public final getDailyDischargeLevelStepTracker()Landroid/os/BatteryStats$LevelStepTracker;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    return-object p0
.end method

.method public final getDailyItemLocked(I)Landroid/os/BatteryStats$DailyItem;
    .locals 1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    add-int/lit8 v0, v0, -0x1

    sub-int/2addr v0, p1

    if-ltz v0, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Landroid/os/BatteryStats$DailyItem;

    return-object p0

    :cond_0
    const/4 p0, 0x0

    return-object p0
.end method

.method public final getDailyPackageChanges()Ljava/util/ArrayList;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    return-object p0
.end method

.method public final getDeviceIdleModeCount(II)I
    .locals 0

    const/4 p2, 0x1

    if-eq p1, p2, :cond_1

    const/4 p2, 0x2

    if-eq p1, p2, :cond_0

    const/4 p0, 0x0

    return p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0

    :cond_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getDeviceIdleModeTime(IJI)J
    .locals 1

    const/4 v0, 0x1

    if-eq p1, v0, :cond_1

    const/4 v0, 0x2

    if-eq p1, v0, :cond_0

    const-wide/16 p0, 0x0

    return-wide p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0

    :cond_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getDeviceIdlingCount(II)I
    .locals 0

    const/4 p2, 0x1

    if-eq p1, p2, :cond_1

    const/4 p2, 0x2

    if-eq p1, p2, :cond_0

    const/4 p0, 0x0

    return p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0

    :cond_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getDeviceIdlingTime(IJI)J
    .locals 1

    const/4 v0, 0x1

    if-eq p1, v0, :cond_1

    const/4 v0, 0x2

    if-eq p1, v0, :cond_0

    const-wide/16 p0, 0x0

    return-wide p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0

    :cond_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getDischargeAmount(I)I
    .locals 0

    if-nez p1, :cond_0

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getHighDischargeAmountSinceCharge()I

    move-result p0

    goto :goto_0

    :cond_0
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeStartLevel()I

    move-result p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeCurrentLevel()I

    move-result p0

    sub-int p0, p1, p0

    :goto_0
    if-gez p0, :cond_1

    const/4 p0, 0x0

    :cond_1
    return p0
.end method

.method public final getDischargeAmountScreenDoze()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenDozeSinceCharge()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceCharge:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenDozeSinceChargePermil()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isDozeState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOff()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isOffState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeAmountScreenDoze()I

    move-result v1

    add-int/2addr v0, v1

    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOffSinceCharge()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceCharge:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isOffState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeAmountScreenDozeSinceCharge()I

    move-result v1

    add-int/2addr v0, v1

    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOffSinceChargeCoulombCounter()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargeCoulombCounter:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryCCInfo()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOffState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOffSinceChargePermil()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOffState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOn()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isOnState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOnSinceCharge()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceCharge:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isOnState(I)Z

    move-result v1

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOnSinceChargeCoulombCounter()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargeCoulombCounter:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryCCInfo()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountScreenOnSinceChargePermil()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountSilentOnScreenOffSinceChargePermil()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    if-nez v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountSilentOnScreenOnSinceChargePermil()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v1

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v2, :cond_0

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    if-eqz v2, :cond_0

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountSubScreenDozeSinceChargePermil()I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenDozeSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    monitor-exit p0

    return v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeAmountSubScreenOnSinceChargePermil()I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenOnSinceChargePermil:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    monitor-exit p0

    return v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeCurrentLevel()I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    monitor-exit p0

    return v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDischargeLevelStepTracker()Landroid/os/BatteryStats$LevelStepTracker;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    return-object p0
.end method

.method public final getDischargeStartLevel()I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    monitor-exit p0

    return v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getDisplayCount()I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length p0, p0

    return p0
.end method

.method public final getDisplayScreenBrightnessTime(IIJ)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object p0, p0, p1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p2

    const/4 p1, 0x0

    invoke-virtual {p0, p3, p4, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getDisplayScreenDozeTime(IJ)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object p0, p0, p1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 p1, 0x0

    invoke-virtual {p0, p2, p3, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getDisplayScreenOnTime(IJ)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object p0, p0, p1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 p1, 0x0

    invoke-virtual {p0, p2, p3, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getEndPlatformVersion()Ljava/lang/String;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEndPlatformVersion:Ljava/lang/String;

    return-object p0
.end method

.method public final getEstimatedBatteryCapacity()I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    return p0
.end method

.method public final getExternalStatsCollectionRateLimitMs()J
    .locals 2

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-wide v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->EXTERNAL_STATS_COLLECTION_RATE_LIMIT_MS:J

    monitor-exit p0

    return-wide v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getFlashlightOnCount(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    int-to-long p0, p0

    return-wide p0
.end method

.method public final getFlashlightOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getGlobalWifiRunningTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getGnssEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x6

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getGpsBatteryDrainMaMs()J
    .locals 12

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v1, "gps.voltage"

    invoke-virtual {v0, v1}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v0

    const-wide v2, 0x408f400000000000L    # 1000.0

    div-double/2addr v0, v2

    const-wide/16 v2, 0x0

    cmpl-double v0, v0, v2

    if-nez v0, :cond_0

    const-wide/16 v0, 0x0

    return-wide v0

    :cond_0
    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v0

    const-wide/16 v4, 0x3e8

    mul-long/2addr v0, v4

    const/4 v6, 0x0

    move v7, v6

    :goto_0
    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v8, v8

    if-ge v7, v8, :cond_1

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v9, "gps.signalqualitybased"

    invoke-virtual {v8, v9, v7}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;I)D

    move-result-wide v8

    invoke-virtual {p0, v7, v0, v1, v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getGpsSignalQualityTime(IJI)J

    move-result-wide v10

    div-long/2addr v10, v4

    long-to-double v10, v10

    mul-double/2addr v8, v10

    add-double/2addr v2, v8

    add-int/lit8 v7, v7, 0x1

    goto :goto_0

    :cond_1
    double-to-long v0, v2

    return-wide v0
.end method

.method public final getGpsBatteryStats()Landroid/os/connectivity/GpsBatteryStats;
    .locals 11

    new-instance v0, Landroid/os/connectivity/GpsBatteryStats;

    invoke-direct {v0}, Landroid/os/connectivity/GpsBatteryStats;-><init>()V

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v1

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide v5

    div-long/2addr v5, v3

    invoke-virtual {v0, v5, v6}, Landroid/os/connectivity/GpsBatteryStats;->setLoggingDurationMs(J)V

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getGpsBatteryDrainMaMs()J

    move-result-wide v5

    invoke-virtual {v0, v5, v6}, Landroid/os/connectivity/GpsBatteryStats;->setEnergyConsumedMaMs(J)V

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v5, v5

    new-array v6, v5, [J

    const/4 v7, 0x0

    move v8, v7

    :goto_0
    if-ge v8, v5, :cond_0

    invoke-virtual {p0, v8, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getGpsSignalQualityTime(IJI)J

    move-result-wide v9

    div-long/2addr v9, v3

    aput-wide v9, v6, v8

    add-int/lit8 v8, v8, 0x1

    goto :goto_0

    :cond_0
    invoke-virtual {v0, v6}, Landroid/os/connectivity/GpsBatteryStats;->setTimeInGpsSignalQualityLevel([J)V

    return-object v0
.end method

.method public final getGpsSignalQualityTime(IJI)J
    .locals 1

    if-ltz p1, :cond_1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v0, p0

    if-lt p1, v0, :cond_0

    goto :goto_0

    :cond_0
    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0

    :cond_1
    :goto_0
    const-wide/16 p0, 0x0

    return-wide p0
.end method

.method public final getHighDischargeAmountSinceCharge()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHighDischargeAmountSinceCharge:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getHistoryStringPoolBytes()I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->getHistoryStringPoolBytes()I

    move-result p0

    return p0
.end method

.method public final getHistoryStringPoolSize()I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->getHistoryStringPoolSize()I

    move-result p0

    return p0
.end method

.method public final getHistoryTagPoolString(I)Ljava/lang/String;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0, p1}, Lcom/android/internal/os/BatteryStatsHistory;->getHistoryTagPoolString(I)Ljava/lang/String;

    move-result-object p0

    return-object p0
.end method

.method public final getHistoryTagPoolUid(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0, p1}, Lcom/android/internal/os/BatteryStatsHistory;->getHistoryTagPoolUid(I)I

    move-result p0

    return p0
.end method

.method public final getHistoryTotalSize()I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHistoryDirectory:Lcom/android/server/power/stats/BatteryHistoryDirectory;

    iget p0, p0, Lcom/android/server/power/stats/BatteryHistoryDirectory;->mMaxHistorySize:I

    return p0
.end method

.method public final getHistoryUsedSize()I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->getHistoryUsedSize()I

    move-result p0

    return p0
.end method

.method public final getInteractiveTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getIsOnBattery()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    return p0
.end method

.method public final getKernelCpuSpeedTimes()[[J
    .locals 5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    const/4 v1, 0x0

    if-nez v0, :cond_0

    const/4 p0, 0x2

    new-array p0, p0, [I

    const/4 v0, 0x1

    aput v1, p0, v0

    aput v1, p0, v1

    sget-object v0, Ljava/lang/Long;->TYPE:Ljava/lang/Class;

    invoke-static {v0, p0}, Ljava/lang/reflect/Array;->newInstance(Ljava/lang/Class;[I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, [[J

    return-object p0

    :cond_0
    array-length v0, v0

    new-array v0, v0, [[J

    move v2, v1

    :goto_0
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    array-length v4, v3

    if-ge v2, v4, :cond_3

    aget-object v3, v3, v2

    if-nez v3, :cond_1

    new-array v3, v1, [J

    aput-object v3, v0, v2

    goto :goto_1

    :cond_1
    invoke-virtual {v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getSize()I

    move-result v3

    new-array v3, v3, [J

    aput-object v3, v0, v2

    array-length v3, v3

    if-lez v3, :cond_2

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v3, v3, v2

    invoke-virtual {v3, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getCountsLocked(I)[J

    move-result-object v3

    aput-object v3, v0, v2

    :cond_2
    :goto_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_3
    return-object v0
.end method

.method public final getKernelMemoryStats()Landroid/util/LongSparseArray;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    return-object p0
.end method

.method public final getKernelWakelockStats()Ljava/util/Map;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    return-object p0
.end method

.method public final getLearnedBatteryCapacity()I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    return p0
.end method

.method public final getLongestDeviceIdleModeTime(I)J
    .locals 1

    const/4 v0, 0x1

    if-eq p1, v0, :cond_1

    const/4 v0, 0x2

    if-eq p1, v0, :cond_0

    const-wide/16 p0, 0x0

    return-wide p0

    :cond_0
    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    return-wide p0

    :cond_1
    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    return-wide p0
.end method

.method public final getLowDischargeAmountSinceCharge()I
    .locals 3

    monitor-enter p0

    :try_start_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLowDischargeAmountSinceCharge:I

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_0

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    if-ge v1, v2, :cond_0

    sub-int/2addr v2, v1

    add-int/lit8 v2, v2, -0x1

    add-int/2addr v0, v2

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getMainDisplayHighRefreshRateTime(JI)J
    .locals 5

    const-wide/16 v0, 0x0

    const/4 v2, 0x0

    :goto_0
    const/4 v3, 0x4

    if-ge v2, v3, :cond_1

    if-eqz v2, :cond_0

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v3, v3, v2

    invoke-virtual {v3, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v3

    add-long/2addr v3, v0

    move-wide v0, v3

    :cond_0
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_1
    return-wide v0
.end method

.method public final getMainDisplayRefreshRateTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getMaxLearnedBatteryCapacity()I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    return p0
.end method

.method public final getMinLearnedBatteryCapacity()I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    return p0
.end method

.method public final getMobileActive5GTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getMobileActiveTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getMobileRadioActiveAdjustedTime(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getMobileRadioActiveCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getMobileRadioActiveTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getMobileRadioActiveUnknownCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    long-to-int p0, p0

    return p0
.end method

.method public final getMobileRadioActiveUnknownTime(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getMobileRadioEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x7

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getModemControllerActivity()Landroid/os/BatteryStats$ControllerActivityCounter;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    return-object p0
.end method

.method public final getNetworkActivityBytes(II)J
    .locals 0

    if-ltz p1, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length p2, p0

    if-ge p1, p2, :cond_0

    aget-object p0, p0, p1

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0

    :cond_0
    const-wide/16 p0, 0x0

    return-wide p0
.end method

.method public final getNetworkActivityPackets(II)J
    .locals 0

    if-ltz p1, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length p2, p0

    if-ge p1, p2, :cond_0

    aget-object p0, p0, p1

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0

    :cond_0
    const-wide/16 p0, 0x0

    return-wide p0
.end method

.method public final getNetworkModemControllerActivity()Landroid/os/BatteryStats$ModemActivityCounter;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    return-object p0
.end method

.method public final getNextMaxDailyDeadline()J
    .locals 2

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    return-wide v0
.end method

.method public final getNextMinDailyDeadline()J
    .locals 2

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    return-wide v0
.end method

.method public final getNrNsaTime(J)J
    .locals 1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 v0, 0x0

    invoke-virtual {p0, p1, p2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getNumConnectivityChange(I)I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumConnectivityChange:I

    return p0
.end method

.method public final getParcelVersion()I
    .locals 0

    const p0, 0x1000d7

    return p0
.end method

.method public final getPhoneDataConnectionCount(II)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getPhoneDataConnectionTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPhoneDataConnectionTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getPhoneEnergyConsumptionUC()J
    .locals 2

    const/16 v0, 0x9

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getPhoneOnCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getPhoneOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPhoneSignalScanningTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPhoneSignalScanningTimer()Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    return-object p0
.end method

.method public final getPhoneSignalStrengthCount(II)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getPhoneSignalStrengthTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPhoneSignalStrengthTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getPowerBucketConsumptionUC(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez p0, :cond_0

    const-wide/16 p0, -0x1

    return-wide p0

    :cond_0
    invoke-virtual {p0, p1}, Lcom/android/internal/power/EnergyConsumerStats;->getAccumulatedStandardBucketCharge(I)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPowerSaveModeEnabledCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getPowerSaveModeEnabledTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getPowerStatsCollector(I)Lcom/android/server/power/stats/PowerStatsCollector;
    .locals 1

    if-eqz p1, :cond_4

    const/4 v0, 0x1

    if-eq p1, v0, :cond_3

    const/4 v0, 0x2

    if-eq p1, v0, :cond_2

    const/4 v0, 0x3

    if-eq p1, v0, :cond_1

    const/16 v0, 0x8

    if-eq p1, v0, :cond_0

    packed-switch p1, :pswitch_data_0

    const/4 p0, 0x0

    return-object p0

    :pswitch_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    return-object p0

    :pswitch_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    return-object p0

    :pswitch_2
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    return-object p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    return-object p0

    :cond_1
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    return-object p0

    :cond_2
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    return-object p0

    :cond_3
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    return-object p0

    :cond_4
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    return-object p0

    :pswitch_data_0
    .packed-switch 0xa
        :pswitch_2
        :pswitch_1
        :pswitch_0
    .end packed-switch
.end method

.method public final getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;
    .locals 4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v0, v0, p1

    if-nez v0, :cond_1

    const/4 v0, 0x2

    if-ne p1, v0, :cond_0

    const/4 v0, 0x5

    goto :goto_0

    :cond_0
    const/4 v0, 0x1

    :goto_0
    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;-><init>(ILcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aput-object v1, p0, p1

    return-object v1

    :cond_1
    return-object v0
.end method

.method public final getRpmStats()Ljava/util/Map;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    return-object p0
.end method

.method public final getRpmTimerLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;
    .locals 3

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v0, p1}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v0, :cond_0

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {p0, p1, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_0
    return-object v0
.end method

.method public final getScreenAutoBrightnessTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenBrightnessTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenBrightnessTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getScreenDischargeAmount(IIIZ)I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v0, :cond_0

    if-eqz p4, :cond_0

    if-ge p3, p2, :cond_0

    sub-int/2addr p2, p3

    add-int/2addr p1, p2

    :cond_0
    monitor-exit p0

    return p1

    :catchall_0
    move-exception p1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw p1
.end method

.method public final getScreenDozeCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getScreenDozeEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x1

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getScreenDozeTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenHighBrightnessTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenOffKernelCpuSpeedTimes()[[J
    .locals 5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    const/4 v1, 0x0

    if-nez v0, :cond_0

    const/4 p0, 0x2

    new-array p0, p0, [I

    const/4 v0, 0x1

    aput v1, p0, v0

    aput v1, p0, v1

    sget-object v0, Ljava/lang/Long;->TYPE:Ljava/lang/Class;

    invoke-static {v0, p0}, Ljava/lang/reflect/Array;->newInstance(Ljava/lang/Class;[I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, [[J

    return-object p0

    :cond_0
    array-length v0, v0

    new-array v0, v0, [[J

    move v2, v1

    :goto_0
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    array-length v4, v3

    if-ge v2, v4, :cond_3

    aget-object v3, v3, v2

    if-nez v3, :cond_1

    new-array v3, v1, [J

    aput-object v3, v0, v2

    goto :goto_1

    :cond_1
    invoke-virtual {v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getSize()I

    move-result v3

    new-array v3, v3, [J

    aput-object v3, v0, v2

    array-length v3, v3

    if-lez v3, :cond_2

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v3, v3, v2

    invoke-virtual {v3, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getCountsLocked(I)[J

    move-result-object v3

    aput-object v3, v0, v2

    :cond_2
    :goto_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_3
    return-object v0
.end method

.method public final getScreenOffRpmStats()Ljava/util/Map;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    return-object p0
.end method

.method public final getScreenOnCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getScreenOnEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x0

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getScreenOnGpsRunningTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getScreenWakeStats()Ljava/util/Map;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    return-object p0
.end method

.method public final getSilentLogOnScreenOffTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSilentLogOnScreenOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSilentScreenDischargeAmount(IIIZ)I
    .locals 1

    monitor-enter p0

    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v0, :cond_0

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v0, :cond_0

    if-eqz p4, :cond_0

    if-ge p3, p2, :cond_0

    sub-int/2addr p2, p3

    add-int/2addr p1, p2

    goto :goto_0

    :catchall_0
    move-exception p1

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return p1

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw p1
.end method

.method public final getSpeakerCallTime(II)J
    .locals 0

    if-ltz p1, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length p2, p0

    if-ge p1, p2, :cond_0

    aget-object p0, p0, p1

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0

    :cond_0
    const-wide/16 p0, 0x0

    return-wide p0
.end method

.method public final getSpeakerMediaTime(II)J
    .locals 0

    if-ltz p1, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length p2, p0

    if-ge p1, p2, :cond_0

    aget-object p0, p0, p1

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0

    :cond_0
    const-wide/16 p0, 0x0

    return-wide p0
.end method

.method public final getStartClockTime()J
    .locals 8

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v6

    const-wide v0, 0x757b12c00L

    cmp-long v2, v6, v0

    if-lez v2, :cond_0

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    sub-long v0, v6, v0

    cmp-long v0, v2, v0

    if-ltz v0, :cond_1

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    cmp-long v0, v0, v6

    if-lez v0, :cond_2

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    invoke-virtual/range {v1 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordCurrentTimeChange(JJJ)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    const-wide/16 v4, 0x3e8

    div-long/2addr v2, v4

    sub-long/2addr v0, v2

    sub-long/2addr v6, v0

    iput-wide v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    :cond_2
    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    monitor-exit p0

    return-wide v0

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final getStartCount()I
    .locals 0

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    return p0
.end method

.method public final getStartPlatformVersion()Ljava/lang/String;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartPlatformVersion:Ljava/lang/String;

    return-object p0
.end method

.method public final getStatsStartRealtime()J
    .locals 2

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    return-wide v0
.end method

.method public final getSubScreenAutoBrightnessTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSubScreenBrightnessTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSubScreenBrightnessTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getSubScreenDozeCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getSubScreenDozeTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSubScreenHighBrightnessTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSubScreenOnCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getSubScreenOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getSystemServiceCpuThreadTimes()Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;
    .locals 8

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemServerCpuThreadReader:Lcom/android/server/power/stats/SystemServerCpuThreadReader;

    iget-object v0, p0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mKernelCpuThreadReader:Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;->getCpuFrequencyCount()I

    move-result v0

    iget-object p0, p0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mKernelCpuThreadReader:Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;

    invoke-virtual {p0}, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;->getProcessCpuUsage()Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;

    move-result-object p0

    if-nez p0, :cond_0

    const/4 p0, 0x0

    return-object p0

    :cond_0
    new-instance v1, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;

    invoke-direct {v1}, Ljava/lang/Object;-><init>()V

    new-array v2, v0, [J

    iput-object v2, v1, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->threadCpuTimesUs:[J

    new-array v2, v0, [J

    iput-object v2, v1, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->binderThreadCpuTimesUs:[J

    const/4 v2, 0x0

    :goto_0
    if-ge v2, v0, :cond_1

    iget-object v3, v1, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->threadCpuTimesUs:[J

    iget-object v4, p0, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;->threadCpuTimesMillis:[J

    aget-wide v4, v4, v2

    const-wide/16 v6, 0x3e8

    mul-long/2addr v4, v6

    aput-wide v4, v3, v2

    iget-object v3, v1, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->binderThreadCpuTimesUs:[J

    iget-object v4, p0, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;->selectedThreadCpuTimesMillis:[J

    aget-wide v4, v4, v2

    mul-long/2addr v4, v6

    aput-wide v4, v3, v2

    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_1
    return-object v1
.end method

.method public final getSystemServiceTimeAtCpuSpeeds()[J
    .locals 1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBinderThreadCpuTimesUs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-nez p0, :cond_0

    const/4 p0, 0x0

    return-object p0

    :cond_0
    const/4 v0, 0x0

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getCountsLocked(I)[J

    move-result-object p0

    return-object p0
.end method

.method public final getTxPowerSharingTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getTxSharingDischargeAmount()J
    .locals 2

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    return-wide v0
.end method

.method public final getUahDischarge(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getUahDischargeDeepDoze(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getUahDischargeLightDoze(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getUahDischargeScreenDoze(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getUahDischargeScreenOff(I)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-wide p0
.end method

.method public final getUidStats()Landroid/util/SparseArray;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    return-object p0
.end method

.method public final getUidStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;
    .locals 7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v3

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v5

    move-object v1, p0

    move v2, p1

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    return-object p0
.end method

.method public final getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;
    .locals 9

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-nez v0, :cond_1

    invoke-static {p1}, Landroid/os/Process;->isSdkSandboxUid(I)Z

    move-result v0

    if-eqz v0, :cond_0

    const-string v0, "BatteryStatsImpl"

    const-string/jumbo v1, "Tracking an SDK Sandbox UID"

    invoke-static {v0, v1}, Landroid/util/Log;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    :cond_0
    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-object v3, p0

    move v4, p1

    move-wide v5, p2

    move-wide v7, p4

    invoke-direct/range {v2 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;IJJ)V

    iget-object p0, v3, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p0, v4, v2}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    return-object v2

    :cond_1
    return-object v0
.end method

.method public final getWakeLockStats()Landroid/os/WakeLockStats;
    .locals 17

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v1

    new-instance v3, Ljava/util/ArrayList;

    invoke-direct {v3}, Ljava/util/ArrayList;-><init>()V

    new-instance v4, Ljava/util/ArrayList;

    invoke-direct {v4}, Ljava/util/ArrayList;-><init>()V

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    add-int/lit8 v5, v5, -0x1

    :goto_0
    if-ltz v5, :cond_7

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v7, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWakelockStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    iget-object v7, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->mMap:Landroid/util/ArrayMap;

    invoke-virtual {v7}, Landroid/util/ArrayMap;->size()I

    move-result v8

    add-int/lit8 v8, v8, -0x1

    :goto_1
    const/4 v9, 0x0

    if-ltz v8, :cond_3

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v10

    move-object v13, v10

    check-cast v13, Ljava/lang/String;

    invoke-virtual {v7, v8}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;

    iget-object v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerPartial:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v10, :cond_0

    goto :goto_2

    :cond_0
    invoke-static {v10, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->createWakeLockData(Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;J)Landroid/os/WakeLockStats$WakeLockData;

    move-result-object v15

    iget-object v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->mSubTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;

    invoke-static {v10, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->createWakeLockData(Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;J)Landroid/os/WakeLockStats$WakeLockData;

    move-result-object v10

    invoke-static {v15, v10}, Landroid/os/WakeLockStats$WakeLock;->isDataValid(Landroid/os/WakeLockStats$WakeLockData;Landroid/os/WakeLockStats$WakeLockData;)Z

    move-result v11

    if-eqz v11, :cond_1

    new-instance v11, Landroid/os/WakeLockStats$WakeLock;

    iget v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    const/4 v14, 0x0

    move-object/from16 v16, v10

    invoke-direct/range {v11 .. v16}, Landroid/os/WakeLockStats$WakeLock;-><init>(ILjava/lang/String;ZLandroid/os/WakeLockStats$WakeLockData;Landroid/os/WakeLockStats$WakeLockData;)V

    move-object v9, v11

    :cond_1
    :goto_2
    if-eqz v9, :cond_2

    invoke-virtual {v3, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_2
    add-int/lit8 v8, v8, -0x1

    goto :goto_1

    :cond_3
    iget-object v7, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v7, :cond_4

    goto :goto_3

    :cond_4
    invoke-static {v7, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->createWakeLockData(Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;J)Landroid/os/WakeLockStats$WakeLockData;

    move-result-object v14

    iget-object v7, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->mSubTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;

    invoke-static {v7, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->createWakeLockData(Lcom/android/server/power/stats/BatteryStatsImpl$DurationTimer;J)Landroid/os/WakeLockStats$WakeLockData;

    move-result-object v15

    invoke-static {v14, v15}, Landroid/os/WakeLockStats$WakeLock;->isDataValid(Landroid/os/WakeLockStats$WakeLockData;Landroid/os/WakeLockStats$WakeLockData;)Z

    move-result v7

    if-eqz v7, :cond_5

    new-instance v10, Landroid/os/WakeLockStats$WakeLock;

    iget v11, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    const-string/jumbo v12, "wakelockstats_aggregated"

    const/4 v13, 0x1

    invoke-direct/range {v10 .. v15}, Landroid/os/WakeLockStats$WakeLock;-><init>(ILjava/lang/String;ZLandroid/os/WakeLockStats$WakeLockData;Landroid/os/WakeLockStats$WakeLockData;)V

    move-object v9, v10

    :cond_5
    :goto_3
    if-eqz v9, :cond_6

    invoke-virtual {v4, v9}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_6
    add-int/lit8 v5, v5, -0x1

    goto :goto_0

    :cond_7
    new-instance v0, Landroid/os/WakeLockStats;

    invoke-direct {v0, v3, v4}, Landroid/os/WakeLockStats;-><init>(Ljava/util/List;Ljava/util/List;)V

    return-object v0
.end method

.method public final getWakeupReasonStats()Ljava/util/Map;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    return-object p0
.end method

.method public final getWifiActiveTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiBatteryStats()Landroid/os/connectivity/WifiBatteryStats;
    .locals 40

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v1

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getIdleTimeCounter()Landroid/os/BatteryStats$LongCounter;

    move-result-object v6

    const/4 v7, 0x0

    invoke-virtual {v6, v7}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v25

    iget-object v6, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mScanTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v6, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getRxTimeCounter()Landroid/os/BatteryStats$LongCounter;

    move-result-object v6

    invoke-virtual {v6, v7}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v27

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->getTxTimeCounters()[Landroid/os/BatteryStats$LongCounter;

    move-result-object v6

    aget-object v6, v6, v7

    invoke-virtual {v6, v7}, Landroid/os/BatteryStats$LongCounter;->getCountLocked(I)J

    move-result-wide v29

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v6}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v10

    mul-long/2addr v10, v3

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v6, v10, v11}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide v10

    div-long/2addr v10, v3

    add-long v12, v25, v27

    add-long v12, v12, v29

    sub-long/2addr v10, v12

    const-wide/16 v12, 0x0

    invoke-static {v12, v13, v10, v11}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v21

    iget-object v6, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mMonitoredRailChargeConsumedMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    move-wide/from16 v33, v12

    move v12, v7

    :goto_0
    iget-object v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v13}, Landroid/util/SparseArray;->size()I

    move-result v13

    if-ge v12, v13, :cond_0

    iget-object v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v13, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mCount:I

    int-to-long v13, v13

    add-long v33, v33, v13

    add-int/lit8 v12, v12, 0x1

    goto :goto_0

    :cond_0
    const/16 v12, 0x8

    new-array v13, v12, [J

    move v14, v7

    :goto_1
    if-ge v14, v12, :cond_1

    invoke-virtual {v0, v14, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getWifiStateTime(IJI)J

    move-result-wide v15

    div-long/2addr v15, v3

    aput-wide v15, v13, v14

    add-int/lit8 v14, v14, 0x1

    goto :goto_1

    :cond_1
    const/16 v12, 0xd

    new-array v14, v12, [J

    move v15, v7

    :goto_2
    if-ge v15, v12, :cond_2

    invoke-virtual {v0, v15, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getWifiSupplStateTime(IJI)J

    move-result-wide v16

    div-long v16, v16, v3

    aput-wide v16, v14, v15

    add-int/lit8 v15, v15, 0x1

    goto :goto_2

    :cond_2
    const/4 v12, 0x5

    new-array v15, v12, [J

    move-wide/from16 v16, v3

    move v3, v7

    :goto_3
    if-ge v3, v12, :cond_3

    invoke-virtual {v0, v3, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getWifiSignalStrengthTime(IJI)J

    move-result-wide v18

    div-long v18, v18, v16

    aput-wide v18, v15, v3

    add-int/lit8 v3, v3, 0x1

    goto :goto_3

    :cond_3
    new-instance v3, Landroid/os/connectivity/WifiBatteryStats;

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v4, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->computeRealtime(J)J

    move-result-wide v18

    div-long v18, v18, v16

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide v1

    div-long v1, v1, v16

    const/4 v4, 0x3

    move-object/from16 v35, v13

    move-object/from16 v37, v14

    invoke-virtual {v0, v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityPackets(II)J

    move-result-wide v13

    invoke-virtual {v0, v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityBytes(II)J

    move-result-wide v16

    const/4 v4, 0x2

    move-wide/from16 v23, v8

    move-wide/from16 v31, v10

    move-object/from16 v36, v15

    move-wide/from16 v15, v16

    move-wide/from16 v9, v18

    invoke-virtual {v0, v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityPackets(II)J

    move-result-wide v17

    invoke-virtual {v0, v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->getNetworkActivityBytes(II)J

    move-result-wide v19

    move-wide v11, v1

    move-object v8, v3

    move-wide/from16 v38, v5

    invoke-direct/range {v8 .. v39}, Landroid/os/connectivity/WifiBatteryStats;-><init>(JJJJJJJJJJJJJ[J[J[JJ)V

    return-object v8
.end method

.method public final getWifiControllerActivity()Landroid/os/BatteryStats$ControllerActivityCounter;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    return-object p0
.end method

.method public final getWifiEnergyConsumptionUC()J
    .locals 2

    const/4 v0, 0x4

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerBucketConsumptionUC(I)J

    move-result-wide v0

    return-wide v0
.end method

.method public final getWifiMulticastWakelockCount(I)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getWifiMulticastWakelockTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiOnTime(JI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p0, p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiSignalStrengthCount(II)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getWifiSignalStrengthTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiSignalStrengthTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getWifiStateCount(II)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getWifiStateTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiStateTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final getWifiSupplStateCount(II)I
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->computeCurrentCountLocked()I

    move-result p0

    return p0
.end method

.method public final getWifiSupplStateTime(IJI)J
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTotalTimeLocked(JI)J

    move-result-wide p0

    return-wide p0
.end method

.method public final getWifiSupplStateTimer(I)Landroid/os/BatteryStats$Timer;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    return-object p0
.end method

.method public final hasBluetoothActivityReporting()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasBluetoothReporting:Z

    return p0
.end method

.method public final hasModemActivityReporting()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasModemReporting:Z

    return p0
.end method

.method public final hasSpeakerOutPowerReporting()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasSpeakerOutReporting:Z

    return p0
.end method

.method public final hasWifiActivityReporting()Z
    .locals 0

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    return p0
.end method

.method public final incrementPerRatDataLocked(Landroid/telephony/ModemActivityInfo;J)Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;
    .locals 39

    move-object/from16 v0, p0

    move-object/from16 v1, p1

    move-wide/from16 v2, p2

    invoke-virtual {v1}, Landroid/telephony/ModemActivityInfo;->getSpecificInfoLength()I

    move-result v4

    const/4 v5, 0x1

    const/4 v6, 0x3

    const/4 v7, 0x0

    if-ne v4, v5, :cond_d

    invoke-virtual {v1, v7}, Landroid/telephony/ModemActivityInfo;->getSpecificInfoRat(I)I

    move-result v12

    if-nez v12, :cond_d

    invoke-virtual {v1, v7}, Landroid/telephony/ModemActivityInfo;->getSpecificInfoFrequencyRange(I)I

    move-result v12

    if-nez v12, :cond_d

    sget v4, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    new-array v12, v4, [J

    move v13, v7

    const-wide/16 v14, 0x0

    :goto_0
    const-wide/16 v16, 0x3e8

    if-ge v13, v6, :cond_3

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v7, v7, v13

    if-nez v7, :cond_1

    :cond_0
    const-wide/16 v20, 0x0

    goto :goto_3

    :cond_1
    iget-object v7, v7, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v8, v7

    const/4 v9, 0x0

    :goto_1
    if-ge v9, v8, :cond_0

    const/4 v10, 0x0

    const-wide/16 v20, 0x0

    :goto_2
    if-ge v10, v4, :cond_2

    aget-object v11, v7, v9

    aget-object v11, v11, v10

    mul-long v5, v2, v16

    invoke-virtual {v11, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    div-long v5, v5, v16

    aget-wide v23, v12, v10

    add-long v23, v23, v5

    aput-wide v23, v12, v10

    add-long/2addr v14, v5

    add-int/lit8 v10, v10, 0x1

    const/4 v5, 0x1

    const/4 v6, 0x3

    goto :goto_2

    :cond_2
    add-int/lit8 v9, v9, 0x1

    const/4 v5, 0x1

    const/4 v6, 0x3

    goto :goto_1

    :goto_3
    add-int/lit8 v13, v13, 0x1

    const/4 v5, 0x1

    const/4 v6, 0x3

    const/4 v7, 0x0

    goto :goto_0

    :cond_3
    const-wide/16 v20, 0x0

    cmp-long v5, v14, v20

    move-wide/from16 v10, v20

    if-eqz v5, :cond_b

    move-wide/from16 v23, v10

    const/4 v6, 0x0

    const-wide/16 v8, 0x0

    const-wide/16 v18, 0x0

    :goto_4
    const/4 v5, 0x3

    if-ge v6, v5, :cond_a

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v5, v5, v6

    if-nez v5, :cond_4

    move/from16 v32, v4

    move v4, v6

    goto/16 :goto_a

    :cond_4
    iget-object v7, v5, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v13, v7

    move/from16 v25, v6

    const/4 v6, 0x0

    :goto_5
    if-ge v6, v13, :cond_9

    move-object/from16 v31, v7

    move-wide/from16 v29, v23

    const/4 v7, 0x0

    move-wide/from16 v23, v20

    :goto_6
    const-wide/16 v26, 0x2

    if-ge v7, v4, :cond_7

    aget-object v28, v31, v6

    move/from16 v32, v4

    aget-object v4, v28, v7

    move-wide/from16 v33, v8

    mul-long v8, v2, v16

    invoke-virtual {v4, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v8

    div-long v8, v8, v16

    aget-wide v35, v12, v7

    cmp-long v4, v35, v20

    if-nez v4, :cond_5

    move v8, v6

    move/from16 v26, v7

    move-wide/from16 v35, v10

    move/from16 v4, v25

    goto :goto_8

    :cond_5
    invoke-virtual {v1, v7}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v37

    mul-long v37, v37, v8

    div-long v26, v35, v26

    add-long v26, v26, v37

    move-wide/from16 v37, v8

    div-long v8, v26, v35

    move-wide/from16 v35, v10

    const/4 v4, 0x1

    invoke-virtual {v5, v6, v7, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getTxDurationCounter(IIZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v10

    invoke-virtual {v10, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    add-long v10, v23, v37

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v4

    if-eqz v4, :cond_6

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    move-object/from16 v23, v4

    move/from16 v26, v7

    move-wide/from16 v27, v8

    move/from16 v24, v25

    move/from16 v25, v6

    invoke-virtual/range {v23 .. v28}, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->calcTxStatePowerMah(IIIJ)D

    move-result-wide v6

    move/from16 v4, v24

    move/from16 v8, v25

    add-double v18, v18, v6

    add-long v29, v29, v27

    :goto_7
    move-wide/from16 v23, v10

    goto :goto_8

    :cond_6
    move v8, v6

    move/from16 v26, v7

    move/from16 v4, v25

    goto :goto_7

    :goto_8
    add-int/lit8 v7, v26, 0x1

    move/from16 v25, v4

    move v6, v8

    move/from16 v4, v32

    move-wide/from16 v8, v33

    move-wide/from16 v10, v35

    goto :goto_6

    :cond_7
    move/from16 v32, v4

    move-wide/from16 v33, v8

    move-wide/from16 v35, v10

    move/from16 v4, v25

    move v8, v6

    invoke-virtual {v1}, Landroid/telephony/ModemActivityInfo;->getReceiveTimeMillis()J

    move-result-wide v6

    mul-long v6, v6, v23

    div-long v9, v14, v26

    add-long/2addr v9, v6

    div-long/2addr v9, v14

    const/4 v6, 0x1

    invoke-virtual {v5, v8, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getRxDurationCounter(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v7

    invoke-virtual {v7, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v6

    if-eqz v6, :cond_8

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    invoke-virtual {v6, v4, v8, v9, v10}, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->calcRxStatePowerMah(IIJ)D

    move-result-wide v6

    add-double v6, v6, v33

    add-long v10, v35, v9

    move-wide/from16 v33, v6

    goto :goto_9

    :cond_8
    move-wide/from16 v10, v35

    :goto_9
    add-int/lit8 v6, v8, 0x1

    move/from16 v25, v4

    move-wide/from16 v23, v29

    move-object/from16 v7, v31

    move/from16 v4, v32

    move-wide/from16 v8, v33

    goto/16 :goto_5

    :cond_9
    move/from16 v32, v4

    move-wide/from16 v33, v8

    move-wide/from16 v35, v10

    move/from16 v4, v25

    :goto_a
    add-int/lit8 v6, v4, 0x1

    move/from16 v4, v32

    goto/16 :goto_4

    :cond_a
    move-wide/from16 v20, v23

    goto :goto_b

    :cond_b
    const-wide/16 v8, 0x0

    const-wide/16 v18, 0x0

    :cond_c
    :goto_b
    move-wide/from16 v25, v8

    move-wide/from16 v27, v10

    move-wide/from16 v29, v18

    move-wide/from16 v31, v20

    goto/16 :goto_e

    :cond_d
    const-wide/16 v20, 0x0

    move-wide/from16 v10, v20

    const/4 v5, 0x0

    const-wide/16 v8, 0x0

    const-wide/16 v18, 0x0

    :goto_c
    if-ge v5, v4, :cond_c

    invoke-virtual {v1, v5}, Landroid/telephony/ModemActivityInfo;->getSpecificInfoRat(I)I

    move-result v6

    invoke-virtual {v1, v5}, Landroid/telephony/ModemActivityInfo;->getSpecificInfoFrequencyRange(I)I

    move-result v14

    invoke-static {v6}, Lcom/android/server/power/stats/format/MobileRadioPowerStatsLayout;->mapRadioAccessNetworkTypeToRadioAccessTechnology(I)I

    move-result v13

    invoke-virtual {v0, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v7

    move/from16 v23, v4

    move/from16 v24, v5

    invoke-virtual {v1, v6, v14}, Landroid/telephony/ModemActivityInfo;->getReceiveTimeMillis(II)J

    move-result-wide v4

    invoke-virtual {v1, v6, v14}, Landroid/telephony/ModemActivityInfo;->getTransmitTimeMillis(II)[I

    move-result-object v6

    const/4 v12, 0x1

    invoke-virtual {v7, v14, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getRxDurationCounter(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v15

    invoke-virtual {v15, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v12

    if-eqz v12, :cond_e

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    invoke-virtual {v12, v13, v14, v4, v5}, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->calcRxStatePowerMah(IIJ)D

    move-result-wide v15

    add-double/2addr v15, v8

    add-long/2addr v10, v4

    move-wide v8, v15

    :cond_e
    array-length v4, v6

    const/4 v15, 0x0

    :goto_d
    if-ge v15, v4, :cond_10

    aget v5, v6, v15

    move/from16 v25, v4

    int-to-long v4, v5

    const/4 v12, 0x1

    invoke-virtual {v7, v14, v15, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getTxDurationCounter(IIZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v1

    invoke-virtual {v1, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v1

    move/from16 v22, v12

    if-eqz v1, :cond_f

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    move-wide/from16 v16, v4

    invoke-virtual/range {v12 .. v17}, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->calcTxStatePowerMah(IIIJ)D

    move-result-wide v4

    add-double v18, v18, v4

    add-long v20, v20, v16

    :cond_f
    add-int/lit8 v15, v15, 0x1

    move-object/from16 v1, p1

    move/from16 v4, v25

    goto :goto_d

    :cond_10
    const/16 v22, 0x1

    add-int/lit8 v5, v24, 0x1

    move-object/from16 v1, p1

    move/from16 v4, v23

    goto :goto_c

    :goto_e
    const/4 v1, 0x0

    const/4 v5, 0x3

    :goto_f
    if-ge v1, v5, :cond_14

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v4, v4, v1

    if-nez v4, :cond_11

    goto :goto_12

    :cond_11
    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v6, v4

    const/4 v7, 0x0

    :goto_10
    if-ge v7, v6, :cond_13

    const/4 v8, 0x0

    :goto_11
    const/4 v9, 0x5

    if-ge v8, v9, :cond_12

    aget-object v9, v4, v7

    aget-object v9, v9, v8

    invoke-virtual {v9, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_11

    :cond_12
    add-int/lit8 v7, v7, 0x1

    goto :goto_10

    :cond_13
    :goto_12
    add-int/lit8 v1, v1, 0x1

    goto :goto_f

    :cond_14
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v0

    if-eqz v0, :cond_15

    new-instance v24, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;

    invoke-direct/range {v24 .. v32}, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;-><init>(DJDJ)V

    return-object v24

    :cond_15
    const/4 v0, 0x0

    return-object v0
.end method

.method public final initActiveHistoryEventsLocked(JJ)V
    .locals 13

    const/4 v0, 0x0

    move v6, v0

    :goto_0
    const/16 v1, 0x17

    if-ge v6, v1, :cond_4

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    if-nez v1, :cond_0

    const/4 v1, 0x1

    if-ne v6, v1, :cond_0

    goto :goto_2

    :cond_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {v1, v6}, Landroid/os/BatteryStats$HistoryEventTracker;->getStateForEvent(I)Ljava/util/HashMap;

    move-result-object v1

    if-nez v1, :cond_1

    goto :goto_2

    :cond_1
    invoke-virtual {v1}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v9

    :cond_2
    invoke-interface {v9}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_3

    invoke-interface {v9}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    move-object v10, v1

    check-cast v10, Ljava/util/Map$Entry;

    invoke-interface {v10}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v1

    move-object v11, v1

    check-cast v11, Landroid/util/SparseIntArray;

    move v12, v0

    :goto_1
    invoke-virtual {v11}, Landroid/util/SparseIntArray;->size()I

    move-result v1

    if-ge v12, v1, :cond_2

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-interface {v10}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v2

    move-object v7, v2

    check-cast v7, Ljava/lang/String;

    invoke-virtual {v11, v12}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v8

    move-wide v2, p1

    move-wide/from16 v4, p3

    invoke-virtual/range {v1 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    add-int/lit8 v12, v12, 0x1

    goto :goto_1

    :cond_3
    :goto_2
    add-int/lit8 v6, v6, 0x1

    goto :goto_0

    :cond_4
    return-void
.end method

.method public final initDischarge()V
    .locals 3

    const/4 v0, 0x0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLowDischargeAmountSinceCharge:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHighDischargeAmountSinceCharge:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceCharge:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceCharge:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceCharge:I

    const/4 v1, -0x1

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryRaw:I

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryCC:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargeCoulombCounter:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargeCoulombCounter:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSubScreenOnUnplugLevelPermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSubScreenDozeUnplugLevelPermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenOnSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenDozeSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const-wide/16 v1, 0x0

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    return-void
.end method

.method public final initEnergyConsumerStatsLocked([Z[Ljava/lang/String;)V
    .locals 8

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v1, v1

    const/4 v2, 0x0

    move v3, v2

    :goto_0
    if-ge v3, v1, :cond_0

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v4, v4, v3

    iget v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    iput v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenStateAtLastEnergyMeasurement:I

    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    :cond_0
    if-eqz p1, :cond_6

    new-instance v6, Lcom/android/internal/power/EnergyConsumerStats$Config;

    sget-object v1, Lcom/android/server/power/stats/BatteryStatsImpl;->SUPPORTED_PER_PROCESS_STATE_STANDARD_ENERGY_BUCKETS:[I

    const/4 v7, 0x5

    new-array v3, v7, [Ljava/lang/String;

    :goto_1
    if-ge v2, v7, :cond_1

    invoke-static {v2}, Landroid/os/BatteryConsumer;->processStateToString(I)Ljava/lang/String;

    move-result-object v4

    aput-object v4, v3, v2

    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    :cond_1
    invoke-direct {v6, p1, p2, v1, v3}, Lcom/android/internal/power/EnergyConsumerStats$Config;-><init>([Z[Ljava/lang/String;[I[Ljava/lang/String;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    if-eqz v1, :cond_2

    invoke-virtual {v1, v6}, Lcom/android/internal/power/EnergyConsumerStats$Config;->isCompatible(Lcom/android/internal/power/EnergyConsumerStats$Config;)Z

    move-result v1

    if-nez v1, :cond_2

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->saveBatteryUsageStatsOnReset()V

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v4

    const/4 v1, 0x4

    move-object v0, p0

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    :cond_2
    iput-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    new-instance v1, Lcom/android/internal/power/EnergyConsumerStats;

    invoke-direct {v1, v6}, Lcom/android/internal/power/EnergyConsumerStats;-><init>(Lcom/android/internal/power/EnergyConsumerStats$Config;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    aget-boolean v1, p1, v7

    if-eqz v1, :cond_3

    new-instance v1, Lcom/android/server/power/stats/BluetoothPowerCalculator;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BluetoothPowerCalculator;-><init>(Lcom/android/internal/os/PowerProfile;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    :cond_3
    const/4 v1, 0x7

    aget-boolean v1, p1, v1

    if-eqz v1, :cond_4

    new-instance v1, Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/MobileRadioPowerCalculator;-><init>(Lcom/android/internal/os/PowerProfile;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    :cond_4
    const/4 v1, 0x4

    aget-boolean v1, p1, v1

    if-eqz v1, :cond_5

    new-instance v1, Lcom/android/server/power/stats/WifiPowerCalculator;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/WifiPowerCalculator;-><init>(Lcom/android/internal/os/PowerProfile;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    :cond_5
    return-void

    :cond_6
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    if-eqz v1, :cond_7

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->saveBatteryUsageStatsOnReset()V

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v2

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v4

    const/4 v1, 0x4

    move-object v0, p0

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    :cond_7
    const/4 v1, 0x0

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    return-void
.end method

.method public initTimersAndCounters()V
    .locals 15

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v2, 0x0

    const/4 v5, 0x0

    const/4 v3, 0x0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v4, 0x0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 v0, 0x0

    move v1, v0

    :goto_0
    const/4 v2, 0x5

    if-ge v1, v2, :cond_0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v3, v2, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_0
    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_1
    if-ge v1, v2, :cond_1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    :cond_1
    move v1, v0

    :goto_2
    if-ge v1, v2, :cond_2

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    :cond_2
    move v1, v0

    :goto_3
    if-ge v1, v2, :cond_3

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_3

    :cond_3
    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_4
    const/4 v3, 0x4

    if-ge v1, v3, :cond_4

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_4

    :cond_4
    move v1, v0

    :goto_5
    if-ge v1, v3, :cond_5

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v7, 0x0

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v5, v4, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_5

    :cond_5
    move v1, v0

    :goto_6
    const/16 v3, 0x10

    if-ge v1, v3, :cond_6

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v4, v3, v1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_6

    :cond_6
    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const-wide/16 v3, 0x0

    iput-wide v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v7, 0x0

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v6, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v11, 0x0

    const/4 v9, 0x0

    invoke-direct/range {v6 .. v11}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v7, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v12, 0x0

    const/4 v10, 0x0

    invoke-direct/range {v7 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v13, 0x0

    const/4 v11, 0x0

    invoke-direct/range {v8 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v9, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v14, 0x0

    const/4 v12, 0x0

    invoke-direct/range {v9 .. v14}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v6, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v11, 0x0

    const/4 v9, 0x0

    invoke-direct/range {v6 .. v11}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v7, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v12, 0x0

    const/4 v10, 0x0

    invoke-direct/range {v7 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v13, 0x0

    const/4 v11, 0x0

    invoke-direct/range {v8 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v9, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v12, 0x0

    invoke-direct/range {v9 .. v14}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_7
    sget v3, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    if-ge v1, v3, :cond_7

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_7

    :cond_7
    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_8
    sget v3, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    if-ge v1, v3, :cond_8

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_8

    :cond_8
    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_9
    const/16 v3, 0xa

    if-ge v1, v3, :cond_9

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v4, v3, v1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_9

    :cond_9
    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x1

    invoke-direct {v1, v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;-><init>(ILcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;-><init>(ILcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    sget v5, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    invoke-direct {v1, v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;-><init>(ILcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v6, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v11, 0x0

    const/4 v9, 0x0

    invoke-direct/range {v6 .. v11}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_a
    const/16 v3, 0x8

    if-ge v1, v3, :cond_a

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_a

    :cond_a
    move v1, v0

    :goto_b
    const/16 v3, 0xd

    if-ge v1, v3, :cond_b

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_b

    :cond_b
    move v1, v0

    :goto_c
    if-ge v1, v2, :cond_c

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v3, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_c

    :cond_c
    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v5, 0x0

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v1, v0

    :goto_d
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v3, v2

    if-ge v1, v3, :cond_d

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    aput-object v4, v2, v1

    add-int/lit8 v1, v1, 0x1

    goto :goto_d

    :cond_d
    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v4, 0x0

    const/4 v7, 0x0

    const/4 v5, 0x0

    invoke-direct/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAudioOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v8, 0x0

    const/4 v6, 0x0

    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mVideoOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v9, 0x0

    const/4 v7, 0x0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v6, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v11, 0x0

    const/4 v9, 0x0

    invoke-direct/range {v6 .. v11}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    const/4 v1, -0x1

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    return-void
.end method

.method public final initTimes(JJ)V
    .locals 2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v0, p1, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->init(JJ)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v0, p1, p2, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->init(JJ)V

    const-wide/16 v0, 0x0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeUs:J

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUptimeUs:J

    iput-wide p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUptimeStartUs:J

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    invoke-virtual {p1}, Lcom/android/internal/os/MonotonicClock;->monotonicTime()J

    move-result-wide p1

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicStartTime:J

    return-void
.end method

.method public final isMobileRadioEnergyConsumerSupportedLocked()Z
    .locals 1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez p0, :cond_0

    const/4 p0, 0x0

    return p0

    :cond_0
    const/4 v0, 0x7

    invoke-virtual {p0, v0}, Lcom/android/internal/power/EnergyConsumerStats;->isStandardBucketSupported(I)Z

    move-result p0

    return p0
.end method

.method public final isProcessStateDataAvailable()Z
    .locals 1

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->isFastCpuTimesReader()Z

    move-result v0

    monitor-exit p0

    return v0

    :catchall_0
    move-exception v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final iterateBatteryStatsHistory(JJ)Lcom/android/internal/os/BatteryStatsHistoryIterator;
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0, p1, p2, p3, p4}, Lcom/android/internal/os/BatteryStatsHistory;->iterate(JJ)Lcom/android/internal/os/BatteryStatsHistoryIterator;

    move-result-object p0

    return-object p0
.end method

.method public final mapUid(I)I
    .locals 1

    invoke-static {p1}, Landroid/os/Process;->isSdkSandboxUid(I)Z

    move-result v0

    if-eqz v0, :cond_0

    invoke-static {p1}, Landroid/os/Process;->getAppUidForSdkSandboxUid(I)I

    move-result p0

    return p0

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result p0

    return p0
.end method

.method public markPartialTimersAsEligible()V
    .locals 5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    invoke-static {v0, v1}, Lcom/android/internal/util/ArrayUtils;->referenceEquals(Ljava/util/ArrayList;Ljava/util/ArrayList;)Z

    move-result v0

    const/4 v1, 0x1

    if-eqz v0, :cond_0

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int/2addr v0, v1

    :goto_0
    if-ltz v0, :cond_2

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v2, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-boolean v1, v2, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mInList:Z

    add-int/lit8 v0, v0, -0x1

    goto :goto_0

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    sub-int/2addr v0, v1

    :goto_1
    const/4 v2, 0x0

    if-ltz v0, :cond_1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v3, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-boolean v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mInList:Z

    add-int/lit8 v0, v0, -0x1

    goto :goto_1

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    :goto_2
    if-ge v2, v0, :cond_2

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-boolean v1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mInList:Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v4, v3}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    :cond_2
    return-void
.end method

.method public maybeResetWhilePluggedInLocked()V
    .locals 8

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNoAutoReset:Z

    if-eqz v2, :cond_0

    goto :goto_0

    :cond_0
    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemReady:Z

    if-nez v2, :cond_1

    goto :goto_0

    :cond_1
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsHistory;->isResetEnabled()Z

    move-result v2

    if-nez v2, :cond_2

    goto :goto_0

    :cond_2
    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedInRealTimeMs:J

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->RESET_WHILE_PLUGGED_IN_MINIMUM_DURATION_HOURS:I

    int-to-long v4, v4

    const-wide/32 v6, 0x36ee80

    mul-long/2addr v4, v6

    add-long/2addr v2, v4

    cmp-long v2, v0, v2

    if-ltz v2, :cond_3

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    const-wide/16 v6, 0x3e8

    div-long/2addr v2, v6

    add-long/2addr v2, v4

    cmp-long v2, v0, v2

    if-ltz v2, :cond_3

    const-string/jumbo v2, "Resetting due to long plug in duration. elapsed time = "

    const-string v3, " ms, last plug in time = "

    invoke-static {v2, v0, v1, v3}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;JLjava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedInRealTimeMs:J

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v1, " ms, last reset time = "

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeStartUs:J

    div-long/2addr v1, v6

    invoke-virtual {v0, v1, v2}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "BatteryStatsImpl"

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    const/4 v0, 0x5

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->startNewSession(I)V

    :cond_3
    :goto_0
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleNextResetWhilePluggedInCheck()V

    return-void
.end method

.method public final maybeUpdateOverallScreenBrightness(IIJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    if-eq v0, p1, :cond_5

    if-ltz p1, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move v6, p1

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordScreenBrightnessEvent(JJI)V

    goto :goto_0

    :cond_0
    move v6, p1

    move-wide v2, p3

    :goto_0
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    const/4 p3, 0x2

    if-ne p1, p3, :cond_4

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    if-ltz p1, :cond_1

    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p3, p1

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p1, p1, p3

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p1, p1, p3

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p1, p1, p3

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_1
    if-ltz v6, :cond_4

    const/4 p1, 0x1

    if-ne p2, p1, :cond_2

    goto :goto_1

    :cond_2
    const/4 p1, 0x0

    :goto_1
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p2, p2, v6

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    if-eqz p1, :cond_3

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p2, p2, v6

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_3
    iget-boolean p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    if-eqz p2, :cond_4

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p2, p2, v6

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    if-eqz p1, :cond_4

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v6

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_4
    iput v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    :cond_5
    return-void
.end method

.method public networkStatsDelta(Landroid/net/NetworkStats;Landroid/net/NetworkStats;)Landroid/net/NetworkStats;
    .locals 0

    if-nez p2, :cond_0

    return-object p1

    :cond_0
    invoke-virtual {p1, p2}, Landroid/net/NetworkStats;->subtract(Landroid/net/NetworkStats;)Landroid/net/NetworkStats;

    move-result-object p0

    return-object p0
.end method

.method public final noteAlarmStartOrFinishLocked(ILjava/lang/String;Landroid/os/WorkSource;IJJ)V
    .locals 12

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    if-nez v1, :cond_0

    goto/16 :goto_2

    :cond_0
    const/4 v10, 0x0

    if-eqz p3, :cond_4

    move v11, v10

    :goto_0
    invoke-virtual {p3}, Landroid/os/WorkSource;->size()I

    move-result v1

    if-ge v11, v1, :cond_2

    invoke-virtual {p3, v11}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v8

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {v1, p1, p2, v8, v10}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result v1

    if-eqz v1, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move v6, p1

    move-object v7, p2

    move-wide/from16 v2, p5

    move-wide/from16 v4, p7

    invoke-virtual/range {v1 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    :cond_1
    add-int/lit8 v11, v11, 0x1

    goto :goto_0

    :cond_2
    invoke-virtual {p3}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object v9

    if-eqz v9, :cond_5

    move v11, v10

    :goto_1
    invoke-interface {v9}, Ljava/util/List;->size()I

    move-result v1

    if-ge v11, v1, :cond_5

    invoke-interface {v9, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v8

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {v1, p1, p2, v8, v10}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result v1

    if-eqz v1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move v6, p1

    move-object v7, p2

    move-wide/from16 v2, p5

    move-wide/from16 v4, p7

    invoke-virtual/range {v1 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    :cond_3
    add-int/lit8 v11, v11, 0x1

    goto :goto_1

    :cond_4
    move/from16 v1, p4

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {v2, p1, p2, v1, v10}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result v2

    if-eqz v2, :cond_5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move v5, p1

    move-object v6, p2

    move-wide/from16 v3, p7

    move v7, v1

    move-wide/from16 v1, p5

    invoke-virtual/range {v0 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    :cond_5
    :goto_2
    return-void
.end method

.method public final noteBinderThreadNativeIds([I)V
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemServerCpuThreadReader:Lcom/android/server/power/stats/SystemServerCpuThreadReader;

    iget-object p0, p0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mKernelCpuThreadReader:Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;

    invoke-virtual {p0, p1}, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;->setSelectedThreadIds([I)V

    return-void
.end method

.method public final noteBluetoothDutyScanStartedLocked(Landroid/os/WorkSource$WorkChain;IZIJJ)V
    .locals 6

    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result p2

    :cond_0
    move v1, p2

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    const/4 p2, 0x1

    if-nez p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p1, p2}, Lcom/android/internal/os/BatteryStatsHistory;->setBluetoothScanState(Z)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p1, p5, p6, p7, p8}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, p5, p6}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_1
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    add-int/2addr p1, p2

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    move-object v0, p0

    move-wide v2, p5

    move-wide v4, p7

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p4, v2, v3, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteBluetoothScanStartedLocked(IJZ)V

    return-void
.end method

.method public final noteBluetoothDutyScanStoppedLocked(Landroid/os/WorkSource$WorkChain;IZIJJ)V
    .locals 6

    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result p2

    :cond_0
    move v1, p2

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    add-int/lit8 p1, p1, -0x1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    if-nez p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/4 p2, 0x0

    invoke-virtual {p1, p2}, Lcom/android/internal/os/BatteryStatsHistory;->setBluetoothScanState(Z)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p1, p5, p6, p7, p8}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, p5, p6}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_1
    move-object v0, p0

    move-wide v2, p5

    move-wide v4, p7

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    if-eqz p1, :cond_2

    invoke-virtual {p1}, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->isRunningLocked()Z

    move-result p1

    if-eqz p1, :cond_2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->stopRunningLocked(J)V

    :cond_2
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p1, :cond_3

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_3
    if-eqz p3, :cond_4

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p1, :cond_4

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_4
    if-lez p4, :cond_5

    invoke-virtual {p0, p4, v2, v3, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteBluetoothScanStartedLocked(IJZ)V

    :cond_5
    return-void
.end method

.method public final noteBluetoothScanStartedLocked(Landroid/os/WorkSource$WorkChain;IZJJ)V
    .locals 8

    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result p2

    :cond_0
    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    if-nez p1, :cond_1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v7, 0x100000

    move-wide v3, p4

    move-wide v5, p6

    invoke-virtual/range {v2 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V

    move-wide v2, v3

    move-wide v4, v5

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_0

    :cond_1
    move-wide v2, p4

    move-wide v4, p6

    :goto_0
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    add-int/lit8 p1, p1, 0x1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    move-object v0, p0

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p4

    move-wide p0, v2

    iget-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez p2, :cond_2

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v3, p2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v5, p2, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanOnTimers:Ljava/util/ArrayList;

    iget-object v6, p2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v7, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-object v4, p4

    invoke-direct/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_2
    iget-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {p2, p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->startRunningLocked(J)V

    if-eqz p3, :cond_4

    iget-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez p2, :cond_3

    new-instance p2, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object p3, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    move-object p5, p3

    iget-object p3, p5, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object p6, p5, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object p7, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 p5, 0x0

    invoke-direct/range {p2 .. p7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_3
    iget-object p2, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {p2, p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->startRunningLocked(J)V

    :cond_4
    return-void
.end method

.method public final noteBluetoothScanStoppedLocked(Landroid/os/WorkSource$WorkChain;IZJJ)V
    .locals 8

    if-eqz p1, :cond_0

    invoke-virtual {p1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result p2

    :cond_0
    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    add-int/lit8 p1, p1, -0x1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    if-nez p1, :cond_1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v7, 0x100000

    move-wide v3, p4

    move-wide v5, p6

    invoke-virtual/range {v2 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    move-wide v2, v3

    move-wide v4, v5

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :goto_0
    move-object v0, p0

    goto :goto_1

    :cond_1
    move-wide v2, p4

    move-wide v4, p6

    goto :goto_0

    :goto_1
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p1, :cond_2

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_2
    if-eqz p3, :cond_3

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p0, :cond_3

    invoke-virtual {p0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_3
    return-void
.end method

.method public final noteCameraOffLocked(IJJ)V
    .locals 9

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    if-nez v0, :cond_0

    return-void

    :cond_0
    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result p1

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    add-int/lit8 v0, v0, -0x1

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    if-nez v0, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x200000

    const-string/jumbo v8, "camera"

    move v7, p1

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJIILjava/lang/String;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_1
    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p1

    iget-object p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz p1, :cond_2

    invoke-virtual {p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_2
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 p2, 0x3

    invoke-virtual {p1, p2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result p1

    if-eqz p1, :cond_3

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    invoke-virtual {p0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_3
    const-string/jumbo p1, "camera-off"

    const/16 p2, 0x40

    invoke-virtual {p0, p2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    return-void
.end method

.method public final noteCameraOnLocked(IJJ)V
    .locals 8

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result p1

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    add-int/lit8 v1, v0, 0x1

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    if-nez v0, :cond_0

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v5, 0x200000

    const-string/jumbo v7, "camera"

    move v6, p1

    move-wide v1, p2

    move-wide v3, p4

    invoke-virtual/range {v0 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJIILjava/lang/String;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_0
    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v3

    iget-object p1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez p1, :cond_1

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object p1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v2, p1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, p1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraTurnedOnTimers:Ljava/util/ArrayList;

    iget-object v5, p1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v6, 0x0

    invoke-direct/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_1
    iget-object p1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 p2, 0x3

    invoke-virtual {p1, p2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result p1

    if-eqz p1, :cond_2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    invoke-virtual {p0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_2
    const-string/jumbo p1, "camera-on"

    const/16 p2, 0x40

    invoke-virtual {p0, p2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    return-void
.end method

.method public final noteChangeWakelockFromSourceLocked(Landroid/os/WorkSource;ILjava/lang/String;Ljava/lang/String;ILandroid/os/WorkSource;ILjava/lang/String;Ljava/lang/String;IZJJ)V
    .locals 22

    move-object/from16 v0, p1

    move-object/from16 v1, p6

    invoke-static {v0, v1}, Landroid/os/WorkSource;->diffChains(Landroid/os/WorkSource;Landroid/os/WorkSource;)[Ljava/util/ArrayList;

    move-result-object v2

    invoke-virtual {v1}, Landroid/os/WorkSource;->size()I

    move-result v3

    const/4 v4, 0x0

    move v5, v4

    :goto_0
    if-ge v5, v3, :cond_0

    invoke-virtual {v1, v5}, Landroid/os/WorkSource;->getUid(I)I

    move-result v7

    const/4 v9, 0x0

    move-object/from16 v6, p0

    move/from16 v8, p7

    move-object/from16 v10, p8

    move-object/from16 v11, p9

    move/from16 v12, p10

    move/from16 v13, p11

    move-wide/from16 v14, p12

    move-wide/from16 v16, p14

    invoke-virtual/range {v6 .. v17}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStartWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IZJJ)V

    add-int/lit8 v5, v5, 0x1

    goto :goto_0

    :cond_0
    if-eqz v2, :cond_1

    aget-object v1, v2, v4

    if-eqz v1, :cond_1

    move v3, v4

    :goto_1
    invoke-interface {v1}, Ljava/util/List;->size()I

    move-result v5

    if-ge v3, v5, :cond_1

    invoke-interface {v1, v3}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    move-object v13, v5

    check-cast v13, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v13}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v11

    move-object/from16 v10, p0

    move/from16 v12, p7

    move-object/from16 v14, p8

    move-object/from16 v15, p9

    move/from16 v16, p10

    move/from16 v17, p11

    move-wide/from16 v18, p12

    move-wide/from16 v20, p14

    invoke-virtual/range {v10 .. v21}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStartWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IZJJ)V

    add-int/lit8 v3, v3, 0x1

    goto :goto_1

    :cond_1
    invoke-virtual {v0}, Landroid/os/WorkSource;->size()I

    move-result v1

    move v3, v4

    :goto_2
    if-ge v3, v1, :cond_2

    invoke-virtual {v0, v3}, Landroid/os/WorkSource;->getUid(I)I

    move-result v11

    const/4 v13, 0x0

    move-object/from16 v10, p0

    move/from16 v12, p2

    move-object/from16 v14, p3

    move-object/from16 v15, p4

    move/from16 v16, p5

    move-wide/from16 v17, p12

    move-wide/from16 v19, p14

    invoke-virtual/range {v10 .. v20}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IJJ)V

    add-int/lit8 v3, v3, 0x1

    goto :goto_2

    :cond_2
    if-eqz v2, :cond_3

    const/4 v0, 0x1

    aget-object v0, v2, v0

    if-eqz v0, :cond_3

    :goto_3
    invoke-interface {v0}, Ljava/util/List;->size()I

    move-result v1

    if-ge v4, v1, :cond_3

    invoke-interface {v0, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    move-object v13, v1

    check-cast v13, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v13}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v11

    move-object/from16 v10, p0

    move/from16 v12, p2

    move-object/from16 v14, p3

    move-object/from16 v15, p4

    move/from16 v16, p5

    move-wide/from16 v17, p12

    move-wide/from16 v19, p14

    invoke-virtual/range {v10 .. v20}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IJJ)V

    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    :cond_3
    return-void
.end method

.method public final noteDeviceIdleModeLocked(IILjava/lang/String;JJ)V
    .locals 16

    move-object/from16 v0, p0

    move/from16 v6, p1

    const/4 v1, 0x0

    const/4 v15, 0x1

    const/4 v2, 0x2

    if-ne v6, v2, :cond_0

    move v3, v15

    goto :goto_0

    :cond_0
    move v3, v1

    :goto_0
    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdling:Z

    if-eqz v4, :cond_1

    if-nez v3, :cond_1

    if-nez p3, :cond_1

    move v3, v15

    :cond_1
    if-ne v6, v15, :cond_2

    move v5, v15

    goto :goto_1

    :cond_2
    move v5, v1

    :goto_1
    iget-boolean v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdling:Z

    if-eqz v7, :cond_3

    if-nez v5, :cond_3

    if-nez v3, :cond_3

    if-nez p3, :cond_3

    move v5, v15

    :cond_3
    if-eqz p3, :cond_4

    if-nez v4, :cond_5

    if-eqz v7, :cond_4

    goto :goto_2

    :cond_4
    move-wide/from16 v8, p4

    goto :goto_3

    :cond_5
    :goto_2
    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v12, 0xa

    move/from16 v14, p2

    move-object/from16 v13, p3

    move-wide/from16 v8, p4

    move-wide/from16 v10, p6

    invoke-virtual/range {v7 .. v14}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    :goto_3
    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdling:Z

    if-ne v4, v3, :cond_6

    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdling:Z

    if-eq v4, v5, :cond_9

    :cond_6
    if-eqz v3, :cond_7

    move v4, v2

    goto :goto_4

    :cond_7
    if-eqz v5, :cond_8

    move v4, v15

    goto :goto_4

    :cond_8
    move v4, v1

    :goto_4
    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v7}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v7, 0x16

    invoke-static {v7, v4}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_9
    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdling:Z

    if-eq v4, v3, :cond_c

    iput-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdling:Z

    if-eqz v3, :cond_a

    const/16 v1, 0x8

    :cond_a
    iget v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    iget v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    and-int/lit8 v10, v7, 0x8

    xor-int/2addr v10, v1

    or-int/2addr v4, v10

    iput v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    and-int/lit8 v4, v7, -0x9

    or-int/2addr v1, v4

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    if-eqz v3, :cond_b

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_5

    :cond_b
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_c
    :goto_5
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdling:Z

    if-eq v1, v5, :cond_e

    iput-boolean v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdling:Z

    if-eqz v5, :cond_d

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_6

    :cond_d
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_e
    :goto_6
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    if-eq v1, v6, :cond_15

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v4, p6

    move v7, v2

    move-wide v2, v8

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordDeviceIdleEvent(JJI)V

    iget-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastIdleTimeStartMs:J

    sub-long v1, v8, v1

    iput-wide v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastIdleTimeStartMs:J

    iget v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    if-ne v3, v15, :cond_10

    iget-wide v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    cmp-long v3, v1, v3

    if-lez v3, :cond_f

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    :cond_f
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_7

    :cond_10
    if-ne v3, v7, :cond_12

    iget-wide v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    cmp-long v3, v1, v3

    if-lez v3, :cond_11

    iput-wide v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    :cond_11
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_12
    :goto_7
    if-ne v6, v15, :cond_13

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_8

    :cond_13
    if-ne v6, v7, :cond_14

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_14
    :goto_8
    iput v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v0, 0x15

    invoke-static {v0, v6}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_15
    return-void
.end method

.method public final noteFullWifiLockAcquiredLocked(IJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    if-nez v0, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x10000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStartEvent(JJI)V

    :cond_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteFullWifiLockAcquiredLocked(J)V

    return-void
.end method

.method public final noteFullWifiLockReleasedLocked(IJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    add-int/lit8 v0, v0, -0x1

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiFullLockNesting:I

    if-nez v0, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x10000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStopEvent(JJI)V

    :cond_0
    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteFullWifiLockReleasedLocked(J)V

    return-void
.end method

.method public final noteGpsChangedLocked(Landroid/os/WorkSource;Landroid/os/WorkSource;JJ)V
    .locals 13

    const/4 v0, 0x0

    move v1, v0

    :goto_0
    invoke-virtual {p2}, Landroid/os/WorkSource;->size()I

    move-result v2

    if-ge v1, v2, :cond_0

    invoke-virtual {p2, v1}, Landroid/os/WorkSource;->getUid(I)I

    move-result v4

    const/4 v5, 0x0

    move-object v3, p0

    move-wide/from16 v6, p3

    move-wide/from16 v8, p5

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStartGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_0
    move v1, v0

    :goto_1
    invoke-virtual {p1}, Landroid/os/WorkSource;->size()I

    move-result v2

    if-ge v1, v2, :cond_1

    invoke-virtual {p1, v1}, Landroid/os/WorkSource;->getUid(I)I

    move-result v7

    const/4 v8, 0x0

    move-object v6, p0

    move-wide/from16 v9, p3

    move-wide/from16 v11, p5

    invoke-virtual/range {v6 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_1

    :cond_1
    invoke-static/range {p1 .. p2}, Landroid/os/WorkSource;->diffChains(Landroid/os/WorkSource;Landroid/os/WorkSource;)[Ljava/util/ArrayList;

    move-result-object p1

    if-eqz p1, :cond_3

    aget-object p2, p1, v0

    if-eqz p2, :cond_2

    move v1, v0

    :goto_2
    invoke-interface {p2}, Ljava/util/List;->size()I

    move-result v2

    if-ge v1, v2, :cond_2

    invoke-interface {p2, v1}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    move-object v8, v2

    check-cast v8, Landroid/os/WorkSource$WorkChain;

    const/4 v7, -0x1

    move-object v6, p0

    move-wide/from16 v9, p3

    move-wide/from16 v11, p5

    invoke-virtual/range {v6 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStartGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    :cond_2
    const/4 p2, 0x1

    aget-object p1, p1, p2

    if-eqz p1, :cond_3

    :goto_3
    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result p2

    if-ge v0, p2, :cond_3

    invoke-interface {p1, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object p2

    move-object v8, p2

    check-cast v8, Landroid/os/WorkSource$WorkChain;

    const/4 v7, -0x1

    move-object v6, p0

    move-wide/from16 v9, p3

    move-wide/from16 v11, p5

    invoke-virtual/range {v6 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_3

    :cond_3
    return-void
.end method

.method public final noteGpsSignalQualityLocked(IJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    if-nez v0, :cond_0

    goto :goto_0

    :cond_0
    if-ltz p1, :cond_1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v1, v0

    if-lt p1, v1, :cond_2

    :cond_1
    move-wide v2, p2

    goto :goto_1

    :cond_2
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityBin:I

    if-eq v1, p1, :cond_5

    if-ltz v1, :cond_3

    aget-object v0, v0, v1

    invoke-virtual {v0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_3
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, p1

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v0

    if-nez v0, :cond_4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, p1

    invoke-virtual {v0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_4
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move v6, p1

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordGpsSignalQualityEvent(JJI)V

    iput v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityBin:I

    :cond_5
    :goto_0
    return-void

    :goto_1
    invoke-virtual {p0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl;->stopAllGpsSignalQualityTimersLocked(J)V

    return-void
.end method

.method public final noteJobFinishLocked(IILjava/lang/String;JJ)V
    .locals 6

    invoke-static {p3}, Lcom/android/server/power/stats/BatteryStatsImpl;->encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;

    move-result-object p3

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p4

    move-wide v4, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    move p7, v1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    invoke-virtual {p1, v2, v3, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->stopObject(JLjava/lang/String;)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p1, :cond_0

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_0
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    const/4 p4, 0x0

    if-eqz p1, :cond_2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobCompletions:Landroid/util/ArrayMap;

    invoke-virtual {p1, p3}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/util/SparseIntArray;

    if-nez p1, :cond_1

    new-instance p1, Landroid/util/SparseIntArray;

    invoke-direct {p1}, Landroid/util/SparseIntArray;-><init>()V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobCompletions:Landroid/util/ArrayMap;

    invoke-virtual {p0, p3, p1}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_1
    invoke-virtual {p1, p2, p4}, Landroid/util/SparseIntArray;->get(II)I

    move-result p0

    add-int/lit8 p0, p0, 0x1

    invoke-virtual {p1, p2, p0}, Landroid/util/SparseIntArray;->put(II)V

    :cond_2
    iget-object p0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const/16 p1, 0x4006

    invoke-virtual {p0, p1, p3, p7, p4}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result p0

    if-nez p0, :cond_3

    return-void

    :cond_3
    iget-object p0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 p5, 0x4006

    move-object p6, p3

    move-wide p1, v2

    move-wide p3, v4

    invoke-virtual/range {p0 .. p7}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    return-void
.end method

.method public final noteJobsDeferredLocked(IIJJJ)V
    .locals 6

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p5

    move-wide v4, p7

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredEventCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    const/4 p5, 0x1

    invoke-virtual {p1, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->addAtomic(I)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->addAtomic(I)V

    const-wide/16 p1, 0x0

    cmp-long p1, p3, p1

    if-eqz p1, :cond_2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    const/4 p1, 0x0

    :goto_0
    sget-object p2, Landroid/os/BatteryStats;->JOB_FRESHNESS_BUCKETS:[J

    array-length p6, p2

    if-ge p1, p6, :cond_2

    aget-wide p6, p2, p1

    cmp-long p2, p3, p6

    if-gez p2, :cond_1

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object p3, p2, p1

    if-nez p3, :cond_0

    new-instance p3, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object p4, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object p4, p4, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object p3, p2, p1

    :cond_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object p0, p0, p1

    invoke-virtual {p0, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->addAtomic(I)V

    return-void

    :cond_1
    add-int/lit8 p1, p1, 0x1

    goto :goto_0

    :cond_2
    return-void
.end method

.method public final noteLongPartialWakeLockFinishInternal(ILjava/lang/String;Ljava/lang/String;JJ)V
    .locals 8

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v7

    if-nez p3, :cond_0

    goto :goto_0

    :cond_0
    move-object p2, p3

    :goto_0
    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const/16 v0, 0x4014

    const/4 v1, 0x0

    invoke-virtual {p3, v0, p2, v7, v1}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result p3

    if-nez p3, :cond_1

    goto :goto_1

    :cond_1
    invoke-static {p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v5, 0x4014

    move-wide v1, p4

    move-wide v3, p6

    invoke-virtual/range {v0 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    if-eq v7, p1, :cond_2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/PowerStatsUidResolver;->releaseIsolatedUid(I)V

    :cond_2
    :goto_1
    return-void
.end method

.method public final noteLongPartialWakeLockStartInternal(ILjava/lang/String;Ljava/lang/String;JJ)V
    .locals 8

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v7

    if-nez p3, :cond_0

    goto :goto_0

    :cond_0
    move-object p2, p3

    :goto_0
    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const v0, 0x8014

    const/4 v1, 0x0

    invoke-virtual {p3, v0, p2, v7, v1}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result p3

    if-nez p3, :cond_1

    goto :goto_1

    :cond_1
    invoke-static {p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const v5, 0x8014

    move-wide v1, p4

    move-wide v3, p6

    invoke-virtual/range {v0 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    if-eq v7, p1, :cond_2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/PowerStatsUidResolver;->retainIsolatedUid(I)V

    :cond_2
    :goto_1
    return-void
.end method

.method public final noteMainDisplayHighRefreshRateLocked(IJ)V
    .locals 3

    if-ltz p1, :cond_3

    const/4 v0, 0x4

    if-lt p1, v0, :cond_0

    goto :goto_1

    :cond_0
    const/4 v1, 0x0

    :goto_0
    if-ge v1, v0, :cond_1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_1
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v0}, Landroid/view/Display;->isOnState(I)Z

    move-result v0

    if-eqz v0, :cond_2

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p0, p0, p1

    invoke-virtual {p0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_2
    return-void

    :cond_3
    :goto_1
    const-string p0, "BatteryStatsImpl"

    const-string/jumbo p1, "Something was wrong while updating the main display\'s refresh rate"

    invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final noteMobileRadioPowerStateLocked(IIJJJ)V
    .locals 18

    move-object/from16 v0, p0

    move/from16 v6, p1

    move/from16 v1, p2

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerState:I

    if-eq v2, v6, :cond_b

    const/4 v2, 0x2

    if-eq v6, v2, :cond_1

    const/4 v2, 0x3

    if-ne v6, v2, :cond_0

    goto :goto_1

    :cond_0
    const/4 v2, 0x0

    :goto_0
    move v15, v2

    goto :goto_2

    :cond_1
    :goto_1
    const/4 v2, 0x1

    goto :goto_0

    :goto_2
    const-wide/32 v16, 0xf4240

    if-eqz v15, :cond_4

    if-lez v1, :cond_3

    invoke-virtual {v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v14

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v12, 0x13

    const-string v13, ""

    move-wide/from16 v8, p5

    move-wide/from16 v10, p7

    invoke-virtual/range {v7 .. v14}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    move-wide v2, v8

    move-wide v4, v10

    move v1, v14

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    move-object v7, v0

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v0, :cond_2

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v0, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :cond_2
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const-wide/16 v1, 0x1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    goto :goto_3

    :cond_3
    move-object v7, v0

    :goto_3
    div-long v8, p3, v16

    iput-wide v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveStartTimeMs:J

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v5, 0x2000000

    move-wide/from16 v1, p5

    move-wide/from16 v3, p7

    invoke-virtual/range {v0 .. v5}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStartEvent(JJI)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-boolean v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsServiceStateNr:Z

    if-eqz v0, :cond_7

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_5

    :cond_4
    move-wide/from16 v1, p5

    move-object v7, v0

    div-long v3, p3, v16

    iget-wide v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveStartTimeMs:J

    cmp-long v0, v3, v8

    if-gez v0, :cond_5

    const-string v0, "Data connection inactive timestamp "

    const-string v5, " is before start time "

    invoke-static {v0, v3, v4, v5}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;JLjava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v0

    invoke-virtual {v0, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v3, "BatteryStatsImpl"

    invoke-static {v3, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    move-wide v8, v1

    goto :goto_4

    :cond_5
    cmp-long v0, v3, v1

    if-gez v0, :cond_6

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    sub-long v8, v1, v3

    invoke-virtual {v0, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_6
    move-wide v8, v3

    :goto_4
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v5, 0x2000000

    move-wide/from16 v3, p7

    invoke-virtual/range {v0 .. v5}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStopEvent(JJI)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    :cond_7
    :goto_5
    iput v6, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerState:I

    iget v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveRat:I

    invoke-virtual {v7, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v0

    invoke-virtual {v0, v1, v2, v15}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->noteActive(JZ)V

    if-eqz v15, :cond_8

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_6

    :cond_8
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    iget-boolean v3, v0, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    if-eqz v3, :cond_9

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    goto :goto_6

    :cond_9
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemActivityInfo:Landroid/telephony/ModemActivityInfo;

    if-eqz v0, :cond_a

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getTimestampMillis()J

    move-result-wide v3

    const-wide/32 v5, 0x927c0

    add-long/2addr v3, v5

    cmp-long v0, v1, v3

    if-ltz v0, :cond_b

    :cond_a
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    const-string/jumbo v1, "modem-data"

    const/4 v2, 0x4

    invoke-virtual {v0, v2, v1}, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->scheduleSync(ILjava/lang/String;)V

    :cond_b
    :goto_6
    return-void
.end method

.method public final noteModemControllerActivity(Landroid/telephony/ModemActivityInfo;JJJLandroid/app/usage/NetworkStatsManager;)V
    .locals 2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemActivityInfo:Landroid/telephony/ModemActivityInfo;

    if-nez v0, :cond_0

    invoke-virtual {p1, p1}, Landroid/telephony/ModemActivityInfo;->getDelta(Landroid/telephony/ModemActivityInfo;)Landroid/telephony/ModemActivityInfo;

    move-result-object v0

    goto :goto_0

    :cond_0
    invoke-virtual {v0, p1}, Landroid/telephony/ModemActivityInfo;->getDelta(Landroid/telephony/ModemActivityInfo;)Landroid/telephony/ModemActivityInfo;

    move-result-object v0

    :goto_0
    iput-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemActivityInfo:Landroid/telephony/ModemActivityInfo;

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemNetworkLock:Ljava/lang/Object;

    monitor-enter p1

    :try_start_0
    invoke-virtual {p0, p8}, Lcom/android/server/power/stats/BatteryStatsImpl;->readMobileNetworkStatsLocked(Landroid/app/usage/NetworkStatsManager;)Landroid/net/NetworkStats;

    move-result-object p8

    if-eqz p8, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemNetworkStats:Landroid/net/NetworkStats;

    invoke-virtual {p0, p8, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->networkStatsDelta(Landroid/net/NetworkStats;Landroid/net/NetworkStats;)Landroid/net/NetworkStats;

    move-result-object v1

    iput-object p8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastModemNetworkStats:Landroid/net/NetworkStats;

    goto :goto_1

    :catchall_0
    move-exception v0

    move-object p0, v0

    goto :goto_2

    :cond_1
    const/4 v1, 0x0

    :goto_1
    monitor-exit p1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-wide p7, p6

    move-object p1, v0

    move-wide p5, p4

    move-wide p3, p2

    move-object p2, v1

    invoke-virtual/range {p0 .. p8}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateCellularBatteryStats(Landroid/telephony/ModemActivityInfo;Landroid/net/NetworkStats;JJJ)V

    return-void

    :goto_2
    :try_start_1
    monitor-exit p1
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw p0
.end method

.method public final noteNetworkInterfaceForTransports(Ljava/lang/String;[I)V
    .locals 6

    invoke-static {p1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z

    move-result v0

    if-eqz v0, :cond_0

    return-void

    :cond_0
    invoke-static {p2}, Landroid/os/BatteryStats;->getDisplayTransport([I)I

    move-result p2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemNetworkLock:Ljava/lang/Object;

    monitor-enter v0

    const/4 v1, 0x0

    const/4 v2, 0x1

    if-nez p2, :cond_2

    :try_start_0
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemIfaces:[Ljava/lang/String;

    invoke-static {v3, p1}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v4

    if-ltz v4, :cond_1

    goto :goto_0

    :cond_1
    array-length v4, v3

    add-int/2addr v4, v2

    new-array v4, v4, [Ljava/lang/String;

    array-length v5, v3

    invoke-static {v3, v1, v4, v1, v5}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    array-length v3, v3

    aput-object p1, v4, v3

    move-object v3, v4

    :goto_0
    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemIfaces:[Ljava/lang/String;

    goto :goto_1

    :catchall_0
    move-exception p0

    goto :goto_5

    :cond_2
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemIfaces:[Ljava/lang/String;

    invoke-static {p1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl;->excludeFromStringArray(Ljava/lang/String;[Ljava/lang/String;)[Ljava/lang/String;

    move-result-object v3

    iput-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemIfaces:[Ljava/lang/String;

    :goto_1
    monitor-exit v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiNetworkLock:Ljava/lang/Object;

    monitor-enter v3

    if-ne p2, v2, :cond_4

    :try_start_1
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiIfaces:[Ljava/lang/String;

    invoke-static {p2, p1}, Lcom/android/internal/util/ArrayUtils;->indexOf([Ljava/lang/Object;Ljava/lang/Object;)I

    move-result v0

    if-ltz v0, :cond_3

    goto :goto_2

    :cond_3
    array-length v0, p2

    add-int/2addr v0, v2

    new-array v0, v0, [Ljava/lang/String;

    array-length v2, p2

    invoke-static {p2, v1, v0, v1, v2}, Ljava/lang/System;->arraycopy(Ljava/lang/Object;ILjava/lang/Object;II)V

    array-length p2, p2

    aput-object p1, v0, p2

    move-object p2, v0

    :goto_2
    iput-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiIfaces:[Ljava/lang/String;

    goto :goto_3

    :catchall_1
    move-exception p0

    goto :goto_4

    :cond_4
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiIfaces:[Ljava/lang/String;

    invoke-static {p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->excludeFromStringArray(Ljava/lang/String;[Ljava/lang/String;)[Ljava/lang/String;

    move-result-object p1

    iput-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiIfaces:[Ljava/lang/String;

    :goto_3
    monitor-exit v3

    return-void

    :goto_4
    monitor-exit v3
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw p0

    :goto_5
    :try_start_2
    monitor-exit v0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw p0
.end method

.method public final notePhoneDataConnectionStateLocked(IZIIIJJ)V
    .locals 16

    move-object/from16 v0, p0

    move/from16 v1, p1

    move/from16 v2, p3

    move/from16 v6, p4

    move/from16 v7, p5

    const/4 v14, 0x1

    const/4 v15, 0x2

    const/4 v3, 0x0

    if-eqz p2, :cond_2

    if-lez v1, :cond_0

    sget v4, Landroid/os/BatteryStats;->NUM_ALL_NETWORK_TYPES:I

    if-gt v1, v4, :cond_0

    :goto_0
    move v13, v1

    goto :goto_1

    :cond_0
    if-eq v2, v14, :cond_2

    if-eq v2, v15, :cond_1

    sget v1, Landroid/os/BatteryStats;->DATA_CONNECTION_OTHER:I

    goto :goto_0

    :cond_1
    sget v1, Landroid/os/BatteryStats;->DATA_CONNECTION_EMERGENCY_SERVICE:I

    goto :goto_0

    :cond_2
    move v13, v3

    :goto_1
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionType:I

    if-eq v1, v13, :cond_4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v9, p6

    move-wide/from16 v11, p8

    invoke-virtual/range {v8 .. v13}, Lcom/android/internal/os/BatteryStatsHistory;->recordDataConnectionTypeChangeEvent(JJI)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionType:I

    if-ltz v1, :cond_3

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v1, v2, v1

    invoke-virtual {v1, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_3
    iput v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionType:I

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v1, v1, v13

    invoke-virtual {v1, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_2

    :cond_4
    move-wide/from16 v9, p6

    :goto_2
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrState:I

    if-eq v1, v6, :cond_5

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v4, p8

    move v8, v3

    move-wide v2, v9

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordNrStateChangeEvent(JJI)V

    iput v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrState:I

    goto :goto_3

    :cond_5
    move v8, v3

    :goto_3
    const/4 v1, 0x3

    const/16 v2, 0xd

    if-ne v13, v2, :cond_6

    if-ne v6, v1, :cond_6

    move v3, v14

    goto :goto_4

    :cond_6
    move v3, v8

    :goto_4
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v4

    if-eq v3, v4, :cond_8

    if-eqz v3, :cond_7

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v3, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_5

    :cond_7
    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v3, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_8
    :goto_5
    if-ne v13, v2, :cond_9

    if-ne v6, v1, :cond_9

    :pswitch_0
    move v14, v15

    goto :goto_6

    :cond_9
    packed-switch v13, :pswitch_data_0

    :pswitch_1
    const-string/jumbo v1, "Unhandled NetworkType ("

    const-string v2, "), mapping to OTHER"

    const-string v3, "BatteryStatsImpl"

    invoke-static {v13, v1, v2, v3}, Lcom/android/server/accessibility/BrailleDisplayConnection$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    :pswitch_2
    move v14, v8

    :goto_6
    :pswitch_3
    if-ne v14, v15, :cond_c

    invoke-virtual {v0, v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v1

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mFrequencyRange:I

    if-ne v2, v7, :cond_a

    goto :goto_7

    :cond_a
    iget-boolean v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mActive:Z

    if-nez v3, :cond_b

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mFrequencyRange:I

    goto :goto_7

    :cond_b
    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v3, v2

    iget v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mSignalStrength:I

    aget-object v2, v2, v4

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    aget-object v2, v3, v7

    iget v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mSignalStrength:I

    aget-object v2, v2, v3

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mFrequencyRange:I

    :cond_c
    :goto_7
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveRat:I

    if-eq v1, v14, :cond_d

    invoke-virtual {v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v1

    invoke-virtual {v1, v9, v10, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->noteActive(JZ)V

    iput v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveRat:I

    :cond_d
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    invoke-virtual {v0, v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v0

    invoke-virtual {v0, v9, v10, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->noteActive(JZ)V

    return-void

    nop

    :pswitch_data_0
    .packed-switch 0x0
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_3
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_2
        :pswitch_1
        :pswitch_0
    .end packed-switch
.end method

.method public final notePhoneOnLocked(JJ)V
    .locals 7

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOn:Z

    if-nez v0, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x800000

    move-wide v2, p1

    move-wide v4, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V

    const/4 p1, 0x1

    iput-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOn:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-boolean p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PHONE_ON_EXTERNAL_STATS_COLLECTION:Z

    if-eqz p1, :cond_0

    const-string/jumbo p1, "phone-on"

    const/4 p2, 0x4

    invoke-virtual {p0, p2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    invoke-virtual {p0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    :cond_0
    return-void
.end method

.method public final notePhoneSignalStrengthLocked(Landroid/telephony/SignalStrength;JJ)V
    .locals 8

    invoke-virtual {p1}, Landroid/telephony/SignalStrength;->getLevel()I

    move-result v3

    new-instance v0, Landroid/util/SparseIntArray;

    const/4 v1, 0x3

    invoke-direct {v0, v1}, Landroid/util/SparseIntArray;-><init>(I)V

    invoke-virtual {p1}, Landroid/telephony/SignalStrength;->getCellSignalStrengths()Ljava/util/List;

    move-result-object p1

    invoke-interface {p1}, Ljava/util/List;->size()I

    move-result v1

    const/4 v2, 0x0

    move v4, v2

    :goto_0
    if-ge v4, v1, :cond_3

    invoke-interface {p1, v4}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/telephony/CellSignalStrength;

    instance-of v6, v5, Landroid/telephony/CellSignalStrengthNr;

    if-eqz v6, :cond_0

    invoke-virtual {v5}, Landroid/telephony/CellSignalStrength;->getLevel()I

    move-result v5

    const/4 v6, 0x2

    goto :goto_1

    :cond_0
    instance-of v6, v5, Landroid/telephony/CellSignalStrengthLte;

    if-eqz v6, :cond_1

    invoke-virtual {v5}, Landroid/telephony/CellSignalStrength;->getLevel()I

    move-result v5

    const/4 v6, 0x1

    goto :goto_1

    :cond_1
    invoke-virtual {v5}, Landroid/telephony/CellSignalStrength;->getLevel()I

    move-result v5

    move v6, v2

    :goto_1
    const/4 v7, -0x1

    invoke-virtual {v0, v6, v7}, Landroid/util/SparseIntArray;->get(II)I

    move-result v7

    if-ge v7, v5, :cond_2

    invoke-virtual {v0, v6, v5}, Landroid/util/SparseIntArray;->put(II)V

    :cond_2
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_3
    invoke-virtual {v0}, Landroid/util/SparseIntArray;->size()I

    move-result p1

    :goto_2
    if-ge v2, p1, :cond_6

    invoke-virtual {v0, v2}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v1

    invoke-virtual {v0, v2}, Landroid/util/SparseIntArray;->valueAt(I)I

    move-result v4

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v1

    iget v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mSignalStrength:I

    if-ne v5, v4, :cond_4

    goto :goto_3

    :cond_4
    iget-boolean v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mActive:Z

    if-nez v6, :cond_5

    iput v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mSignalStrength:I

    goto :goto_3

    :cond_5
    iget v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mFrequencyRange:I

    iget-object v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v6, v7, v6

    aget-object v5, v6, v5

    invoke-virtual {v5, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mFrequencyRange:I

    aget-object v5, v7, v5

    aget-object v5, v5, v4

    invoke-virtual {v5, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iput v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mSignalStrength:I

    :goto_3
    add-int/lit8 v2, v2, 0x1

    goto :goto_2

    :cond_6
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceStateRaw:I

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSimStateRaw:I

    move-object v0, p0

    move-wide v4, p2

    move-wide v6, p4

    invoke-virtual/range {v0 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateAllPhoneStateLocked(IIIJJ)V

    return-void
.end method

.method public final notePowerSaveModeLocked(JJZ)V
    .locals 7

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabled:Z

    if-eq v1, p5, :cond_2

    if-eqz p5, :cond_0

    const/4 v1, 0x4

    goto :goto_0

    :cond_0
    const/4 v1, 0x0

    :goto_0
    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    iget v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    and-int/lit8 v4, v3, 0x4

    xor-int/2addr v4, v1

    or-int/2addr v2, v4

    iput v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    and-int/lit8 v2, v3, -0x5

    or-int/2addr v1, v2

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput-boolean p5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabled:Z

    if-eqz p5, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, -0x80000000

    move-wide v2, p1

    move-wide v4, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_1

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, -0x80000000

    move-wide v2, p1

    move-wide v4, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :goto_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v0, 0x14

    invoke-static {v0, p5}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_2
    return-void
.end method

.method public final noteResetBluetoothScanLocked(JJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    if-lez v0, :cond_3

    const/4 v0, 0x0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x100000

    move-wide v2, p1

    move-wide v4, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    :goto_0
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p1}, Landroid/util/SparseArray;->size()I

    move-result p1

    if-ge v0, p1, :cond_3

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p1, v0}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object p2, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    if-eqz p2, :cond_0

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->stopRunningLocked(J)V

    :cond_0
    iget-object p2, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p2, :cond_1

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopAllRunningLocked(J)V

    :cond_1
    iget-object p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz p1, :cond_2

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopAllRunningLocked(J)V

    :cond_2
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_3
    return-void
.end method

.method public final noteResetCameraLocked(JJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    if-lez v0, :cond_1

    const/4 v0, 0x0

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x200000

    move-wide v2, p1

    move-wide v4, p3

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    :goto_0
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p1}, Landroid/util/SparseArray;->size()I

    move-result p1

    if-ge v0, p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p1, v0}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz p1, :cond_0

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    :cond_0
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_1
    const-string/jumbo p1, "camera-reset"

    const/16 p2, 0x40

    invoke-virtual {p0, p2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    return-void
.end method

.method public final noteScreenAutoBrightnessLocked(I)V
    .locals 4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    const/4 v2, 0x1

    if-ne p1, v2, :cond_0

    goto :goto_0

    :cond_0
    const/4 v2, 0x0

    :goto_0
    iget-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    if-eq p1, v2, :cond_3

    iput-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    if-ltz p1, :cond_3

    const/4 v3, 0x5

    if-lt p1, v3, :cond_1

    goto :goto_2

    :cond_1
    if-eqz v2, :cond_2

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {p1}, Landroid/view/Display;->isOnState(I)Z

    move-result p1

    if-eqz p1, :cond_2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p1, p1, v2

    invoke-virtual {p1, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_1

    :cond_2
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p1, p1, v2

    invoke-virtual {p1, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :goto_1
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object p0, p1, p0

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_3
    :goto_2
    return-void
.end method

.method public final noteScreenBrightnessLocked(IIIJJ)V
    .locals 7

    const/4 v0, 0x0

    const/4 v1, 0x1

    if-ne p3, v1, :cond_0

    move v2, v1

    goto :goto_0

    :cond_0
    move v2, v0

    :goto_0
    if-eqz v2, :cond_1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v3, v3

    if-le v3, v1, :cond_1

    move p1, v1

    :cond_1
    const/16 v3, 0xff

    const/4 v4, 0x2

    if-le p2, v3, :cond_3

    iput-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightness:Z

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    if-ne v1, v4, :cond_2

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-nez v1, :cond_2

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_2
    if-eqz v2, :cond_5

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-nez v1, :cond_5

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_1

    :cond_3
    iput-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightness:Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-eqz v1, :cond_4

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_4
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-eqz v1, :cond_5

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_5
    :goto_1
    div-int/lit8 p2, p2, 0x33

    if-gez p2, :cond_6

    goto :goto_2

    :cond_6
    const/4 v0, 0x5

    if-lt p2, v0, :cond_7

    const/4 v0, 0x4

    goto :goto_2

    :cond_7
    move v0, p2

    :goto_2
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v1, p2

    if-ltz p1, :cond_8

    if-lt p1, v1, :cond_9

    :cond_8
    move-object v0, p0

    goto :goto_5

    :cond_9
    aget-object p1, p2, p1

    iget p2, p1, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    if-ne p2, v0, :cond_a

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    :goto_3
    move-object v0, p0

    move v1, p1

    move v2, p3

    move-wide v3, p4

    move-wide v5, p6

    goto :goto_4

    :cond_a
    iput v0, p1, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    iget v1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    if-ne v1, v4, :cond_c

    iget-object p1, p1, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-ltz p2, :cond_b

    aget-object p2, p1, p2

    invoke-virtual {p2, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_b
    aget-object p1, p1, v0

    invoke-virtual {p1, p4, p5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_c
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->evaluateOverallScreenBrightnessBinLocked()I

    move-result p1

    goto :goto_3

    :goto_4
    invoke-virtual/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->maybeUpdateOverallScreenBrightness(IIJJ)V

    return-void

    :goto_5
    const-string/jumbo p0, "Unexpected note screen brightness for display "

    const-string p2, " (only "

    invoke-static {p1, p0, p2}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object p0

    iget-object p1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length p1, p1

    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string p1, " displays exist...)"

    invoke-virtual {p0, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    const-string p1, "BatteryStatsImpl"

    invoke-static {p1, p0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final noteScreenStateLocked(IIIJIJJ)V
    .locals 22

    move-object/from16 v0, p0

    move/from16 v12, p1

    move/from16 v1, p2

    move/from16 v13, p6

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-static {v12}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v3

    invoke-static {v1}, Landroid/view/Display;->stateToString(I)Ljava/lang/String;

    move-result-object v4

    invoke-static/range {p3 .. p3}, Landroid/view/Display;->stateReasonToString(I)Ljava/lang/String;

    move-result-object v5

    filled-new-array {v3, v4, v5}, [Ljava/lang/Object;

    move-result-object v3

    const-string/jumbo v4, "display=%d state=%s reason=%s"

    invoke-static {v4, v3}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v8

    const/4 v9, -0x1

    const/16 v7, 0x16

    move-wide/from16 v3, p4

    move-wide/from16 v5, p7

    invoke-virtual/range {v2 .. v9}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrBin:I

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    const/4 v14, 0x1

    const/4 v6, 0x2

    const/4 v7, 0x4

    if-le v1, v7, :cond_4

    invoke-static {v1}, Landroid/view/Display;->isOnState(I)Z

    move-result v8

    if-eqz v8, :cond_0

    move v8, v6

    goto :goto_0

    :cond_0
    invoke-static {v1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v8

    if-eqz v8, :cond_2

    invoke-static {v1}, Landroid/view/Display;->isSuspendedState(I)Z

    move-result v1

    if-eqz v1, :cond_1

    move v8, v7

    goto :goto_0

    :cond_1
    const/4 v8, 0x3

    goto :goto_0

    :cond_2
    invoke-static {v1}, Landroid/view/Display;->isOffState(I)Z

    move-result v8

    if-eqz v8, :cond_3

    move v8, v14

    goto :goto_0

    :cond_3
    const-string v8, "BatteryStatsImpl"

    const-string/jumbo v9, "Unknown screen state (not mapped): "

    invoke-static {v1, v9, v8}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V

    const/4 v8, 0x0

    goto :goto_0

    :cond_4
    move v8, v1

    :goto_0
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v9, v9

    if-ltz v12, :cond_41

    if-lt v12, v9, :cond_5

    goto/16 :goto_1e

    :cond_5
    iget v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    if-eq v10, v12, :cond_9

    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTopAppStats:Ljava/util/concurrent/ConcurrentHashMap;

    invoke-virtual {v10}, Ljava/util/concurrent/ConcurrentHashMap;->keySet()Ljava/util/Set;

    move-result-object v10

    invoke-interface {v10}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v10

    :goto_1
    invoke-interface {v10}, Ljava/util/Iterator;->hasNext()Z

    move-result v11

    if-eqz v11, :cond_9

    invoke-interface {v10}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/lang/Integer;

    invoke-virtual {v11}, Ljava/lang/Integer;->intValue()I

    move-result v11

    invoke-virtual {v0, v11}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v11

    iget-object v15, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v15, :cond_6

    iget-object v15, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v15, v15, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v15, v15

    new-array v7, v15, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v7, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const/4 v7, 0x0

    :goto_2
    if-ge v7, v15, :cond_6

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeDisplayTopActivityTimer(I)V

    add-int/lit8 v7, v7, 0x1

    goto :goto_2

    :cond_6
    iget-object v7, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    aget-object v15, v7, v15

    if-eqz v15, :cond_7

    invoke-virtual {v15, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_7
    aget-object v15, v7, v12

    if-nez v15, :cond_8

    invoke-virtual {v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeDisplayTopActivityTimer(I)V

    :cond_8
    aget-object v7, v7, v12

    invoke-virtual {v7, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    const/4 v7, 0x4

    goto :goto_1

    :cond_9
    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v10, v7, v12

    iget v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    if-eq v11, v12, :cond_a

    aget-object v7, v7, v11

    iget v11, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    iput v14, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    iget-object v15, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v15, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v15, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v15, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    const/4 v15, 0x0

    :goto_3
    const/4 v5, 0x5

    if-ge v15, v5, :cond_b

    iget-object v5, v7, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v15

    invoke-virtual {v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopAllRunningLocked(J)V

    add-int/lit8 v15, v15, 0x1

    goto :goto_3

    :cond_a
    iget v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    :cond_b
    if-ne v11, v8, :cond_c

    iget v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    move v15, v1

    const/4 v1, 0x0

    const/4 v9, 0x0

    goto/16 :goto_10

    :cond_c
    iput v8, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    if-eqz v11, :cond_14

    if-eq v11, v14, :cond_f

    if-eq v11, v6, :cond_12

    const/4 v5, 0x3

    if-eq v11, v5, :cond_10

    const/4 v7, 0x4

    if-eq v11, v7, :cond_d

    const-string v15, "BatteryStatsImpl"

    const-string v6, "Attempted to stop timer for unexpected display state "

    invoke-static {v12, v6, v15}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V

    goto :goto_5

    :cond_d
    if-ne v8, v5, :cond_e

    goto :goto_5

    :cond_e
    iget-object v5, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_f
    :goto_4
    move v5, v1

    move v1, v14

    goto :goto_6

    :cond_10
    const/4 v7, 0x4

    if-ne v8, v7, :cond_11

    goto :goto_5

    :cond_11
    iget-object v5, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_4

    :cond_12
    iget-object v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    if-ltz v1, :cond_13

    iget-object v5, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v1, v5, v1

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_13
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->evaluateOverallScreenBrightnessBinLocked()I

    move-result v1

    goto :goto_4

    :cond_14
    :goto_5
    move v5, v1

    const/4 v1, 0x0

    :goto_6
    if-eqz v8, :cond_1e

    if-eq v8, v14, :cond_17

    const/4 v6, 0x2

    if-eq v8, v6, :cond_1a

    const/4 v6, 0x3

    if-eq v8, v6, :cond_18

    const/4 v7, 0x4

    if-eq v8, v7, :cond_15

    const-string v6, "BatteryStatsImpl"

    new-instance v7, Ljava/lang/StringBuilder;

    const-string v10, "Attempted to start timer for unexpected display state "

    invoke-direct {v7, v10}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v10, " for display "

    invoke-virtual {v7, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v7, v12}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v6, v7}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9

    :cond_15
    const/4 v6, 0x3

    if-ne v11, v6, :cond_16

    goto :goto_9

    :cond_16
    iget-object v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_17
    :goto_7
    move v1, v14

    goto :goto_9

    :cond_18
    const/4 v7, 0x4

    if-ne v11, v7, :cond_19

    goto :goto_9

    :cond_19
    iget-object v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_7

    :cond_1a
    iget-object v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenPolicy:I

    if-eq v1, v13, :cond_1c

    if-nez v13, :cond_1b

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    iget v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    aget-object v1, v1, v5

    iget v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    goto :goto_8

    :cond_1b
    const/4 v1, -0x1

    goto :goto_8

    :cond_1c
    iget v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    :goto_8
    if-ltz v1, :cond_1d

    iget-object v5, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v1

    invoke-virtual {v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iput v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessBin:I

    :cond_1d
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->evaluateOverallScreenBrightnessBinLocked()I

    move-result v1

    move v5, v1

    goto :goto_7

    :cond_1e
    :goto_9
    if-eqz v1, :cond_1f

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-eqz v6, :cond_1f

    const/4 v7, 0x0

    invoke-virtual {v6, v7}, Lcom/android/internal/power/EnergyConsumerStats;->isStandardBucketSupported(I)Z

    move-result v6

    if-eqz v6, :cond_1f

    const/16 v6, 0x20

    goto :goto_a

    :cond_1f
    const/4 v6, 0x0

    :goto_a
    const/4 v7, 0x0

    const/4 v10, 0x0

    :goto_b
    if-ge v7, v9, :cond_28

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v11, v11, v7

    iget v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    const/4 v15, 0x2

    if-eq v11, v15, :cond_20

    if-ne v10, v15, :cond_21

    :cond_20
    const/4 v15, 0x4

    goto :goto_e

    :cond_21
    const/4 v15, 0x3

    if-eq v11, v15, :cond_22

    if-ne v10, v15, :cond_23

    :cond_22
    const/4 v15, 0x4

    goto :goto_d

    :cond_23
    const/4 v15, 0x4

    if-eq v11, v15, :cond_26

    if-ne v10, v15, :cond_24

    goto :goto_c

    :cond_24
    if-eq v11, v14, :cond_25

    if-ne v10, v14, :cond_27

    :cond_25
    move v10, v14

    goto :goto_f

    :cond_26
    :goto_c
    move v10, v15

    goto :goto_f

    :goto_d
    const/4 v10, 0x3

    goto :goto_f

    :goto_e
    const/4 v10, 0x2

    :cond_27
    :goto_f
    add-int/lit8 v7, v7, 0x1

    goto :goto_b

    :cond_28
    move v15, v5

    move v9, v6

    move v5, v10

    :goto_10
    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v11, v6, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    iget-boolean v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPretendScreenOff:Z

    if-eqz v6, :cond_29

    move v5, v14

    :cond_29
    iget v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    if-eq v6, v5, :cond_3a

    move-wide/from16 v6, p9

    invoke-virtual {v0, v6, v7, v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsIfNeededLocked(JZ)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    iput v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    if-eqz v5, :cond_2b

    add-int/lit8 v6, v5, -0x1

    and-int/lit8 v7, v6, 0x3

    if-ne v7, v6, :cond_2a

    iget v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    iget v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    and-int/lit8 v16, v14, 0x3

    xor-int v16, v16, v6

    or-int v7, v7, v16

    iput v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    and-int/lit8 v7, v14, -0x4

    or-int/2addr v6, v7

    iput v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    goto :goto_11

    :cond_2a
    const-string v6, "BatteryStatsImpl"

    const-string/jumbo v7, "Unexpected screen state: "

    invoke-static {v5, v7, v6}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)V

    :cond_2b
    :goto_11
    invoke-static {v5}, Landroid/view/Display;->isDozeState(I)Z

    move-result v6

    const/high16 v7, 0x40000

    if-eqz v6, :cond_2c

    invoke-static {v1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v6

    if-nez v6, :cond_2c

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v6, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    const/4 v6, 0x0

    goto :goto_13

    :cond_2c
    invoke-static {v1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v6

    if-eqz v6, :cond_2d

    invoke-static {v5}, Landroid/view/Display;->isDozeState(I)Z

    move-result v6

    if-nez v6, :cond_2d

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v6, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    move v6, v7

    :goto_12
    const/4 v7, 0x0

    goto :goto_13

    :cond_2d
    const/4 v6, 0x0

    goto :goto_12

    :goto_13
    invoke-static {v5}, Landroid/view/Display;->isOnState(I)Z

    move-result v14

    const/high16 v16, 0x100000

    if-eqz v14, :cond_32

    or-int v7, v7, v16

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v14, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    invoke-virtual {v0, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteMainDisplayHighRefreshRateLocked(IJ)V

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    if-lez v2, :cond_2e

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_2e
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v2, :cond_2f

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_2f
    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    if-ltz v2, :cond_31

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v14, v2

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    if-eqz v2, :cond_30

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object v2, v2, v14

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_30
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightness:Z

    if-eqz v2, :cond_31

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_31
    :goto_14
    move/from16 v21, v7

    move v7, v6

    move/from16 v6, v21

    goto :goto_15

    :cond_32
    invoke-static {v1}, Landroid/view/Display;->isOnState(I)Z

    move-result v14

    if-eqz v14, :cond_31

    or-int v6, v6, v16

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v14, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    invoke-virtual {v0, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteMainDisplayHighRefreshRateLocked(IJ)V

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v2, :cond_33

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_33
    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    if-ltz v2, :cond_31

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v14, v2

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAutoBrightnessMode:Z

    if-eqz v2, :cond_34

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessBin:I

    aget-object v2, v2, v14

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_34
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v2

    if-eqz v2, :cond_31

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_14

    :goto_15
    if-nez v6, :cond_35

    if-eqz v7, :cond_36

    :cond_35
    move v2, v1

    goto :goto_16

    :cond_36
    move/from16 p2, v1

    move v14, v5

    goto :goto_17

    :goto_16
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move/from16 p2, v2

    move-wide v2, v3

    move v14, v5

    move-wide/from16 v4, p7

    invoke-virtual/range {v1 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateChangeEvent(JJII)V

    :goto_17
    or-int/lit8 v16, v9, 0x1

    invoke-static {v14}, Landroid/view/Display;->isOnState(I)Z

    move-result v1

    const-wide/16 v17, 0x3e8

    if-eqz v1, :cond_37

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    mul-long v2, p7, v17

    mul-long v4, p4, v17

    move v1, v14

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateTimeBasesLocked(IJJZ)V

    const-string/jumbo v4, "screen"

    const/4 v3, 0x0

    const/4 v5, 0x0

    const/4 v1, -0x1

    const/4 v2, -0x1

    const/4 v6, 0x0

    const/4 v7, 0x0

    move-object/from16 v0, p0

    move/from16 v20, v11

    move/from16 p9, v14

    move/from16 v19, v15

    move v14, v8

    move v15, v10

    move-wide/from16 v8, p4

    move-wide/from16 v10, p7

    invoke-virtual/range {v0 .. v11}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStartWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IZJJ)V

    :goto_18
    move/from16 v1, p9

    goto :goto_19

    :cond_37
    move/from16 v20, v11

    move/from16 p9, v14

    move/from16 v19, v15

    move v14, v8

    move v15, v10

    invoke-static/range {p2 .. p2}, Landroid/view/Display;->isOnState(I)Z

    move-result v0

    if-eqz v0, :cond_38

    const-string/jumbo v4, "screen"

    const-string/jumbo v5, "screen"

    const/4 v2, -0x1

    const/4 v3, 0x0

    const/4 v1, -0x1

    const/4 v6, 0x0

    move-object/from16 v0, p0

    move-wide/from16 v7, p4

    move-wide/from16 v9, p7

    invoke-virtual/range {v0 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IJJ)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    mul-long v2, p7, v17

    mul-long v4, p4, v17

    move/from16 v1, p9

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateTimeBasesLocked(IJJZ)V

    goto :goto_19

    :cond_38
    move-object/from16 v0, p0

    goto :goto_18

    :goto_19
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v2, :cond_39

    move/from16 v2, p2

    invoke-virtual {v0, v2, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateDischargeScreenLevelsLocked(II)V

    :cond_39
    move/from16 v9, v16

    const/4 v7, 0x1

    goto :goto_1a

    :cond_3a
    move v14, v8

    move/from16 v20, v11

    move/from16 v19, v15

    move v15, v10

    move v7, v1

    :goto_1a
    iput v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    iput v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenPolicy:I

    iput v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayId:I

    move-wide/from16 v3, p4

    move-wide/from16 v5, p7

    move v2, v13

    move/from16 v1, v19

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->maybeUpdateOverallScreenBrightness(IIJJ)V

    if-eqz v7, :cond_40

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v7, 0x0

    invoke-virtual {v1, v7}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v1

    if-eqz v1, :cond_3c

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/ScreenPowerStatsCollector;->ensureInitialized$4()Z

    move-result v1

    if-eqz v1, :cond_3b

    iget-object v1, v0, Lcom/android/server/power/stats/ScreenPowerStatsCollector;->mConsumedEnergyHelper:Lcom/android/server/power/stats/PowerStatsCollector$ConsumedEnergyHelper;

    invoke-virtual {v1}, Lcom/android/server/power/stats/PowerStatsCollector$ConsumedEnergyHelper;->getEnergyConsumerCount()I

    move-result v1

    if-eqz v1, :cond_3b

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    return-void

    :cond_3b
    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_3c
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v1, v1

    new-array v2, v1, [I

    const/4 v7, 0x0

    :goto_1b
    if-ge v7, v1, :cond_3d

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v3, v3, v7

    iget v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenState:I

    aput v3, v2, v7

    add-int/lit8 v7, v7, 0x1

    goto :goto_1b

    :cond_3d
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    monitor-enter v1

    :try_start_0
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mHandler:Landroid/os/Handler;

    const/4 v3, 0x1

    invoke-virtual {v0, v3}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v0

    if-eqz v0, :cond_3e

    iget v0, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mUpdateFlags:I

    and-int/2addr v0, v3

    if-nez v0, :cond_3f

    goto :goto_1c

    :catchall_0
    move-exception v0

    goto :goto_1d

    :cond_3e
    :goto_1c
    iput-boolean v15, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mOnBattery:Z

    move/from16 v0, v20

    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mOnBatteryScreenOff:Z

    const/4 v7, 0x0

    iput-boolean v7, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mUseLatestStates:Z

    :cond_3f
    iput-object v2, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mPerDisplayScreenStates:[I

    const-string/jumbo v0, "screen-state"

    invoke-virtual {v1, v9, v0}, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->scheduleSyncLocked(ILjava/lang/String;)V

    monitor-exit v1

    return-void

    :goto_1d
    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :cond_40
    return-void

    :cond_41
    :goto_1e
    const-string v1, "BatteryStatsImpl"

    const-string/jumbo v2, "Unexpected note screen state for display "

    const-string v3, " (only "

    invoke-static {v12, v2, v3}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v0, v0

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v0, " displays exist...)"

    invoke-virtual {v2, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final noteStartGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V
    .locals 8

    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result p1

    :cond_0
    move v6, p1

    invoke-virtual {p0, v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result p1

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    if-nez v0, :cond_2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v5, 0x20000000

    const-string/jumbo v7, "gnss"

    move-wide v1, p3

    move-wide v3, p5

    invoke-virtual/range {v0 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStartEvent(JJIILjava/lang/String;)V

    move-wide p4, v3

    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 p6, 0xa

    invoke-virtual {p3, p6}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result p3

    if-eqz p3, :cond_1

    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    invoke-virtual {p3}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    :cond_1
    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result p3

    if-eqz p3, :cond_3

    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {p3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_0

    :cond_2
    move-wide v1, p3

    move-wide p4, p5

    :cond_3
    :goto_0
    iget p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    const/4 p6, 0x1

    add-int/2addr p3, p6

    iput p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    iget-object p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v0, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v0

    invoke-virtual {p3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/4 p3, 0x6

    if-eqz p2, :cond_4

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getUids()[I

    move-result-object v0

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getTags()[Ljava/lang/String;

    move-result-object p2

    invoke-static {p3, v0, p2, p6}, Lcom/android/internal/util/FrameworkStatsLog;->write(I[I[Ljava/lang/String;I)V

    :goto_1
    move-wide p2, v1

    goto :goto_2

    :cond_4
    const/4 p2, 0x0

    invoke-static {p3, v0, p2, p6}, Lcom/android/internal/util/FrameworkStatsLog;->write_non_chained(IILjava/lang/String;I)V

    goto :goto_1

    :goto_2
    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    move-wide v1, p2

    const/16 p1, -0x2710

    invoke-virtual {p0, p1, p6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getSensorTimerLocked(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    move-result-object p0

    invoke-virtual {p0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->startRunningLocked(J)V

    return-void
.end method

.method public final noteStartWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IZJJ)V
    .locals 22

    move-object/from16 v0, p0

    move/from16 v6, p1

    move/from16 v7, p2

    move/from16 v8, p6

    invoke-virtual/range {p0 .. p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v15

    const/4 v1, 0x1

    if-nez v8, :cond_4

    if-nez p5, :cond_0

    move-object/from16 v14, p4

    goto :goto_0

    :cond_0
    move-object/from16 v14, p5

    :goto_0
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    if-eqz v2, :cond_1

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const v3, 0x8005

    const/4 v4, 0x0

    invoke-virtual {v2, v3, v14, v15, v4}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result v2

    if-eqz v2, :cond_1

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move/from16 v16, v15

    move-object v15, v14

    const v14, 0x8005

    move-wide/from16 v10, p8

    move-wide/from16 v12, p10

    invoke-virtual/range {v9 .. v16}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    move-object v14, v15

    move/from16 v15, v16

    :cond_1
    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    if-nez v2, :cond_2

    xor-int/lit8 v2, p7, 0x1

    iput-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockImportant:Z

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v10, p8

    move-wide/from16 v12, p10

    invoke-virtual/range {v9 .. v15}, Lcom/android/internal/os/BatteryStatsHistory;->recordWakelockStartEvent(JJLjava/lang/String;I)V

    goto :goto_1

    :cond_2
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockImportant:Z

    if-nez v2, :cond_3

    if-nez p7, :cond_3

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v10, p8

    move-wide/from16 v12, p10

    invoke-virtual/range {v9 .. v15}, Lcom/android/internal/os/BatteryStatsHistory;->maybeUpdateWakelockTag(JJLjava/lang/String;I)Z

    move-result v2

    if-eqz v2, :cond_3

    iput-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockImportant:Z

    :cond_3
    :goto_1
    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    add-int/2addr v2, v1

    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    :cond_4
    if-ltz v15, :cond_d

    if-eq v15, v6, :cond_5

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v2, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->retainIsolatedUid(I)V

    :cond_5
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eqz v2, :cond_7

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    monitor-enter v2

    :try_start_0
    new-instance v3, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda0;

    const/4 v4, 0x0

    invoke-direct {v3, v2, v4}, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/power/stats/BatteryExternalStatsWorker;I)V

    iget-object v4, v2, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mHandler:Landroid/os/Handler;

    const/4 v5, 0x2

    invoke-virtual {v4, v5}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v9

    if-eqz v9, :cond_6

    goto :goto_2

    :cond_6
    const-wide/32 v9, 0xea60

    invoke-virtual {v4, v3, v5, v9, v10}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;IJ)Z

    :goto_2
    monitor-exit v2

    :cond_7
    move-wide/from16 v2, p8

    move-wide/from16 v4, p10

    move v9, v1

    move v1, v15

    goto :goto_3

    :catchall_0
    move-exception v0

    monitor-exit v2
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :goto_3
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v12

    invoke-static/range {p4 .. p4}, Lcom/android/server/power/stats/BatteryStatsImpl;->encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v1

    iget-object v4, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWakelockStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    invoke-virtual {v4, v2, v3, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->startObject(JLjava/lang/String;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;

    invoke-virtual {v12, v1, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getWakelockTimerLocked(Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;I)Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move-result-object v1

    invoke-virtual {v1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    if-nez v8, :cond_a

    iget-object v1, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v1, :cond_8

    new-instance v10, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object v1, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v15, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v13, 0x0

    invoke-direct/range {v10 .. v15}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v10, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_8
    iget-object v1, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->startRunningLocked(J)V

    if-ltz v7, :cond_a

    iget-object v1, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPids:Landroid/util/SparseArray;

    invoke-virtual {v1, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/BatteryStats$Uid$Pid;

    if-nez v1, :cond_9

    new-instance v1, Landroid/os/BatteryStats$Uid$Pid;

    invoke-direct {v1, v12}, Landroid/os/BatteryStats$Uid$Pid;-><init>(Landroid/os/BatteryStats$Uid;)V

    iget-object v4, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPids:Landroid/util/SparseArray;

    invoke-virtual {v4, v7, v1}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    :cond_9
    iget v4, v1, Landroid/os/BatteryStats$Uid$Pid;->mWakeNesting:I

    add-int/lit8 v5, v4, 0x1

    iput v5, v1, Landroid/os/BatteryStats$Uid$Pid;->mWakeNesting:I

    if-nez v4, :cond_a

    iput-wide v2, v1, Landroid/os/BatteryStats$Uid$Pid;->mWakeStartMs:J

    :cond_a
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMoveWscLoggingToNotifierEnabled:Z

    if-nez v1, :cond_c

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v2, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v14

    iget v2, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    invoke-static {v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerManagerWakeLockLevel(I)I

    move-result v16

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v20, 0x1

    if-eqz p3, :cond_b

    move/from16 v18, v16

    invoke-virtual/range {p3 .. p3}, Landroid/os/WorkSource$WorkChain;->getUids()[I

    move-result-object v16

    invoke-virtual/range {p3 .. p3}, Landroid/os/WorkSource$WorkChain;->getTags()[Ljava/lang/String;

    move-result-object v17

    const/16 v15, 0xa

    move-object/from16 v19, p4

    move/from16 v21, v2

    invoke-static/range {v15 .. v21}, Lcom/android/internal/util/FrameworkStatsLog;->write(I[I[Ljava/lang/String;ILjava/lang/String;II)V

    goto :goto_4

    :cond_b
    move/from16 v21, v2

    move/from16 v18, v16

    const/16 v13, 0xa

    const/4 v15, 0x0

    move-object/from16 v17, p4

    move/from16 v18, v20

    move/from16 v19, v21

    invoke-static/range {v13 .. v19}, Lcom/android/internal/util/FrameworkStatsLog;->write_non_chained(IILjava/lang/String;ILjava/lang/String;II)V

    :cond_c
    :goto_4
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerManagerFlags:Lcom/android/server/power/feature/PowerManagerFlags;

    iget-object v1, v1, Lcom/android/server/power/feature/PowerManagerFlags;->mFrameworkWakelockInfo:Lcom/android/server/power/feature/PowerManagerFlags$FlagState;

    invoke-virtual {v1}, Lcom/android/server/power/feature/PowerManagerFlags$FlagState;->isEnabled()Z

    move-result v1

    if-eqz v1, :cond_d

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkEvents:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v0, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v0

    invoke-static {v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerManagerWakeLockLevel(I)I

    move-result v2

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    new-instance v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;

    move-object/from16 v4, p4

    invoke-direct {v3, v0, v4, v2}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;-><init>(ILjava/lang/String;I)V

    iget-object v2, v1, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mLock:Ljava/lang/Object;

    monitor-enter v2

    :try_start_1
    iget-object v0, v1, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mOpenWakeLocks:Ljava/util/Map;

    new-instance v4, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$$ExternalSyntheticLambda3;

    move-wide/from16 v12, p10

    invoke-direct {v4, v12, v13}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$$ExternalSyntheticLambda3;-><init>(J)V

    check-cast v0, Ljava/util/HashMap;

    invoke-virtual {v0, v3, v4}, Ljava/util/HashMap;->computeIfAbsent(Ljava/lang/Object;Ljava/util/function/Function;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;

    iget v4, v0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;->refCount:I

    add-int/2addr v4, v9

    iput v4, v0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;->refCount:I

    iget-object v1, v1, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mOpenWakeLocks:Ljava/util/Map;

    check-cast v1, Ljava/util/HashMap;

    invoke-virtual {v1, v3, v0}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    monitor-exit v2

    return-void

    :catchall_1
    move-exception v0

    monitor-exit v2
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0

    :cond_d
    return-void
.end method

.method public final noteStopGpsLocked(ILandroid/os/WorkSource$WorkChain;JJ)V
    .locals 10

    if-eqz p2, :cond_0

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    move v7, v1

    goto :goto_0

    :cond_0
    move v7, p1

    :goto_0
    invoke-virtual {p0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v9

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    add-int/lit8 v1, v1, -0x1

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsNesting:I

    if-nez v1, :cond_2

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x20000000

    const-string/jumbo v8, "gnss"

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v1 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStopEvent(JJIILjava/lang/String;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/4 v6, 0x2

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordGpsSignalQualityEvent(JJI)V

    invoke-virtual {p0, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl;->stopAllGpsSignalQualityTimersLocked(J)V

    const/4 v1, -0x1

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityBin:I

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 v4, 0xa

    invoke-virtual {v1, v4}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v1

    if-eqz v1, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    invoke-virtual {v1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_2
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v4

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/4 v6, 0x0

    const/4 v1, 0x6

    if-eqz p2, :cond_3

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getUids()[I

    move-result-object v4

    invoke-virtual {p2}, Landroid/os/WorkSource$WorkChain;->getTags()[Ljava/lang/String;

    move-result-object v5

    invoke-static {v1, v4, v5, v6}, Lcom/android/internal/util/FrameworkStatsLog;->write(I[I[Ljava/lang/String;I)V

    :goto_1
    move-object v0, p0

    move-wide v2, p3

    move-wide v4, p5

    move v1, v9

    goto :goto_2

    :cond_3
    const/4 v5, 0x0

    invoke-static {v1, v4, v5, v6}, Lcom/android/internal/util/FrameworkStatsLog;->write_non_chained(IILjava/lang/String;I)V

    goto :goto_1

    :goto_2
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v0

    const/16 v1, -0x2710

    invoke-virtual {v0, v1, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getSensorTimerLocked(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    move-result-object v0

    if-eqz v0, :cond_4

    invoke-virtual {v0, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_4
    return-void
.end method

.method public final noteStopTxPowerSharingLocked()V
    .locals 4

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingOn:Z

    if-eqz v2, :cond_1

    const/4 v2, 0x0

    iput-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingOn:Z

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v3, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    const-string v0, "/sys/class/power_supply/battery/wc_tx_total_pwr"

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getIntFromFile(Ljava/lang/String;)I

    move-result v0

    if-gez v0, :cond_0

    goto :goto_0

    :cond_0
    move v2, v0

    :goto_0
    int-to-long v0, v2

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    add-long/2addr v2, v0

    iput-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    :cond_1
    return-void
.end method

.method public final noteStopWakeLocked(IILandroid/os/WorkSource$WorkChain;Ljava/lang/String;Ljava/lang/String;IJJ)V
    .locals 23

    move-object/from16 v0, p0

    move/from16 v6, p1

    move/from16 v7, p2

    move/from16 v14, p6

    invoke-virtual/range {p0 .. p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    const/4 v8, 0x1

    if-nez v14, :cond_2

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    sub-int/2addr v2, v8

    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    if-nez p5, :cond_0

    move-object/from16 v2, p4

    goto :goto_0

    :cond_0
    move-object/from16 v2, p5

    :goto_0
    iget-boolean v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    if-eqz v3, :cond_1

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const/16 v4, 0x4005

    const/4 v5, 0x0

    invoke-virtual {v3, v4, v2, v1, v5}, Landroid/os/BatteryStats$HistoryEventTracker;->updateState(ILjava/lang/String;II)Z

    move-result v3

    if-eqz v3, :cond_1

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v20, 0x4005

    move-wide/from16 v16, p7

    move-wide/from16 v18, p9

    move/from16 v22, v1

    move-object/from16 v21, v2

    invoke-virtual/range {v15 .. v22}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    move-object/from16 v20, v21

    move/from16 v21, v22

    goto :goto_1

    :cond_1
    move/from16 v21, v1

    move-object/from16 v20, v2

    :goto_1
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockNesting:I

    if-nez v1, :cond_3

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v16, p7

    move-wide/from16 v18, p9

    invoke-virtual/range {v15 .. v21}, Lcom/android/internal/os/BatteryStatsHistory;->recordWakelockStopEvent(JJLjava/lang/String;I)V

    goto :goto_2

    :cond_2
    move/from16 v21, v1

    :cond_3
    :goto_2
    if-ltz v21, :cond_f

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eqz v1, :cond_5

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    monitor-enter v1

    :try_start_0
    new-instance v2, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda0;

    const/4 v3, 0x0

    invoke-direct {v2, v1, v3}, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/power/stats/BatteryExternalStatsWorker;I)V

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mHandler:Landroid/os/Handler;

    const/4 v4, 0x2

    invoke-virtual {v3, v4}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v5

    if-eqz v5, :cond_4

    goto :goto_3

    :cond_4
    const-wide/32 v9, 0xea60

    invoke-virtual {v3, v2, v4, v9, v10}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;IJ)Z

    :goto_3
    monitor-exit v1

    :cond_5
    move-wide/from16 v2, p7

    move-wide/from16 v4, p9

    move/from16 v1, v21

    goto :goto_4

    :catchall_0
    move-exception v0

    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :goto_4
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v9

    invoke-static/range {p4 .. p4}, Lcom/android/server/power/stats/BatteryStatsImpl;->encodingPersonalInformation(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v4

    iget-object v5, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWakelockStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    invoke-virtual {v5, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->stopObject(JLjava/lang/String;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;

    if-eqz v4, :cond_6

    invoke-virtual {v9, v4, v14}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getWakelockTimerLocked(Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;I)Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move-result-object v4

    invoke-virtual {v4, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_6
    if-nez v14, :cond_8

    iget-object v4, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v4, :cond_7

    invoke-virtual {v4, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->stopRunningLocked(J)V

    :cond_7
    if-ltz v7, :cond_8

    iget-object v4, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPids:Landroid/util/SparseArray;

    invoke-virtual {v4, v7}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Landroid/os/BatteryStats$Uid$Pid;

    if-eqz v4, :cond_8

    iget v5, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeNesting:I

    if-lez v5, :cond_8

    add-int/lit8 v7, v5, -0x1

    iput v7, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeNesting:I

    if-ne v5, v8, :cond_8

    iget-wide v10, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeSumMs:J

    iget-wide v12, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeStartMs:J

    sub-long/2addr v2, v12

    add-long/2addr v2, v10

    iput-wide v2, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeSumMs:J

    const-wide/16 v2, 0x0

    iput-wide v2, v4, Landroid/os/BatteryStats$Uid$Pid;->mWakeStartMs:J

    :cond_8
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMoveWscLoggingToNotifierEnabled:Z

    if-nez v2, :cond_a

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v3, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v3

    iget v13, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    invoke-static {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerManagerWakeLockLevel(I)I

    move-result v10

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/4 v12, 0x0

    if-eqz p3, :cond_9

    move v2, v8

    invoke-virtual/range {p3 .. p3}, Landroid/os/WorkSource$WorkChain;->getUids()[I

    move-result-object v8

    invoke-virtual/range {p3 .. p3}, Landroid/os/WorkSource$WorkChain;->getTags()[Ljava/lang/String;

    move-result-object v9

    const/16 v7, 0xa

    move-object/from16 v11, p4

    invoke-static/range {v7 .. v13}, Lcom/android/internal/util/FrameworkStatsLog;->write(I[I[Ljava/lang/String;ILjava/lang/String;II)V

    goto :goto_5

    :cond_9
    move v2, v8

    const/16 v7, 0xa

    const/4 v9, 0x0

    move-object/from16 v11, p4

    move v8, v3

    invoke-static/range {v7 .. v13}, Lcom/android/internal/util/FrameworkStatsLog;->write_non_chained(IILjava/lang/String;ILjava/lang/String;II)V

    goto :goto_5

    :cond_a
    move-object/from16 v11, p4

    move v2, v8

    :goto_5
    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerManagerFlags:Lcom/android/server/power/feature/PowerManagerFlags;

    iget-object v3, v3, Lcom/android/server/power/feature/PowerManagerFlags;->mFrameworkWakelockInfo:Lcom/android/server/power/feature/PowerManagerFlags$FlagState;

    invoke-virtual {v3}, Lcom/android/server/power/feature/PowerManagerFlags$FlagState;->isEnabled()Z

    move-result v3

    if-eqz v3, :cond_e

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkEvents:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v4, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->mapUid(I)I

    move-result v4

    invoke-static {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getPowerManagerWakeLockLevel(I)I

    move-result v5

    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const-string/jumbo v7, "WakeLock not found when stopping: "

    new-instance v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;

    invoke-direct {v8, v4, v11, v5}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;-><init>(ILjava/lang/String;I)V

    iget-object v5, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mLock:Ljava/lang/Object;

    monitor-enter v5

    :try_start_1
    iget-object v9, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mOpenWakeLocks:Ljava/util/Map;

    check-cast v9, Ljava/util/HashMap;

    invoke-virtual {v9, v8}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;

    if-nez v9, :cond_b

    const-string v2, "BatteryStatsPulledMetrics"

    new-instance v3, Ljava/lang/StringBuilder;

    invoke-direct {v3, v7}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v4, " "

    invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3, v11}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v3}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v3

    invoke-static {v2, v3}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    monitor-exit v5

    goto/16 :goto_8

    :catchall_1
    move-exception v0

    goto/16 :goto_7

    :cond_b
    iget v4, v9, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;->refCount:I

    if-ne v4, v2, :cond_d

    iget-object v4, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mOpenWakeLocks:Ljava/util/Map;

    check-cast v4, Ljava/util/HashMap;

    invoke-virtual {v4, v8}, Ljava/util/HashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    iget-wide v9, v9, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;->acquireUptimeMillis:J

    sub-long v9, p9, v9

    invoke-virtual {v3}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->inOverflow()Z

    move-result v4

    if-eqz v4, :cond_c

    iget-object v4, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mWakeLockStats:Ljava/util/Map;

    check-cast v4, Ljava/util/HashMap;

    invoke-virtual {v4, v8}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_c

    const-string v4, "*overflow*"

    iput-object v4, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->tag:Ljava/lang/String;

    iput v2, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->powerManagerWakeLockLevel:I

    iget v2, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->uid:I

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v2

    iget-object v4, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->tag:Ljava/lang/String;

    iget v7, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->powerManagerWakeLockLevel:I

    invoke-static {v7}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v7

    filled-new-array {v2, v4, v7}, [Ljava/lang/Object;

    move-result-object v2

    invoke-static {v2}, Ljava/util/Objects;->hash([Ljava/lang/Object;)I

    move-result v2

    iput v2, v8, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->hashCode:I

    invoke-virtual {v3}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->inHardCap()Z

    move-result v2

    if-eqz v2, :cond_c

    iget-object v2, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mWakeLockStats:Ljava/util/Map;

    check-cast v2, Ljava/util/HashMap;

    invoke-virtual {v2, v8}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v2

    if-nez v2, :cond_c

    invoke-virtual {v8}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockKey;->setHardCap()V

    :cond_c
    iget-object v2, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mWakeLockStats:Ljava/util/Map;

    new-instance v4, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$$ExternalSyntheticLambda0;

    const/4 v7, 0x3

    invoke-direct {v4, v7}, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$$ExternalSyntheticLambda0;-><init>(I)V

    check-cast v2, Ljava/util/HashMap;

    invoke-virtual {v2, v8, v4}, Ljava/util/HashMap;->computeIfAbsent(Ljava/lang/Object;Ljava/util/function/Function;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockStats;

    iget-wide v11, v2, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockStats;->uptimeMillis:J

    add-long/2addr v11, v9

    iput-wide v11, v2, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockStats;->uptimeMillis:J

    iget-wide v9, v2, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockStats;->completedCount:J

    const-wide/16 v11, 0x1

    add-long/2addr v9, v11

    iput-wide v9, v2, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockStats;->completedCount:J

    iget-object v3, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mWakeLockStats:Ljava/util/Map;

    check-cast v3, Ljava/util/HashMap;

    invoke-virtual {v3, v8, v2}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    goto :goto_6

    :cond_d
    sub-int/2addr v4, v2

    iput v4, v9, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$WakeLockData;->refCount:I

    iget-object v2, v3, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mOpenWakeLocks:Ljava/util/Map;

    check-cast v2, Ljava/util/HashMap;

    invoke-virtual {v2, v8, v9}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :goto_6
    monitor-exit v5

    goto :goto_8

    :goto_7
    monitor-exit v5
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0

    :cond_e
    :goto_8
    if-eq v1, v6, :cond_f

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    invoke-virtual {v0, v6}, Lcom/android/server/power/stats/PowerStatsUidResolver;->releaseIsolatedUid(I)V

    :cond_f
    return-void
.end method

.method public final noteUidProcessStateLocked(IIJJ)V
    .locals 18

    move/from16 v0, p1

    invoke-virtual/range {p0 .. p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    if-eq v0, v1, :cond_0

    invoke-static {v0}, Landroid/os/Process;->isIsolated(I)Z

    move-result v2

    if-eqz v2, :cond_0

    goto/16 :goto_7

    :cond_0
    move-object/from16 v2, p0

    iget-object v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v3}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v3, 0x1b

    invoke-static/range {p2 .. p2}, Landroid/app/ActivityManager;->processStateAmToProto(I)I

    move-result v4

    invoke-static {v3, v0, v4}, Lcom/android/internal/util/FrameworkStatsLog;->write(III)V

    move-wide/from16 v4, p5

    move-object v0, v2

    move-wide/from16 v2, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v7

    invoke-static/range {p2 .. p2}, Landroid/app/ActivityManager;->isForegroundService(I)Z

    move-result v11

    invoke-static/range {p2 .. p2}, Landroid/os/BatteryStats;->mapToInternalProcessState(I)I

    move-result v6

    iget v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    if-ne v0, v6, :cond_1

    iget-boolean v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mInForegroundService:Z

    if-ne v11, v1, :cond_1

    goto/16 :goto_7

    :cond_1
    if-eq v0, v6, :cond_15

    iget-object v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v1, v1

    const/4 v8, 0x0

    const/4 v1, 0x7

    if-eq v0, v1, :cond_2

    iget-object v4, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v4, v0

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, v8

    if-eqz v0, :cond_2

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTopAppStats:Ljava/util/concurrent/ConcurrentHashMap;

    iget v4, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-static {v4}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    invoke-virtual {v0, v4}, Ljava/util/concurrent/ConcurrentHashMap;->remove(Ljava/lang/Object;)Ljava/lang/Object;

    :cond_2
    if-eq v6, v1, :cond_5

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, v6

    if-nez v0, :cond_3

    invoke-virtual {v7, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeProcessState(I)V

    :cond_3
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, v6

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    if-nez v6, :cond_5

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, v8

    if-nez v0, :cond_4

    invoke-virtual {v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeDisplayTopActivityTimer(I)V

    :cond_4
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v0, v0, v8

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTopAppStats:Ljava/util/concurrent/ConcurrentHashMap;

    iget v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-static {v1}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v1

    invoke-static {v8}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    invoke-virtual {v0, v1, v4}, Ljava/util/concurrent/ConcurrentHashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_5
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v9, 0x1

    invoke-virtual {v0, v9}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-nez v0, :cond_6

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->isFastCpuTimesReader()Z

    move-result v0

    if-eqz v0, :cond_6

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    move-wide/from16 v4, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateProcStateCpuTimesLocked(IJJ)V

    invoke-virtual {v7, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v7, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v0, v6, v2, v3}, Lcom/android/internal/os/LongArrayMultiStateCounter;->setState(IJ)V

    invoke-virtual {v1, v6, v2, v3}, Lcom/android/internal/os/LongArrayMultiStateCounter;->setState(IJ)V

    :cond_6
    iget v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    invoke-static {v0}, Landroid/os/BatteryStats;->mapUidProcessStateToBatteryConsumerProcessState(I)I

    move-result v10

    iput v6, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    const-wide/16 v0, 0x3e8

    mul-long v13, p5, v0

    mul-long v15, v2, v0

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    const/4 v1, 0x3

    if-eqz v0, :cond_7

    if-lt v6, v1, :cond_7

    move/from16 v17, v9

    goto :goto_0

    :cond_7
    move/from16 v17, v8

    :goto_0
    iget-object v12, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual/range {v12 .. v17}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eqz v0, :cond_8

    iget v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    if-lt v0, v1, :cond_8

    move/from16 v17, v9

    goto :goto_1

    :cond_8
    move/from16 v17, v8

    :goto_1
    iget-object v12, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual/range {v12 .. v17}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    invoke-static {v6}, Landroid/os/BatteryStats;->mapUidProcessStateToBatteryConsumerProcessState(I)I

    move-result v6

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemReady:Z

    if-eqz v4, :cond_9

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget v5, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    move v8, v1

    move-wide v1, v2

    move-wide/from16 v3, p5

    invoke-virtual/range {v0 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordProcessStateChange(JJII)V

    move-wide v2, v1

    goto :goto_2

    :cond_9
    move v8, v1

    :goto_2
    invoke-virtual {v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getCpuActiveTimeCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v0

    invoke-static {v0, v6, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$msetState(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;IJ)V

    invoke-virtual {v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getMobileRadioActiveTimeCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v0

    invoke-static {v0, v6, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$msetState(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;IJ)V

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    if-eqz v0, :cond_a

    invoke-static {v0, v6, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$msetState(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;IJ)V

    :cond_a
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    if-eqz v0, :cond_b

    invoke-static {v0, v6, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$msetState(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;IJ)V

    :cond_b
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v0, :cond_c

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    if-eqz v0, :cond_c

    new-instance v0, Lcom/android/internal/power/EnergyConsumerStats;

    iget-object v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-direct {v0, v1}, Lcom/android/internal/power/EnergyConsumerStats;-><init>(Lcom/android/internal/power/EnergyConsumerStats$Config;)V

    iput-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    :cond_c
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-eqz v0, :cond_d

    invoke-virtual {v0, v6, v2, v3}, Lcom/android/internal/power/EnergyConsumerStats;->setState(IJ)V

    :cond_d
    if-ne v10, v6, :cond_e

    goto :goto_5

    :cond_e
    const/4 v0, 0x2

    if-nez v10, :cond_f

    if-eq v6, v0, :cond_15

    :cond_f
    if-ne v10, v0, :cond_10

    if-nez v6, :cond_10

    goto :goto_5

    :cond_10
    iget-object v1, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerState:I

    if-eq v4, v0, :cond_12

    if-ne v4, v8, :cond_11

    goto :goto_3

    :cond_11
    const/16 v0, 0xa

    goto :goto_4

    :cond_12
    :goto_3
    const/16 v0, 0xe

    :goto_4
    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-wide v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PROC_STATE_CHANGE_COLLECTION_DELAY_MS:J

    monitor-enter v4

    :try_start_0
    new-instance v1, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda3;

    const/4 v8, 0x2

    invoke-direct {v1, v4, v0, v8}, Lcom/android/server/power/stats/BatteryExternalStatsWorker$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/power/stats/BatteryExternalStatsWorker;II)V

    iget-object v0, v4, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mHandler:Landroid/os/Handler;

    const/4 v8, 0x4

    invoke-virtual {v0, v8}, Landroid/os/Handler;->hasMessages(I)Z

    move-result v9

    if-eqz v9, :cond_13

    const-wide/16 v9, 0x0

    cmp-long v9, v5, v9

    if-nez v9, :cond_14

    invoke-virtual {v0, v8}, Landroid/os/Handler;->removeMessages(I)V

    :cond_13
    invoke-virtual {v0, v1, v8, v5, v6}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;IJ)Z

    :cond_14
    monitor-exit v4

    goto :goto_5

    :catchall_0
    move-exception v0

    monitor-exit v4
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0

    :cond_15
    :goto_5
    iget-boolean v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mInForegroundService:Z

    if-eq v11, v0, :cond_19

    if-eqz v11, :cond_17

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v0, :cond_16

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/4 v10, 0x0

    const/4 v8, 0x0

    invoke-direct/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    iput-object v5, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_16
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_6

    :cond_17
    iget-object v0, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v0, :cond_18

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_18
    :goto_6
    iput-boolean v11, v7, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mInForegroundService:Z

    :cond_19
    :goto_7
    return-void
.end method

.method public final noteUsbConnectionStateLocked(JJZ)V
    .locals 6

    if-eqz p5, :cond_0

    const/4 v0, 0x2

    goto :goto_0

    :cond_0
    const/4 v0, 0x1

    :goto_0
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUsbDataState:I

    if-eq v1, v0, :cond_2

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUsbDataState:I

    if-eqz p5, :cond_1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 p5, 0x40000

    invoke-virtual/range {p0 .. p5}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V

    return-void

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v5, 0x40000

    move-wide v1, p1

    move-wide v3, p3

    invoke-virtual/range {v0 .. v5}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    :cond_2
    return-void
.end method

.method public final noteUserActivityLocked(IIJJ)V
    .locals 7

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v0, :cond_0

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v2

    move-object v1, p0

    move-wide v3, p3

    move-wide v5, p5

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteUserActivityLocked(I)V

    :cond_0
    return-void
.end method

.method public final noteWakeupReasonLocked(JJLjava/lang/String;)V
    .locals 13

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupReason:Ljava/lang/String;

    if-eqz v0, :cond_1

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupUptimeMs:J

    sub-long v1, p3, v1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v3, v0}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v3, :cond_0

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v3, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v4, v0, v3}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_0
    move-object v5, v3

    const-wide/16 v3, 0x3e8

    mul-long/2addr v1, v3

    iget-wide v3, v5, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mCurrentReportedTotalTimeUs:J

    add-long v6, v3, v1

    iget v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mCurrentReportedCount:I

    add-int/lit8 v10, v0, 0x1

    const-wide/16 v8, 0x0

    move-wide v11, p1

    invoke-virtual/range {v5 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupReason:Ljava/lang/String;

    iget-wide v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupElapsedTimeMs:J

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v6, 0x24

    move-wide v8, v1

    invoke-static/range {v6 .. v11}, Lcom/android/internal/util/FrameworkStatsLog;->write(ILjava/lang/String;JJ)V

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v1, p1

    move-wide/from16 v3, p3

    move-object/from16 v5, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/internal/os/BatteryStatsHistory;->recordWakeupEvent(JJLjava/lang/String;)V

    iput-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupReason:Ljava/lang/String;

    iput-wide v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupUptimeMs:J

    iput-wide p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWakeupElapsedTimeMs:J

    return-void
.end method

.method public final noteWakupAlarmLocked(Ljava/lang/String;ILandroid/os/WorkSource;Ljava/lang/String;JJ)V
    .locals 9

    if-eqz p3, :cond_4

    const/4 p2, 0x0

    move v0, p2

    :goto_0
    invoke-virtual {p3}, Landroid/os/WorkSource;->size()I

    move-result v1

    if-ge v0, v1, :cond_2

    invoke-virtual {p3, v0}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p3, v0}, Landroid/os/WorkSource;->getPackageName(I)Ljava/lang/String;

    move-result-object v2

    iget-boolean v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v3, :cond_1

    if-eqz v2, :cond_0

    goto :goto_1

    :cond_0
    move-object v2, p1

    :goto_1
    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v4

    move-object v3, p0

    move-wide v5, p5

    move-wide/from16 v7, p7

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getPackageStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    move-result-object v1

    invoke-virtual {v1, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->noteWakeupAlarmLocked(Ljava/lang/String;)V

    :cond_1
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_2
    invoke-virtual {p3}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object p3

    if-eqz p3, :cond_5

    :goto_2
    invoke-interface {p3}, Ljava/util/List;->size()I

    move-result v0

    if-ge p2, v0, :cond_5

    invoke-interface {p3, p2}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v0}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v0

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v1, :cond_3

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v4

    move-object v3, p0

    move-wide v5, p5

    move-wide/from16 v7, p7

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v0

    invoke-virtual {v0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getPackageStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    move-result-object v0

    invoke-virtual {v0, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->noteWakeupAlarmLocked(Ljava/lang/String;)V

    :cond_3
    add-int/lit8 p2, p2, 0x1

    goto :goto_2

    :cond_4
    iget-boolean p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz p3, :cond_5

    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v4

    move-object v3, p0

    move-wide v5, p5

    move-wide/from16 v7, p7

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getPackageStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    move-result-object p0

    invoke-virtual {p0, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->noteWakeupAlarmLocked(Ljava/lang/String;)V

    :cond_5
    return-void
.end method

.method public final noteWifiRadioPowerState(IIJJJ)V
    .locals 11

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiRadioPowerState:I

    if-eq v1, p1, :cond_4

    const/4 v1, 0x2

    if-eq p1, v1, :cond_1

    const/4 v1, 0x3

    if-ne p1, v1, :cond_0

    goto :goto_0

    :cond_0
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v7, 0x4000000

    move-wide/from16 v3, p5

    move-wide/from16 v5, p7

    invoke-virtual/range {v2 .. v7}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStopEvent(JJI)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const-wide/32 v1, 0xf4240

    div-long v1, p3, v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_1

    :cond_1
    :goto_0
    if-lez p2, :cond_3

    invoke-virtual {p0, p2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v10

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v8, 0x13

    const-string v9, ""

    move-wide/from16 v4, p5

    move-wide/from16 v6, p7

    invoke-virtual/range {v3 .. v10}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    move-object v3, p0

    move-wide v7, v6

    move-wide v5, v4

    move v4, v10

    invoke-virtual/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v0

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v2, :cond_2

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :cond_2
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const-wide/16 v2, 0x1

    invoke-virtual {v0, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_3
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v8, 0x4000000

    move-wide/from16 v4, p5

    move-wide/from16 v6, p7

    invoke-virtual/range {v3 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStartEvent(JJI)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :goto_1
    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiRadioPowerState:I

    :cond_4
    return-void
.end method

.method public final noteWifiRssiChangedLocked(IJJ)V
    .locals 7

    const/4 v0, 0x5

    invoke-static {p1, v0}, Landroid/net/wifi/WifiManager;->calculateSignalLevel(II)I

    move-result v6

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthBin:I

    if-eq p1, v6, :cond_6

    if-ltz p1, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, v1, p1

    invoke-virtual {p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_0
    if-ltz v6, :cond_2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v6

    invoke-virtual {p1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result p1

    if-nez p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v6

    invoke-virtual {p1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordWifiSignalStrengthChangeEvent(JJI)V

    goto :goto_3

    :cond_2
    move-wide v2, p2

    const/4 p1, 0x0

    :goto_0
    if-ge p1, v0, :cond_5

    const/4 p2, -0x1

    if-ne p1, p2, :cond_3

    goto :goto_2

    :cond_3
    :goto_1
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p2, p2, p1

    invoke-virtual {p2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result p2

    if-eqz p2, :cond_4

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p2, p2, p1

    invoke-virtual {p2, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_1

    :cond_4
    :goto_2
    add-int/lit8 p1, p1, 0x1

    goto :goto_0

    :cond_5
    :goto_3
    iput v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthBin:I

    :cond_6
    return-void
.end method

.method public final noteWifiRunningChangedLocked(Landroid/os/WorkSource;Landroid/os/WorkSource;JJ)V
    .locals 9

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    if-eqz v1, :cond_4

    invoke-virtual {p1}, Landroid/os/WorkSource;->size()I

    move-result v6

    const/4 v7, 0x0

    move v8, v7

    :goto_0
    if-ge v8, v6, :cond_0

    invoke-virtual {p1, v8}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiStoppedLocked(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_0

    :cond_0
    invoke-virtual {p1}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object v6

    if-eqz v6, :cond_1

    move v8, v7

    :goto_1
    invoke-interface {v6}, Ljava/util/List;->size()I

    move-result v1

    if-ge v8, v1, :cond_1

    invoke-interface {v6, v8}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiStoppedLocked(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_1

    :cond_1
    invoke-virtual {p2}, Landroid/os/WorkSource;->size()I

    move-result v6

    move v8, v7

    :goto_2
    if-ge v8, v6, :cond_2

    invoke-virtual {p2, v8}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiRunningLocked(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_2

    :cond_2
    invoke-virtual {p2}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object v6

    if-eqz v6, :cond_3

    :goto_3
    invoke-interface {v6}, Ljava/util/List;->size()I

    move-result v1

    if-ge v7, v1, :cond_3

    invoke-interface {v6, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p3

    move-wide v4, p5

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p3, p4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiRunningLocked(J)V

    add-int/lit8 v7, v7, 0x1

    goto :goto_3

    :cond_3
    return-void

    :cond_4
    const-string v0, "BatteryStatsImpl"

    const-string/jumbo v1, "noteWifiRunningChangedLocked -- called while WIFI not running"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final noteWifiRunningLocked(Landroid/os/WorkSource;JJ)V
    .locals 9

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    if-nez v1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x20000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V

    const/4 v1, 0x1

    iput-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    invoke-virtual {p1}, Landroid/os/WorkSource;->size()I

    move-result v6

    const/4 v7, 0x0

    move v8, v7

    :goto_0
    if-ge v8, v6, :cond_0

    invoke-virtual {p1, v8}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiRunningLocked(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_0

    :cond_0
    invoke-virtual {p1}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object v6

    if-eqz v6, :cond_1

    :goto_1
    invoke-interface {v6}, Ljava/util/List;->size()I

    move-result v1

    if-ge v7, v1, :cond_1

    invoke-interface {v6, v7}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiRunningLocked(J)V

    add-int/lit8 v7, v7, 0x1

    goto :goto_1

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    iget-boolean v2, v1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    if-eqz v2, :cond_2

    invoke-virtual {v1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_2
    const-string/jumbo v1, "wifi-running"

    const/4 v2, 0x2

    invoke-virtual {p0, v2, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    return-void

    :cond_3
    const-string v0, "BatteryStatsImpl"

    const-string/jumbo v1, "noteWifiRunningLocked -- called while WIFI running"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final noteWifiScanStartedLocked(IJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    if-nez v0, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x8000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStartEvent(JJI)V

    :cond_0
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    add-int/lit8 v0, v0, 0x1

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiScanStartedLocked(J)V

    return-void
.end method

.method public final noteWifiScanStoppedLocked(IJJ)V
    .locals 7

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    add-int/lit8 v0, v0, -0x1

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiScanNesting:I

    if-nez v0, :cond_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x8000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordStateStopEvent(JJI)V

    :cond_0
    invoke-virtual/range {p0 .. p5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p0

    invoke-virtual {p0, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiScanStoppedLocked(J)V

    return-void
.end method

.method public final noteWifiStoppedLocked(Landroid/os/WorkSource;JJ)V
    .locals 9

    iget-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    if-eqz v1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v6, 0x20000000

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StopEvent(JJI)V

    const/4 v6, 0x0

    iput-boolean v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    invoke-virtual {p1}, Landroid/os/WorkSource;->size()I

    move-result v7

    move v8, v6

    :goto_0
    if-ge v8, v7, :cond_0

    invoke-virtual {p1, v8}, Landroid/os/WorkSource;->getUid(I)I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiStoppedLocked(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_0

    :cond_0
    invoke-virtual {p1}, Landroid/os/WorkSource;->getWorkChains()Ljava/util/List;

    move-result-object v7

    if-eqz v7, :cond_1

    :goto_1
    invoke-interface {v7}, Ljava/util/List;->size()I

    move-result v1

    if-ge v6, v1, :cond_1

    invoke-interface {v7, v6}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/os/WorkSource$WorkChain;

    invoke-virtual {v1}, Landroid/os/WorkSource$WorkChain;->getAttributionUid()I

    move-result v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-object v0, p0

    move-wide v2, p2

    move-wide v4, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteWifiStoppedLocked(J)V

    add-int/lit8 v6, v6, 0x1

    goto :goto_1

    :cond_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    iget-boolean v2, v1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    if-eqz v2, :cond_2

    invoke-virtual {v1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_2
    const-string/jumbo v1, "wifi-stopped"

    const/4 v2, 0x2

    invoke-virtual {p0, v2, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleSyncExternalStatsLocked(ILjava/lang/String;)V

    return-void

    :cond_3
    const-string v0, "BatteryStatsImpl"

    const-string/jumbo v1, "noteWifiStoppedLocked -- called while WIFI not running"

    invoke-static {v0, v1}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final notifyNetworkStatsUpdatedCallbacksLocked(Landroid/net/NetworkStats;)V
    .locals 9

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

    invoke-virtual {v0}, Landroid/os/RemoteCallbackList;->beginBroadcast()I

    move-result v0

    const/4 v1, 0x0

    :goto_0
    if-ge v1, v0, :cond_1

    :try_start_0
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

    invoke-virtual {v2, v1}, Landroid/os/RemoteCallbackList;->getBroadcastItem(I)Landroid/os/IInterface;

    move-result-object v2

    move-object v8, v2

    check-cast v8, Lcom/android/internal/app/IBatteryStatsCallback;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v6

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda15;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    move-object v4, p0

    move-object v5, p1

    :try_start_1
    invoke-direct/range {v3 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda15;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/net/NetworkStats;JLcom/android/internal/app/IBatteryStatsCallback;)V

    invoke-virtual {v2, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    move-result p0

    if-nez p0, :cond_0

    const-string p0, "BatteryStatsImpl"

    const-string p1, "Callback failed to queue"

    invoke-static {p0, p1}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    goto :goto_1

    :catchall_0
    move-exception v0

    goto :goto_2

    :cond_0
    :goto_1
    add-int/lit8 v1, v1, 0x1

    move-object p0, v4

    move-object p1, v5

    goto :goto_0

    :catchall_1
    move-exception v0

    move-object v4, p0

    :goto_2
    move-object p0, v0

    iget-object p1, v4, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

    invoke-virtual {p1}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    throw p0

    :cond_1
    move-object v4, p0

    iget-object p0, v4, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsCallbacks:Landroid/os/RemoteCallbackList;

    invoke-virtual {p0}, Landroid/os/RemoteCallbackList;->finishBroadcast()V

    return-void
.end method

.method public final onCleanupUserLocked(IJ)V
    .locals 7

    const/4 v0, 0x0

    invoke-static {p1, v0}, Landroid/os/UserHandle;->getUid(II)I

    move-result v3

    const v0, 0x1869f

    invoke-static {p1, v0}, Landroid/os/UserHandle;->getUid(II)I

    move-result v4

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;

    move-object v2, p0

    move-wide v5, p2

    invoke-direct/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;IIJ)V

    invoke-interface {p1, v1}, Ljava/util/Queue;->add(Ljava/lang/Object;)Z

    return-void
.end method

.method public final onSystemReady(Landroid/content/Context;)V
    .locals 11

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    if-eqz v0, :cond_0

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->onSystemReady()V

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const-class v1, Landroid/power/PowerStatsInternal;

    invoke-static {v1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/power/PowerStatsInternal;

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mPowerStatsInternal:Landroid/power/PowerStatsInternal;

    const/4 v3, 0x0

    if-eqz v2, :cond_3

    check-cast v2, Lcom/android/server/powerstats/PowerStatsService$LocalService;

    iget-object v2, v2, Lcom/android/server/powerstats/PowerStatsService$LocalService;->this$0:Lcom/android/server/powerstats/PowerStatsService;

    invoke-virtual {v2}, Lcom/android/server/powerstats/PowerStatsService;->getPowerStatsHal()Lcom/android/server/powerstats/PowerStatsHALWrapper$IPowerStatsHALWrapper;

    move-result-object v2

    invoke-interface {v2}, Lcom/android/server/powerstats/PowerStatsHALWrapper$IPowerStatsHALWrapper;->getPowerEntityInfo()[Landroid/hardware/power/stats/PowerEntity;

    move-result-object v2

    if-nez v2, :cond_1

    goto :goto_2

    :cond_1
    array-length v4, v2

    move v5, v3

    :goto_0
    if-ge v5, v4, :cond_3

    aget-object v6, v2, v5

    new-instance v7, Ljava/util/HashMap;

    invoke-direct {v7}, Ljava/util/HashMap;-><init>()V

    move v8, v3

    :goto_1
    iget-object v9, v6, Landroid/hardware/power/stats/PowerEntity;->states:[Landroid/hardware/power/stats/State;

    array-length v10, v9

    if-ge v8, v10, :cond_2

    aget-object v9, v9, v8

    iget v10, v9, Landroid/hardware/power/stats/State;->id:I

    invoke-static {v10}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v10

    iget-object v9, v9, Landroid/hardware/power/stats/State;->name:Ljava/lang/String;

    invoke-virtual {v7, v10, v9}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    add-int/lit8 v8, v8, 0x1

    goto :goto_1

    :cond_2
    iget-object v8, v0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mEntityNames:Ljava/util/Map;

    iget v9, v6, Landroid/hardware/power/stats/PowerEntity;->id:I

    invoke-static {v9}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v9

    iget-object v10, v6, Landroid/hardware/power/stats/PowerEntity;->name:Ljava/lang/String;

    check-cast v8, Ljava/util/HashMap;

    invoke-virtual {v8, v9, v10}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mStateNames:Ljava/util/Map;

    iget v6, v6, Landroid/hardware/power/stats/PowerEntity;->id:I

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v6

    check-cast v8, Ljava/util/HashMap;

    invoke-virtual {v8, v6, v7}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    add-int/lit8 v5, v5, 0x1

    goto :goto_0

    :cond_3
    :goto_2
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {p1}, Landroid/content/Context;->getPackageManager()Landroid/content/pm/PackageManager;

    move-result-object v2

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mPackageManager:Landroid/content/pm/PackageManager;

    new-instance v2, Lcom/android/server/power/stats/PowerStatsCollector$ConsumedEnergyRetrieverImpl;

    invoke-static {v1}, Lcom/android/server/LocalServices;->getService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/power/PowerStatsInternal;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector$$ExternalSyntheticLambda2;

    invoke-direct {v4, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;)V

    invoke-direct {v2, v1, v4}, Lcom/android/server/power/stats/PowerStatsCollector$ConsumedEnergyRetrieverImpl;-><init>(Landroid/power/PowerStatsInternal;Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector$$ExternalSyntheticLambda2;)V

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mConsumedEnergyRetriever:Lcom/android/server/power/stats/PowerStatsCollector$ConsumedEnergyRetrieverImpl;

    const-class v1, Landroid/app/usage/NetworkStatsManager;

    invoke-virtual {p1, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/app/usage/NetworkStatsManager;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mNetworkStatsManager:Landroid/app/usage/NetworkStatsManager;

    const-string/jumbo v1, "phone"

    invoke-virtual {p1, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/telephony/TelephonyManager;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mTelephonyManager:Landroid/telephony/TelephonyManager;

    const-string/jumbo v1, "wifi"

    invoke-virtual {p1, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/net/wifi/WifiManager;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mWifiManager:Landroid/net/wifi/WifiManager;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothStatsRetrieverImpl;

    const-class v2, Landroid/bluetooth/BluetoothManager;

    invoke-virtual {p1, v2}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/bluetooth/BluetoothManager;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->this$0:Lcom/android/server/power/stats/BatteryStatsImpl;

    invoke-direct {v1, v2, p1}, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothStatsRetrieverImpl;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/bluetooth/BluetoothManager;)V

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mBluetoothStatsRetriever:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothStatsRetrieverImpl;

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 v2, 0xc

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    invoke-virtual {v0, v3}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 v2, 0x8

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-eqz v0, :cond_5

    iget-object v0, p1, Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;->mInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mPackageManager:Landroid/content/pm/PackageManager;

    if-eqz v0, :cond_4

    const-string/jumbo v2, "android.hardware.telephony"

    invoke-virtual {v0, v2}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_4

    move v0, v1

    goto :goto_3

    :cond_4
    move v0, v3

    :goto_3
    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    goto :goto_4

    :cond_5
    iput-boolean v3, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    :goto_4
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 v2, 0xb

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-eqz v0, :cond_7

    iget-object v0, p1, Lcom/android/server/power/stats/WifiPowerStatsCollector;->mInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mPackageManager:Landroid/content/pm/PackageManager;

    if-eqz v0, :cond_6

    const-string/jumbo v2, "android.hardware.wifi"

    invoke-virtual {v0, v2}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_6

    move v0, v1

    goto :goto_5

    :cond_6
    move v0, v3

    :goto_5
    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    goto :goto_6

    :cond_7
    iput-boolean v3, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    :goto_6
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v2, 0x2

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-eqz v0, :cond_9

    iget-object v0, p1, Lcom/android/server/power/stats/BluetoothPowerStatsCollector;->mInjector:Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$PowerStatsCollectorInjector;->mPackageManager:Landroid/content/pm/PackageManager;

    if-eqz v0, :cond_8

    const-string/jumbo v2, "android.hardware.bluetooth"

    invoke-virtual {v0, v2}, Landroid/content/pm/PackageManager;->hasSystemFeature(Ljava/lang/String;)Z

    move-result v0

    if-eqz v0, :cond_8

    move v3, v1

    :cond_8
    iput-boolean v3, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    goto :goto_7

    :cond_9
    iput-boolean v3, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    :goto_7
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v2, 0x3

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/16 v2, 0xa

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v2, -0x1

    invoke-virtual {v0, v2}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    iput-boolean v0, p1, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    invoke-virtual {p1}, Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;->schedule()Z

    iput-boolean v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemReady:Z

    return-void
.end method

.method public final prepareForDumpLocked()V
    .locals 0

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->pullPendingStateUpdatesLocked()V

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getStartClockTime()J

    return-void
.end method

.method public final pullPendingStateUpdatesLocked()V
    .locals 1

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v0, :cond_0

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-virtual {p0, v0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateDischargeScreenLevelsLocked(II)V

    :cond_0
    return-void
.end method

.method public final readDailyItemTagLocked(Lcom/android/modules/utils/TypedXmlPullParser;)V
    .locals 13

    new-instance v0, Landroid/os/BatteryStats$DailyItem;

    invoke-direct {v0}, Landroid/os/BatteryStats$DailyItem;-><init>()V

    const/4 v1, 0x0

    const-string/jumbo v2, "start"

    const-wide/16 v3, 0x0

    invoke-interface {p1, v1, v2, v3, v4}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeLong(Ljava/lang/String;Ljava/lang/String;J)J

    move-result-wide v5

    iput-wide v5, v0, Landroid/os/BatteryStats$DailyItem;->mStartTime:J

    const-string/jumbo v2, "end"

    invoke-interface {p1, v1, v2, v3, v4}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeLong(Ljava/lang/String;Ljava/lang/String;J)J

    move-result-wide v5

    iput-wide v5, v0, Landroid/os/BatteryStats$DailyItem;->mEndTime:J

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result v2

    :cond_0
    :goto_0
    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->next()I

    move-result v5

    const/4 v6, 0x1

    if-eq v5, v6, :cond_b

    const/4 v7, 0x3

    if-ne v5, v7, :cond_1

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result v8

    if-le v8, v2, :cond_b

    :cond_1
    if-eq v5, v7, :cond_0

    const/4 v7, 0x4

    if-ne v5, v7, :cond_2

    goto :goto_0

    :cond_2
    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v5

    const-string/jumbo v7, "dis"

    invoke-virtual {v5, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    const/4 v9, 0x0

    if-eqz v8, :cond_3

    invoke-static {p1, v0, v9, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->readDailyItemTagDetailsLocked(Lcom/android/modules/utils/TypedXmlPullParser;Landroid/os/BatteryStats$DailyItem;ZLjava/lang/String;)V

    goto :goto_0

    :cond_3
    const-string/jumbo v7, "chg"

    invoke-virtual {v5, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v8

    if-eqz v8, :cond_4

    invoke-static {p1, v0, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->readDailyItemTagDetailsLocked(Lcom/android/modules/utils/TypedXmlPullParser;Landroid/os/BatteryStats$DailyItem;ZLjava/lang/String;)V

    goto :goto_0

    :cond_4
    const-string/jumbo v7, "upd"

    invoke-virtual {v5, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    const-string/jumbo v8, "NULL"

    const-string/jumbo v10, "There was an issue while reading the package name from internal storage."

    const-string/jumbo v11, "pkg"

    const-string v12, "BatteryStatsImpl"

    if-eqz v7, :cond_7

    iget-object v5, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    if-nez v5, :cond_5

    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    iput-object v5, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    :cond_5
    new-instance v5, Landroid/os/BatteryStats$PackageChange;

    invoke-direct {v5}, Landroid/os/BatteryStats$PackageChange;-><init>()V

    iput-boolean v6, v5, Landroid/os/BatteryStats$PackageChange;->mUpdate:Z

    invoke-interface {p1, v1, v11}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeValue(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    if-nez v6, :cond_6

    invoke-static {v12, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_1

    :cond_6
    move-object v8, v6

    :goto_1
    iput-object v8, v5, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    const-string/jumbo v6, "ver"

    invoke-interface {p1, v1, v6, v3, v4}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeLong(Ljava/lang/String;Ljava/lang/String;J)J

    move-result-wide v6

    iput-wide v6, v5, Landroid/os/BatteryStats$PackageChange;->mVersionCode:J

    iget-object v6, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    invoke-static {p1}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    goto :goto_0

    :cond_7
    const-string/jumbo v6, "rem"

    invoke-virtual {v5, v6}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v5

    if-eqz v5, :cond_a

    iget-object v5, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    if-nez v5, :cond_8

    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    iput-object v5, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    :cond_8
    new-instance v5, Landroid/os/BatteryStats$PackageChange;

    invoke-direct {v5}, Landroid/os/BatteryStats$PackageChange;-><init>()V

    iput-boolean v9, v5, Landroid/os/BatteryStats$PackageChange;->mUpdate:Z

    invoke-interface {p1, v1, v11}, Lcom/android/modules/utils/TypedXmlPullParser;->getAttributeValue(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v6

    if-nez v6, :cond_9

    invoke-static {v12, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_2

    :cond_9
    move-object v8, v6

    :goto_2
    iput-object v8, v5, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    iget-object v6, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v6, v5}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    invoke-static {p1}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    goto/16 :goto_0

    :cond_a
    new-instance v5, Ljava/lang/StringBuilder;

    const-string/jumbo v6, "Unknown element under <item>: "

    invoke-direct {v5, v6}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v6

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    invoke-static {v12, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    invoke-static {p1}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    goto/16 :goto_0

    :cond_b
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {p0, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    return-void
.end method

.method public final readDailyItemsLocked(Lcom/android/modules/utils/TypedXmlPullParser;)V
    .locals 7

    const-string v0, "Failed parsing daily "

    const-string v1, "BatteryStatsImpl"

    :goto_0
    :try_start_0
    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->next()I

    move-result v2

    const/4 v3, 0x1

    const/4 v4, 0x2

    if-eq v2, v4, :cond_0

    if-eq v2, v3, :cond_0

    goto :goto_0

    :cond_0
    if-ne v2, v4, :cond_5

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result v2

    :cond_1
    :goto_1
    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->next()I

    move-result v4

    if-eq v4, v3, :cond_6

    const/4 v5, 0x3

    if-ne v4, v5, :cond_2

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getDepth()I

    move-result v6

    if-le v6, v2, :cond_6

    goto :goto_2

    :catch_0
    move-exception p0

    goto :goto_3

    :catch_1
    move-exception p0

    goto :goto_4

    :catch_2
    move-exception p0

    goto :goto_5

    :catch_3
    move-exception p0

    goto :goto_6

    :catch_4
    move-exception p0

    goto/16 :goto_7

    :catch_5
    move-exception p0

    goto/16 :goto_8

    :cond_2
    :goto_2
    if-eq v4, v5, :cond_1

    const/4 v5, 0x4

    if-ne v4, v5, :cond_3

    goto :goto_1

    :cond_3
    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v4

    const-string/jumbo v5, "item"

    invoke-virtual {v4, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v4

    if-eqz v4, :cond_4

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->readDailyItemTagLocked(Lcom/android/modules/utils/TypedXmlPullParser;)V

    goto :goto_1

    :cond_4
    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string/jumbo v5, "Unknown element under <daily-items>: "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlPullParser;->getName()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-static {v1, v4}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    invoke-static {p1}, Lcom/android/internal/util/XmlUtils;->skipCurrentTag(Lorg/xmlpull/v1/XmlPullParser;)V

    goto :goto_1

    :cond_5
    new-instance p0, Ljava/lang/IllegalStateException;

    const-string/jumbo p1, "no start tag found"

    invoke-direct {p0, p1}, Ljava/lang/IllegalStateException;-><init>(Ljava/lang/String;)V

    throw p0
    :try_end_0
    .catch Ljava/lang/IllegalStateException; {:try_start_0 .. :try_end_0} :catch_5
    .catch Ljava/lang/NullPointerException; {:try_start_0 .. :try_end_0} :catch_4
    .catch Ljava/lang/NumberFormatException; {:try_start_0 .. :try_end_0} :catch_3
    .catch Lorg/xmlpull/v1/XmlPullParserException; {:try_start_0 .. :try_end_0} :catch_2
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_1
    .catch Ljava/lang/IndexOutOfBoundsException; {:try_start_0 .. :try_end_0} :catch_0

    :goto_3
    new-instance p1, Ljava/lang/StringBuilder;

    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9

    :goto_4
    invoke-static {v0, p0, v1}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/io/IOException;Ljava/lang/String;)V

    goto :goto_9

    :goto_5
    new-instance p1, Ljava/lang/StringBuilder;

    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9

    :goto_6
    new-instance p1, Ljava/lang/StringBuilder;

    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9

    :goto_7
    new-instance p1, Ljava/lang/StringBuilder;

    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_9

    :goto_8
    new-instance p1, Ljava/lang/StringBuilder;

    invoke-direct {p1, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p1, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {p1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_6
    :goto_9
    return-void
.end method

.method public final readDailyStatsLocked()V
    .locals 2

    new-instance v0, Ljava/lang/StringBuilder;

    const-string/jumbo v1, "Reading daily items from "

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyFile:Landroid/util/AtomicFile;

    invoke-virtual {v1}, Landroid/util/AtomicFile;->getBaseFile()Ljava/io/File;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "BatteryStatsImpl"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->clear()V

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyFile:Landroid/util/AtomicFile;

    invoke-virtual {v0}, Landroid/util/AtomicFile;->openRead()Ljava/io/FileInputStream;

    move-result-object v0
    :try_end_0
    .catch Ljava/io/FileNotFoundException; {:try_start_0 .. :try_end_0} :catch_2

    :try_start_1
    invoke-static {v0}, Landroid/util/Xml;->resolvePullParser(Ljava/io/InputStream;)Lcom/android/modules/utils/TypedXmlPullParser;

    move-result-object v1

    invoke-virtual {p0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->readDailyItemsLocked(Lcom/android/modules/utils/TypedXmlPullParser;)V
    :try_end_1
    .catch Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    :try_start_2
    invoke-virtual {v0}, Ljava/io/FileInputStream;->close()V
    :try_end_2
    .catch Ljava/io/IOException; {:try_start_2 .. :try_end_2} :catch_2

    return-void

    :catchall_0
    move-exception p0

    :try_start_3
    invoke-virtual {v0}, Ljava/io/FileInputStream;->close()V
    :try_end_3
    .catch Ljava/io/IOException; {:try_start_3 .. :try_end_3} :catch_0

    :catch_0
    throw p0

    :catch_1
    :try_start_4
    invoke-virtual {v0}, Ljava/io/FileInputStream;->close()V
    :try_end_4
    .catch Ljava/io/IOException; {:try_start_4 .. :try_end_4} :catch_2

    :catch_2
    return-void
.end method

.method public readKernelUidCpuActiveTimesLocked(Z)V
    .locals 6

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda1;

    move-object v1, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;JJ)V

    invoke-virtual {p1, v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;->readAbsolute(Lcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide p0

    sub-long/2addr p0, v4

    const-wide/16 v0, 0x64

    cmp-long v0, p0, v0

    if-ltz v0, :cond_0

    new-instance v0, Ljava/lang/StringBuilder;

    const-string/jumbo v1, "Reading cpu active times took "

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v0, p0, p1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo p0, "ms"

    invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    const-string p1, "BatteryStatsImpl"

    invoke-static {p1, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    :cond_0
    return-void
.end method

.method public readKernelUidCpuClusterTimesLocked(ZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V
    .locals 10

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v3

    if-eqz p2, :cond_0

    const/4 v0, 0x1

    goto :goto_0

    :cond_0
    const/4 v0, 0x0

    :goto_0
    iget-object v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda3;

    move-object v2, p0

    move v7, p1

    move-object v8, p2

    invoke-direct/range {v1 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda3;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;JJZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V

    invoke-virtual {v9, v0, v1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object p0, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide p0

    sub-long/2addr p0, v5

    const-wide/16 v0, 0x64

    cmp-long p2, p0, v0

    if-ltz p2, :cond_1

    new-instance p2, Ljava/lang/StringBuilder;

    const-string/jumbo v0, "Reading cpu cluster times took "

    invoke-direct {p2, v0}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {p2, p0, p1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo p0, "ms"

    invoke-virtual {p2, p0}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {p2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p0

    const-string p1, "BatteryStatsImpl"

    invoke-static {p1, p0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    :cond_1
    return-void
.end method

.method public readKernelUidCpuFreqTimesLocked(Ljava/util/ArrayList;ZZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V
    .locals 18
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/ArrayList<",
            "Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;",
            ">;ZZ",
            "Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;",
            ")V"
        }
    .end annotation

    move-object/from16 v1, p0

    move-object/from16 v13, p1

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->perClusterTimesAvailable()Z

    move-result v8

    if-nez v13, :cond_0

    const/4 v10, 0x0

    goto :goto_0

    :cond_0
    invoke-virtual {v13}, Ljava/util/ArrayList;->size()I

    move-result v0

    move v10, v0

    :goto_0
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v0}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v11

    array-length v9, v11

    const/4 v0, 0x0

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockAllocationsUs:[[J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    if-eqz p4, :cond_1

    const/4 v0, 0x1

    move v15, v0

    goto :goto_1

    :cond_1
    const/4 v15, 0x0

    :goto_1
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    move-object v6, v0

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda2;

    move/from16 v7, p3

    move-object/from16 v12, p4

    move-object v14, v6

    move/from16 v6, p2

    invoke-direct/range {v0 .. v12}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;JJZZZII[ILcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V

    invoke-virtual {v14, v15, v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v2

    sub-long/2addr v2, v4

    const-wide/16 v4, 0x64

    cmp-long v0, v2, v4

    if-ltz v0, :cond_2

    new-instance v0, Ljava/lang/StringBuilder;

    const-string/jumbo v4, "Reading cpu freq times took "

    invoke-direct {v0, v4}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v0, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo v2, "ms"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "BatteryStatsImpl"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    :cond_2
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockAllocationsUs:[[J

    if-eqz v0, :cond_b

    const/4 v0, 0x0

    :goto_2
    if-ge v0, v10, :cond_b

    invoke-virtual {v13, v0}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-eqz v2, :cond_3

    array-length v4, v2

    if-eq v4, v9, :cond_4

    :cond_3
    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([[Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    new-array v2, v9, [[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :cond_4
    const/4 v4, 0x0

    :goto_3
    if-ge v4, v9, :cond_a

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    aget v5, v11, v4

    invoke-virtual {v2, v5}, Lcom/android/internal/os/CpuScalingPolicies;->getFrequencies(I)[I

    move-result-object v2

    array-length v8, v2

    iget-object v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v4

    if-eqz v2, :cond_5

    array-length v5, v2

    if-eq v5, v8, :cond_6

    :cond_5
    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-array v5, v8, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aput-object v5, v2, v4

    :cond_6
    iget-object v2, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v12, v2, v4

    const/4 v5, 0x0

    :goto_4
    if-ge v5, v8, :cond_9

    aget-object v2, v12, v5

    if-nez v2, :cond_7

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v2, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v2, v12, v5

    :cond_7
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockAllocationsUs:[[J

    aget-object v2, v2, v4

    aget-wide v6, v2, v5

    sub-int v2, v10, v0

    int-to-long v14, v2

    div-long/2addr v6, v14

    aget-object v2, v12, v5

    move/from16 v14, p2

    invoke-virtual {v2, v6, v7, v14}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(JZ)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeLockAllocationsUs:[[J

    aget-object v2, v2, v4

    aget-wide v16, v2, v5

    sub-long v16, v16, v6

    aput-wide v16, v2, v5

    if-eqz p4, :cond_8

    const-wide/16 v16, 0x3e8

    div-long v6, v6, v16

    move-object/from16 v2, p4

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->addCpuClusterSpeedDurationsMs(Lcom/android/server/power/stats/BatteryStatsImpl$Uid;IIJ)V

    :cond_8
    add-int/lit8 v5, v5, 0x1

    goto :goto_4

    :cond_9
    move/from16 v14, p2

    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    :cond_a
    move/from16 v14, p2

    add-int/lit8 v0, v0, 0x1

    goto :goto_2

    :cond_b
    return-void
.end method

.method public readKernelUidCpuTimesLocked(Ljava/util/ArrayList;Landroid/util/SparseLongArray;Z)V
    .locals 18
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/ArrayList<",
            "Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;",
            ">;",
            "Landroid/util/SparseLongArray;",
            "Z)V"
        }
    .end annotation

    move-object/from16 v1, p0

    move-object/from16 v9, p1

    const-wide/16 v10, 0x0

    iput-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    iput-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    const/4 v12, 0x0

    if-nez v9, :cond_0

    move v6, v12

    goto :goto_0

    :cond_0
    invoke-virtual {v9}, Ljava/util/ArrayList;->size()I

    move-result v0

    move v6, v0

    :goto_0
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    iget-object v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda4;

    move-object/from16 v8, p2

    move/from16 v7, p3

    invoke-direct/range {v0 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda4;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;JJIZLandroid/util/SparseLongArray;)V

    invoke-virtual {v13, v12, v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v2

    sub-long/2addr v2, v4

    const-wide/16 v4, 0x64

    cmp-long v0, v2, v4

    if-ltz v0, :cond_1

    new-instance v0, Ljava/lang/StringBuilder;

    const-string/jumbo v13, "Reading cpu stats took "

    invoke-direct {v0, v13}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v0, v2, v3}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo v2, "ms"

    invoke-virtual {v0, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v2, "BatteryStatsImpl"

    invoke-static {v2, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    :cond_1
    if-lez v6, :cond_4

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    const-wide/16 v13, 0x32

    mul-long/2addr v2, v13

    div-long/2addr v2, v4

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    mul-long/2addr v2, v13

    div-long/2addr v2, v4

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    :goto_1
    if-ge v12, v6, :cond_4

    invoke-virtual {v9, v12}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    sub-int v4, v6, v12

    int-to-long v4, v4

    div-long/2addr v2, v4

    long-to-int v2, v2

    iget-wide v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    div-long/2addr v13, v4

    long-to-int v3, v13

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    int-to-long v13, v2

    invoke-virtual {v4, v13, v14, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(JZ)V

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    int-to-long v10, v3

    invoke-virtual {v4, v10, v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(JZ)V

    if-eqz v8, :cond_2

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    move/from16 v17, v6

    const-wide/16 v5, 0x0

    invoke-virtual {v8, v4, v5, v6}, Landroid/util/SparseLongArray;->get(IJ)J

    move-result-wide v15

    add-long/2addr v15, v13

    add-long v5, v15, v10

    invoke-virtual {v8, v4, v5, v6}, Landroid/util/SparseLongArray;->put(IJ)V

    goto :goto_2

    :cond_2
    move/from16 v17, v6

    :goto_2
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    const-string v4, "*wakelock*"

    invoke-virtual {v0, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getProcessStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;

    move-result-object v0

    div-int/lit16 v2, v2, 0x3e8

    div-int/lit16 v3, v3, 0x3e8

    if-eqz v7, :cond_3

    iget-wide v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mUserTimeMs:J

    move-wide v15, v4

    int-to-long v4, v2

    add-long/2addr v4, v15

    iput-wide v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mUserTimeMs:J

    iget-wide v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mSystemTimeMs:J

    int-to-long v2, v3

    add-long/2addr v4, v2

    iput-wide v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mSystemTimeMs:J

    :cond_3
    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    sub-long/2addr v2, v13

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuUserTimeUs:J

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    sub-long/2addr v2, v10

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTempTotalCpuSystemTimeUs:J

    add-int/lit8 v12, v12, 0x1

    move/from16 v6, v17

    const-wide/16 v10, 0x0

    goto :goto_1

    :cond_4
    return-void
.end method

.method public final readLocked()V
    .locals 14

    const-string v1, "BatteryStatsImpl"

    const/4 v2, 0x0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    if-nez v0, :cond_0

    new-instance v0, Ljava/io/File;

    const-string/jumbo v3, "data/system"

    invoke-direct {v0, v3}, Ljava/io/File;-><init>(Ljava/lang/String;)V

    iput-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    goto :goto_0

    :catch_0
    move-exception v0

    move v6, v2

    goto/16 :goto_3

    :cond_0
    :goto_0
    new-instance v0, Ljava/io/File;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    const-string v4, "BCheck0"

    invoke-direct {v0, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v0}, Ljava/io/File;->exists()Z

    move-result v3
    :try_end_0
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0

    const-string v4, "BCheck"

    if-nez v3, :cond_1

    :try_start_1
    const-string/jumbo v3, "create %s%d (%b) / path=%s"

    invoke-static {v2}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v5

    invoke-virtual {v0}, Ljava/io/File;->createNewFile()Z

    move-result v6

    invoke-static {v6}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v6

    invoke-virtual {v0}, Ljava/io/File;->getAbsolutePath()Ljava/lang/String;

    move-result-object v0

    filled-new-array {v4, v5, v6, v0}, [Ljava/lang/Object;

    move-result-object v0

    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    move v6, v2

    goto :goto_4

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-virtual {v0}, Ljava/io/File;->list()[Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/util/Objects;->requireNonNull(Ljava/lang/Object;)Ljava/lang/Object;

    array-length v3, v0
    :try_end_1
    .catch Ljava/lang/Exception; {:try_start_1 .. :try_end_1} :catch_0

    move v5, v2

    move v6, v5

    :goto_1
    if-ge v5, v3, :cond_3

    :try_start_2
    aget-object v7, v0, v5

    invoke-virtual {v7, v4}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v8

    if-eqz v8, :cond_2

    const-string/jumbo v8, "[^\\d]"

    const-string v9, ""

    invoke-virtual {v7, v8, v9}, Ljava/lang/String;->replaceAll(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v7

    invoke-static {v7}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I

    move-result v7

    if-ge v6, v7, :cond_2

    move v6, v7

    goto :goto_2

    :catch_1
    move-exception v0

    goto :goto_3

    :cond_2
    :goto_2
    add-int/lit8 v5, v5, 0x1

    goto :goto_1

    :cond_3
    new-instance v0, Ljava/io/File;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    invoke-virtual {v5, v4}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    add-int/lit8 v6, v6, 0x1

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-direct {v0, v3, v4}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    const-string/jumbo v3, "Repeating abnormal reboot :: %d times (%b)"

    invoke-static {v6}, Ljava/lang/Integer;->valueOf(I)Ljava/lang/Integer;

    move-result-object v4

    invoke-virtual {v0}, Ljava/io/File;->createNewFile()Z

    move-result v0

    invoke-static {v0}, Ljava/lang/Boolean;->valueOf(Z)Ljava/lang/Boolean;

    move-result-object v0

    filled-new-array {v4, v0}, [Ljava/lang/Object;

    move-result-object v0

    invoke-static {v3, v0}, Ljava/lang/String;->format(Ljava/lang/String;[Ljava/lang/Object;)Ljava/lang/String;

    move-result-object v0

    invoke-static {v1, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_2
    .catch Ljava/lang/Exception; {:try_start_2 .. :try_end_2} :catch_1

    goto :goto_4

    :goto_3
    const-string/jumbo v3, "Something was wrong while checking the abnormal state"

    invoke-static {v1, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    :goto_4
    const/4 v0, 0x2

    if-le v6, v0, :cond_4

    const-string/jumbo v0, "Was reboot continuously"

    invoke-static {v1, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;)I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v6

    const/4 v3, 0x1

    move-object v2, p0

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    move-object v8, v2

    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->reset()V

    return-void

    :cond_4
    move-object v8, p0

    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyFile:Landroid/util/AtomicFile;

    if-eqz p0, :cond_5

    invoke-virtual {v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->readDailyStatsLocked()V

    :cond_5
    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    if-nez p0, :cond_6

    const-string/jumbo p0, "readLocked: no file associated with this instance"

    invoke-static {v1, p0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void

    :cond_6
    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p0}, Landroid/util/SparseArray;->clear()V

    invoke-static {}, Landroid/os/Parcel;->obtain()Landroid/os/Parcel;

    move-result-object p0

    :try_start_3
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    iget-object v0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    invoke-virtual {v0}, Landroid/util/AtomicFile;->exists()Z

    move-result v0

    if-eqz v0, :cond_7

    iget-object v0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    invoke-virtual {v0}, Landroid/util/AtomicFile;->readFully()[B

    move-result-object v0

    array-length v3, v0

    invoke-virtual {p0, v0, v2, v3}, Landroid/os/Parcel;->unmarshall([BII)V

    invoke-virtual {p0, v2}, Landroid/os/Parcel;->setDataPosition(I)V

    invoke-virtual {v8, p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V
    :try_end_3
    .catch Ljava/lang/Exception; {:try_start_3 .. :try_end_3} :catch_3
    .catch Ljava/lang/OutOfMemoryError; {:try_start_3 .. :try_end_3} :catch_2
    .catchall {:try_start_3 .. :try_end_3} :catchall_0

    goto :goto_5

    :catchall_0
    move-exception v0

    goto :goto_9

    :catch_2
    move-exception v0

    goto :goto_6

    :catch_3
    move-exception v0

    goto :goto_7

    :cond_7
    :goto_5
    invoke-virtual {p0}, Landroid/os/Parcel;->recycle()V

    goto :goto_8

    :goto_6
    :try_start_4
    const-string v3, "Abnormal mStatsFile"

    invoke-static {v1, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v12

    const/4 v9, 0x1

    invoke-virtual/range {v8 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    goto :goto_5

    :goto_7
    const-string v3, "Error reading battery statistics"

    invoke-static {v1, v3, v0}, Landroid/util/Slog;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v12

    const/4 v9, 0x1

    invoke-virtual/range {v8 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    goto :goto_5

    :goto_8
    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->readSummary()Z

    move-result p0

    if-nez p0, :cond_8

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v10

    invoke-static {}, Landroid/os/SystemClock;->elapsedRealtime()J

    move-result-wide v12

    const/4 v9, 0x1

    invoke-virtual/range {v8 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    :cond_8
    sget-object p0, Landroid/os/Build;->ID:Ljava/lang/String;

    iput-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mEndPlatformVersion:Ljava/lang/String;

    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->continueRecordingHistory()V

    iget-object p0, v8, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p0}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v0

    invoke-virtual {v8, v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsIfNeededLocked(JZ)V

    return-void

    :goto_9
    invoke-virtual {p0}, Landroid/os/Parcel;->recycle()V

    throw v0
.end method

.method public readMobileNetworkStatsLocked(Landroid/app/usage/NetworkStatsManager;)Landroid/net/NetworkStats;
    .locals 0

    invoke-virtual {p1}, Landroid/app/usage/NetworkStatsManager;->getMobileUidStats()Landroid/net/NetworkStats;

    move-result-object p0

    return-object p0
.end method

.method public final readSummaryFromParcel(Landroid/os/Parcel;)V
    .locals 26

    move-object/from16 v1, p0

    move-object/from16 v7, p1

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    const v2, 0x1000d7

    if-eq v0, v2, :cond_0

    const-string/jumbo v1, "readFromParcel: version got "

    const-string v2, ", expected 1048791; erasing old stats"

    const-string v3, "BatteryStats"

    invoke-static {v0, v1, v2, v3}, Lcom/android/server/accessibility/BrailleDisplayConnection$$ExternalSyntheticOutline0;->m(ILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)V

    return-void

    :cond_0
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0, v7}, Lcom/android/internal/os/BatteryStatsHistory;->readSummaryFromParcel(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUptimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mRealtimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicStartTime:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v0

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartPlatformVersion:Ljava/lang/String;

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v0

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEndPlatformVersion:Ljava/lang/String;

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeUs:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLowDischargeAmountSinceCharge:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHighDischargeAmountSinceCharge:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceCharge:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceCharge:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceCharge:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenOnSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenDozeSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargeCoulombCounter:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargeCoulombCounter:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0, v7}, Landroid/os/BatteryStats$LevelStepTracker;->readFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0, v7}, Landroid/os/BatteryStats$LevelStepTracker;->readFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0, v7}, Landroid/os/BatteryStats$LevelStepTracker;->readFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0, v7}, Landroid/os/BatteryStats$LevelStepTracker;->readFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    const/4 v8, 0x0

    const/4 v9, 0x0

    const/4 v10, 0x1

    if-lez v0, :cond_2

    new-instance v2, Ljava/util/ArrayList;

    invoke-direct {v2, v0}, Ljava/util/ArrayList;-><init>(I)V

    iput-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    :goto_0
    if-lez v0, :cond_3

    add-int/lit8 v0, v0, -0x1

    new-instance v2, Landroid/os/BatteryStats$PackageChange;

    invoke-direct {v2}, Landroid/os/BatteryStats$PackageChange;-><init>()V

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    iput-object v3, v2, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_1

    move v3, v10

    goto :goto_1

    :cond_1
    move v3, v8

    :goto_1
    iput-boolean v3, v2, Landroid/os/BatteryStats$PackageChange;->mUpdate:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Landroid/os/BatteryStats$PackageChange;->mVersionCode:J

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v3, v2}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    goto :goto_0

    :cond_2
    iput-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    :cond_3
    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTimeToFullSeconds:J

    invoke-static {v7}, Lcom/android/internal/power/EnergyConsumerStats$Config;->createFromParcel(Landroid/os/Parcel;)Lcom/android/internal/power/EnergyConsumerStats$Config;

    move-result-object v0

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-static {v2, v7}, Lcom/android/internal/power/EnergyConsumerStats;->createAndReadSummaryFromParcel(Lcom/android/internal/power/EnergyConsumerStats$Config;Landroid/os/Parcel;)Lcom/android/internal/power/EnergyConsumerStats;

    move-result-object v2

    const/4 v11, 0x5

    if-eqz v0, :cond_5

    invoke-virtual {v0}, Lcom/android/internal/power/EnergyConsumerStats$Config;->getStateNames()[Ljava/lang/String;

    move-result-object v3

    new-array v4, v11, [Ljava/lang/String;

    move v5, v8

    :goto_2
    if-ge v5, v11, :cond_4

    invoke-static {v5}, Landroid/os/BatteryConsumer;->processStateToString(I)Ljava/lang/String;

    move-result-object v6

    aput-object v6, v4, v5

    add-int/lit8 v5, v5, 0x1

    goto :goto_2

    :cond_4
    invoke-static {v3, v4}, Ljava/util/Arrays;->equals([Ljava/lang/Object;[Ljava/lang/Object;)Z

    move-result v3

    if-eqz v3, :cond_5

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    iput-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    :cond_5
    iget v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    add-int/2addr v0, v10

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    iput v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_3
    if-ge v0, v11, :cond_6

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_3

    :cond_6
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    move v2, v8

    :goto_4
    if-ge v2, v0, :cond_8

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v3, v3, v2

    iget-object v4, v3, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v4, v3, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v4, v8

    :goto_5
    if-ge v4, v11, :cond_7

    iget-object v5, v3, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v4, v4, 0x1

    goto :goto_5

    :cond_7
    add-int/lit8 v2, v2, 0x1

    goto :goto_4

    :cond_8
    iput v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_6
    if-ge v0, v11, :cond_9

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_6

    :cond_9
    move v0, v8

    :goto_7
    if-ge v0, v11, :cond_a

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_7

    :cond_a
    move v0, v8

    :goto_8
    if-ge v0, v11, :cond_b

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_8

    :cond_b
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_9
    const/4 v2, 0x4

    if-ge v0, v2, :cond_c

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_9

    :cond_c
    move v0, v8

    :goto_a
    if-ge v0, v2, :cond_d

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v3, v3, v0

    invoke-virtual {v3, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_a

    :cond_d
    move v0, v8

    :goto_b
    const/16 v12, 0x10

    if-ge v0, v12, :cond_e

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v0

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v0

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v0, v0, 0x1

    goto :goto_b

    :cond_e
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_f

    move v0, v10

    goto :goto_c

    :cond_f
    move v0, v8

    :goto_c
    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasSpeakerOutReporting:Z

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_10

    new-array v2, v0, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iput-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move v2, v8

    :goto_d
    if-ge v2, v0, :cond_11

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v3, v3, v2

    invoke-static {v3}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-static {v7, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->readSummaryFromParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move-result-object v4

    aput-object v4, v3, v2

    add-int/lit8 v2, v2, 0x1

    goto :goto_d

    :cond_10
    iput-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    :cond_11
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_12

    new-array v2, v0, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iput-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move v2, v8

    :goto_e
    if-ge v2, v0, :cond_13

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v3, v3, v2

    invoke-static {v3}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-static {v7, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->readSummaryFromParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move-result-object v4

    aput-object v4, v3, v2

    add-int/lit8 v2, v2, 0x1

    goto :goto_e

    :cond_12
    iput-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    :cond_13
    iput-boolean v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractive:Z

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iput-boolean v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOn:Z

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_f
    sget v2, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    if-ge v0, v2, :cond_14

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_f

    :cond_14
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_10
    sget v2, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    if-ge v0, v2, :cond_15

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_10

    :cond_15
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_11
    const/16 v13, 0xa

    if-ge v0, v13, :cond_16

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v0

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v0

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v0, v0, 0x1

    goto :goto_11

    :cond_16
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    move v2, v8

    :goto_12
    if-ge v2, v0, :cond_22

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-nez v3, :cond_17

    move-object/from16 v16, v9

    goto/16 :goto_1b

    :cond_17
    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRatBatteryStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    move-result-object v3

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v4

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v5

    iget-object v6, v3, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v14, v6

    move v15, v8

    :goto_13
    if-ge v15, v4, :cond_1b

    move-object/from16 v16, v9

    move v9, v8

    :goto_14
    if-ge v9, v5, :cond_1a

    if-ge v15, v14, :cond_19

    if-lt v9, v11, :cond_18

    goto :goto_15

    :cond_18
    aget-object v17, v6, v15

    aget-object v13, v17, v9

    invoke-virtual {v13, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_16

    :cond_19
    :goto_15
    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v13, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v13, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;-><init>(Z)V

    const/16 v21, 0x0

    const/16 v24, 0x0

    const/16 v20, 0x0

    const/16 v22, 0x0

    move-object/from16 v23, v13

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v13, v19

    invoke-virtual {v13, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :goto_16
    add-int/lit8 v9, v9, 0x1

    const/16 v13, 0xa

    goto :goto_14

    :cond_1a
    add-int/lit8 v15, v15, 0x1

    move-object/from16 v9, v16

    const/16 v13, 0xa

    goto :goto_13

    :cond_1b
    move-object/from16 v16, v9

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v6

    if-ne v6, v10, :cond_1f

    move v6, v8

    :goto_17
    if-ge v6, v4, :cond_1f

    move v9, v8

    :goto_18
    if-ge v9, v5, :cond_1e

    if-ge v6, v14, :cond_1c

    if-lt v9, v11, :cond_1d

    :cond_1c
    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v13, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v13, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;-><init>(Z)V

    const/16 v21, 0x0

    const/16 v24, 0x0

    const/16 v20, 0x0

    const/16 v22, 0x0

    move-object/from16 v23, v13

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v13, v19

    invoke-virtual {v13, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_1d
    invoke-virtual {v3, v6, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getTxDurationCounter(IIZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v13

    invoke-virtual {v13}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v13, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v9, v9, 0x1

    const/4 v11, 0x5

    const/16 v12, 0x10

    goto :goto_18

    :cond_1e
    add-int/lit8 v6, v6, 0x1

    const/4 v11, 0x5

    const/16 v12, 0x10

    goto :goto_17

    :cond_1f
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v5

    if-ne v5, v10, :cond_21

    move v5, v8

    :goto_19
    if-ge v5, v4, :cond_21

    if-lt v5, v14, :cond_20

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    new-instance v6, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v6, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;-><init>(Z)V

    const/16 v21, 0x0

    const/16 v24, 0x0

    const/16 v20, 0x0

    const/16 v22, 0x0

    move-object/from16 v23, v6

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v6, v19

    invoke-virtual {v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_1a

    :cond_20
    invoke-virtual {v3, v5, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->getRxDurationCounter(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-result-object v6

    invoke-virtual {v6}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v6, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    :goto_1a
    add-int/lit8 v5, v5, 0x1

    goto :goto_19

    :cond_21
    :goto_1b
    add-int/lit8 v2, v2, 0x1

    move-object/from16 v9, v16

    const/4 v11, 0x5

    const/16 v12, 0x10

    const/16 v13, 0xa

    goto/16 :goto_12

    :cond_22
    move-object/from16 v16, v9

    iput v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerState:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iput v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiRadioPowerState:I

    iput-boolean v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOn:Z

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iput-boolean v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunning:Z

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    move v0, v8

    :goto_1c
    const/16 v9, 0x8

    if-ge v0, v9, :cond_23

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_1c

    :cond_23
    move v0, v8

    :goto_1d
    const/16 v2, 0xd

    if-ge v0, v2, :cond_24

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_1d

    :cond_24
    move v0, v8

    :goto_1e
    const/4 v15, 0x5

    if-ge v0, v15, :cond_25

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_1e

    :cond_25
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V

    move v0, v8

    :goto_1f
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v3, v2

    if-ge v0, v3, :cond_26

    aget-object v2, v2, v0

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_1f

    :cond_26
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->readSummaryFromParcel(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_27

    move v0, v10

    goto :goto_20

    :cond_27
    move v0, v8

    :goto_20
    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_28

    move v0, v10

    goto :goto_21

    :cond_28
    move v0, v8

    :goto_21
    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasBluetoothReporting:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-eqz v0, :cond_29

    move v0, v10

    goto :goto_22

    :cond_29
    move v0, v8

    :goto_22
    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasModemReporting:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumConnectivityChange:I

    iput v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnNesting:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iput v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnNesting:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iput v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanNesting:I

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    const/16 v11, 0x2710

    if-gt v0, v11, :cond_93

    move v2, v8

    :goto_23
    if-ge v2, v0, :cond_2b

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_2a

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    invoke-virtual {v1, v3}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRpmTimerLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    move-result-object v3

    invoke-virtual {v3, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_2a
    add-int/lit8 v2, v2, 0x1

    goto :goto_23

    :cond_2b
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-gt v0, v11, :cond_92

    move v2, v8

    :goto_24
    if-ge v2, v0, :cond_2e

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_2d

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v4, :cond_2c

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v5, v3, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_2c
    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_2d
    add-int/lit8 v2, v2, 0x1

    goto :goto_24

    :cond_2e
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-gt v0, v11, :cond_91

    move v2, v8

    :goto_25
    if-ge v2, v0, :cond_31

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_30

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v4, :cond_2f

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v5, v3, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_2f
    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_30
    add-int/lit8 v2, v2, 0x1

    goto :goto_25

    :cond_31
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    if-gt v0, v11, :cond_90

    move v2, v8

    :goto_26
    if-ge v2, v0, :cond_34

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_33

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v4, :cond_32

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v5, v3, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_32
    invoke-virtual {v4, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_33
    add-int/lit8 v2, v2, 0x1

    goto :goto_26

    :cond_34
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    move v2, v8

    :goto_27
    if-ge v2, v0, :cond_37

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_36

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v3

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v5, v3, v4}, Landroid/util/LongSparseArray;->get(J)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v5, :cond_35

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v5, v6, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v6, v3, v4, v5}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V

    :cond_35
    invoke-virtual {v5, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_36
    add-int/lit8 v2, v2, 0x1

    goto :goto_27

    :cond_37
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v0

    move v2, v8

    :goto_28
    if-ge v2, v0, :cond_3a

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v3

    if-eqz v3, :cond_39

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v3

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->containsKey(Ljava/lang/Object;)Z

    move-result v4

    if-nez v4, :cond_38

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    invoke-virtual {v4, v3, v5}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_38
    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v3, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_39
    add-int/lit8 v2, v2, 0x1

    goto :goto_28

    :cond_3a
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v12

    if-gt v12, v11, :cond_8f

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v3

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v5

    move v13, v8

    :goto_29
    if-ge v13, v12, :cond_8e

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    new-instance v21, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-object/from16 v0, v21

    invoke-direct/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;IJJ)V

    iget-object v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v14, v2, v0}, Landroid/util/SparseArray;->put(ILjava/lang/Object;)V

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    move/from16 v25, v12

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeUs:J

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v2}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeUs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeUs:J

    iput-boolean v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunning:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_3b

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_3b
    iput-boolean v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockOut:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_3c

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_3c
    iput-boolean v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanStarted:Z

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_3d

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_3d
    const/4 v2, -0x1

    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanBinStarted:I

    move v2, v8

    const/4 v15, 0x5

    :goto_2a
    if-ge v2, v15, :cond_3f

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_3e

    invoke-virtual {v0, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeWifiBatchedScanBin(I)V

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v11, v11, v2

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_3e
    add-int/lit8 v2, v2, 0x1

    goto :goto_2a

    :cond_3f
    iput v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiMulticastWakelockCount:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_40

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiMulticastTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_40
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_42

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_41

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mAudioTurnedOnTimers:Ljava/util/ArrayList;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    move-object/from16 v22, v12

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_41
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_42
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_44

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVideoTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_43

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mVideoTurnedOnTimers:Ljava/util/ArrayList;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    move-object/from16 v22, v12

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVideoTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_43
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVideoTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_44
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_46

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFlashlightTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_45

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightTurnedOnTimers:Ljava/util/ArrayList;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    move-object/from16 v22, v12

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFlashlightTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_45
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFlashlightTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_46
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_48

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_47

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraTurnedOnTimers:Ljava/util/ArrayList;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    move-object/from16 v22, v12

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_47
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_48
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_4a

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundActivityTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_49

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    const/16 v22, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundActivityTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_49
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundActivityTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_4a
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_4c

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_4b

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v24, 0x0

    const/16 v22, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;I)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    :cond_4b
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_4c
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_4e

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v2, :cond_4d

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v22, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v2

    move-object/from16 v20, v11

    move-object/from16 v24, v12

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    move-object/from16 v2, v19

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_4d
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_4e
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_4f

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->createBluetoothDutyScanTimerLocked()Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    move-result-object v2

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_4f
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_51

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v2, :cond_50

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->initSpeakerTimeCounterLocked()V

    :cond_50
    move v11, v8

    const/16 v2, 0x10

    :goto_2b
    if-ge v11, v2, :cond_52

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v12, v12, v11

    invoke-virtual {v12}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v14

    iput-wide v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v11, v11, 0x1

    const/4 v15, 0x5

    goto :goto_2b

    :cond_51
    const/16 v2, 0x10

    :cond_52
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_56

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    if-eqz v12, :cond_54

    invoke-virtual {v12}, Lcom/android/internal/os/PowerProfile;->getNumDisplays()I

    move-result v12

    if-ne v12, v11, :cond_53

    goto :goto_2c

    :cond_53
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string/jumbo v1, "The defined number of displays may have been changed, possibly due to modifications made to the power_profile file."

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_54
    :goto_2c
    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-static {v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    new-array v12, v11, [Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    move v12, v8

    :goto_2d
    if-ge v12, v11, :cond_56

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v14

    if-eqz v14, :cond_55

    invoke-virtual {v0, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeDisplayTopActivityTimer(I)V

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v14, v14, v12

    invoke-virtual {v14, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_2e

    :cond_55
    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aput-object v16, v14, v12

    :goto_2e
    add-int/lit8 v12, v12, 0x1

    goto :goto_2d

    :cond_56
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_58

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v11, :cond_57

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v12, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v14, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanOnTimers:Ljava/util/ArrayList;

    iget-object v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-object/from16 v21, v0

    move-object/from16 v23, v11

    move-object/from16 v20, v12

    move-object/from16 v22, v14

    move-object/from16 v24, v15

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    move-object/from16 v11, v19

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_57
    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_58
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_5a

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v11, :cond_59

    new-instance v19, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v12, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    const/16 v22, 0x0

    move-object/from16 v21, v0

    move-object/from16 v23, v11

    move-object/from16 v20, v12

    move-object/from16 v24, v14

    invoke-direct/range {v19 .. v24}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Ljava/util/ArrayList;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    move-object/from16 v11, v19

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    :cond_59
    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_5a
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_5c

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-nez v11, :cond_5b

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v12, v12, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    :cond_5b
    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_5c
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_5e

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultBgCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-nez v11, :cond_5d

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultBgCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    :cond_5d
    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultBgCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_5e
    const/4 v11, 0x7

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    move v12, v8

    :goto_2f
    if-ge v12, v11, :cond_60

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v14

    if-eqz v14, :cond_5f

    invoke-virtual {v0, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->makeProcessState(I)V

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v14, v14, v12

    invoke-virtual {v14, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_5f
    add-int/lit8 v12, v12, 0x1

    goto :goto_2f

    :cond_60
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_62

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVibratorOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    if-nez v11, :cond_61

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v12, v12, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v14, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-boolean v12, v12, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    iput-boolean v12, v11, Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;->mInDischarge:Z

    iput-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVibratorOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    :cond_61
    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVibratorOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_62
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_64

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-nez v11, :cond_63

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->initUserActivityLocked()V

    :cond_63
    move v11, v8

    :goto_30
    sget v12, Landroid/os/BatteryStats$Uid;->NUM_USER_ACTIVITY_TYPES:I

    if-ge v11, v12, :cond_64

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object v12, v12, v11

    invoke-virtual {v12, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v11, v11, 0x1

    goto :goto_30

    :cond_64
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_67

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureNetworkActivityLocked()V

    move v12, v8

    const/16 v11, 0xa

    :goto_31
    if-ge v12, v11, :cond_65

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v14, v14, v12

    invoke-virtual {v14, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v14, v14, v12

    invoke-virtual {v14, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v12, v12, 0x1

    goto :goto_31

    :cond_65
    invoke-virtual {v7}, Landroid/os/Parcel;->readBoolean()Z

    move-result v12

    if-eqz v12, :cond_66

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-static {v7, v12, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$smreadFromParcel(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;J)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v12

    iput-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveTime:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_66
    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v12, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_32

    :cond_67
    const/16 v11, 0xa

    :goto_32
    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v12, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v12, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v12

    if-eqz v12, :cond_71

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v12

    iget-object v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    if-eqz v14, :cond_68

    invoke-virtual {v14}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v14

    goto :goto_33

    :cond_68
    move-object/from16 v14, v16

    :goto_33
    if-eqz v14, :cond_6a

    array-length v15, v14

    if-ne v15, v12, :cond_69

    goto :goto_34

    :cond_69
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "Incompatible cpu cluster arrangement"

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_6a
    :goto_34
    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v15}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([[Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    new-array v15, v12, [[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move v15, v8

    :goto_35
    if-ge v15, v12, :cond_70

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v18

    if-eqz v18, :cond_6f

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v14, :cond_6c

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    aget v11, v14, v15

    invoke-virtual {v8, v11}, Lcom/android/internal/os/CpuScalingPolicies;->getFrequencies(I)[I

    move-result-object v8

    array-length v8, v8

    if-ne v8, v2, :cond_6b

    goto :goto_36

    :cond_6b
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many speed bins "

    invoke-static {v2, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_6c
    :goto_36
    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    new-array v11, v2, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aput-object v11, v8, v15

    const/4 v8, 0x0

    :goto_37
    if-ge v8, v2, :cond_6e

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_6d

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v11, v11, v15

    move/from16 v21, v10

    new-instance v10, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v10, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v10, v11, v8

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v9, v9, v15

    aget-object v9, v9, v8

    invoke-virtual {v9, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_38

    :cond_6d
    move/from16 v21, v10

    :goto_38
    add-int/lit8 v8, v8, 0x1

    move/from16 v10, v21

    const/16 v9, 0x8

    goto :goto_37

    :cond_6e
    move/from16 v21, v10

    goto :goto_39

    :cond_6f
    move/from16 v21, v10

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aput-object v16, v2, v15

    :goto_39
    add-int/lit8 v15, v15, 0x1

    move/from16 v10, v21

    const/16 v2, 0x10

    const/4 v8, 0x0

    const/16 v9, 0x8

    const/16 v11, 0xa

    goto :goto_35

    :cond_70
    move/from16 v21, v10

    goto :goto_3a

    :cond_71
    move/from16 v21, v10

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([[Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    move-object/from16 v2, v16

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :goto_3a
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-static {v7, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->readSummaryFromParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move-result-object v2

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mScreenOffCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-static {v7, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->readSummaryFromParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    move-result-object v2

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mScreenOffCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_72

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v8}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v8

    invoke-static {v7, v2, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$smreadFromParcel(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;J)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v2

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuActiveTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_72
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterTimesMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v7, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->-$$Nest$mreadSummaryFromParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;)V

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    const/4 v2, 0x0

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_75

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v8}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result v8

    iget-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v9}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v9

    sget-object v11, Lcom/android/internal/os/LongArrayMultiStateCounter;->CREATOR:Landroid/os/Parcelable$Creator;

    invoke-interface {v11, v7}, Landroid/os/Parcelable$Creator;->createFromParcel(Landroid/os/Parcel;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v11}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getStateCount()I

    move-result v12

    const/16 v14, 0x8

    if-ne v12, v14, :cond_74

    invoke-virtual {v11}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getArrayLength()I

    move-result v12

    if-eq v12, v8, :cond_73

    goto :goto_3b

    :cond_73
    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-direct {v8, v2, v11, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/internal/os/LongArrayMultiStateCounter;J)V

    goto :goto_3c

    :cond_74
    :goto_3b
    const/4 v8, 0x0

    :goto_3c
    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    :cond_75
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    const/4 v2, 0x0

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_78

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v8}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result v8

    iget-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v9}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v9

    sget-object v11, Lcom/android/internal/os/LongArrayMultiStateCounter;->CREATOR:Landroid/os/Parcelable$Creator;

    invoke-interface {v11, v7}, Landroid/os/Parcelable$Creator;->createFromParcel(Landroid/os/Parcel;)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v11}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getStateCount()I

    move-result v12

    const/16 v15, 0x8

    if-ne v12, v15, :cond_77

    invoke-virtual {v11}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getArrayLength()I

    move-result v12

    if-eq v12, v8, :cond_76

    goto :goto_3d

    :cond_76
    new-instance v8, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    invoke-direct {v8, v2, v11, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;Lcom/android/internal/os/LongArrayMultiStateCounter;J)V

    goto :goto_3e

    :cond_77
    :goto_3d
    const/4 v8, 0x0

    :goto_3e
    iput-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    goto :goto_3f

    :cond_78
    const/16 v15, 0x8

    :goto_3f
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_79

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v2, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_40

    :cond_79
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    const/4 v2, 0x0

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :goto_40
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    if-eqz v2, :cond_7a

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    new-instance v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v2, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    const/4 v2, 0x0

    goto :goto_41

    :cond_7a
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    const/4 v2, 0x0

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :goto_41
    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-static {v8, v7}, Lcom/android/internal/power/EnergyConsumerStats;->createAndReadSummaryFromParcel(Lcom/android/internal/power/EnergyConsumerStats$Config;Landroid/os/Parcel;)Lcom/android/internal/power/EnergyConsumerStats;

    move-result-object v8

    invoke-static {v0, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->-$$Nest$fputmUidEnergyConsumerStats(Lcom/android/server/power/stats/BatteryStatsImpl$Uid;Lcom/android/internal/power/EnergyConsumerStats;)V

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v8

    sget v9, Lcom/android/server/power/stats/BatteryStatsImpl;->MAX_WAKELOCKS_PER_UID:I

    add-int/lit8 v9, v9, 0x1

    if-gt v8, v9, :cond_8d

    const/4 v9, 0x0

    :goto_42
    if-ge v9, v8, :cond_7b

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v10, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->readWakeSummaryFromParcelLocked(Ljava/lang/String;Landroid/os/Parcel;)V

    add-int/lit8 v9, v9, 0x1

    goto :goto_42

    :cond_7b
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v8

    sget v9, Lcom/android/server/power/stats/BatteryStatsImpl;->MAX_WAKELOCKS_PER_UID:I

    add-int/lit8 v9, v9, 0x1

    if-gt v8, v9, :cond_8c

    const/4 v9, 0x0

    :goto_43
    if-ge v9, v8, :cond_7c

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v10, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->readSyncSummaryFromParcelLocked(Ljava/lang/String;Landroid/os/Parcel;)V

    add-int/lit8 v9, v9, 0x1

    goto :goto_43

    :cond_7c
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v8

    sget v9, Lcom/android/server/power/stats/BatteryStatsImpl;->MAX_WAKELOCKS_PER_UID:I

    add-int/lit8 v9, v9, 0x1

    if-gt v8, v9, :cond_8b

    const/4 v9, 0x0

    :goto_44
    if-ge v9, v8, :cond_7d

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v10, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->readJobSummaryFromParcelLocked(Ljava/lang/String;Landroid/os/Parcel;)V

    add-int/lit8 v9, v9, 0x1

    goto :goto_44

    :cond_7d
    invoke-virtual {v0, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->readJobCompletionsFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredEventCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v8, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v8, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v8, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-static {v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    const/4 v8, 0x0

    :goto_45
    sget-object v9, Landroid/os/BatteryStats;->JOB_FRESHNESS_BUCKETS:[J

    array-length v9, v9

    if-ge v8, v9, :cond_7f

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v9

    if-eqz v9, :cond_7e

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    new-instance v10, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v10, v11}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v10, v9, v8

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object v9, v9, v8

    invoke-virtual {v9, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    :cond_7e
    add-int/lit8 v8, v8, 0x1

    goto :goto_45

    :cond_7f
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v8

    const/16 v9, 0x3e8

    if-gt v8, v9, :cond_8a

    const/4 v9, 0x0

    :goto_46
    if-ge v9, v8, :cond_81

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v10

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    if-eqz v11, :cond_80

    move/from16 v11, v21

    invoke-virtual {v0, v10, v11}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getSensorTimerLocked(IZ)Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    move-result-object v10

    invoke-virtual {v10, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_47

    :cond_80
    move/from16 v11, v21

    :goto_47
    add-int/lit8 v9, v9, 0x1

    move/from16 v21, v11

    goto :goto_46

    :cond_81
    move/from16 v11, v21

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v8

    const/16 v14, 0x2710

    if-gt v8, v14, :cond_89

    const/4 v9, 0x0

    :goto_48
    if-ge v9, v8, :cond_82

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getProcessStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;

    move-result-object v10

    move-wide/from16 v16, v3

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mUserTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mSystemTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v2

    iput-wide v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mForegroundTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    iput v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mStarts:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    iput v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mNumCrashes:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    iput v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mNumAnrs:I

    invoke-virtual {v10, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->readExcessivePowerFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v9, v9, 0x1

    move-wide/from16 v3, v16

    const/4 v2, 0x0

    goto :goto_48

    :cond_82
    move-wide/from16 v16, v3

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v2

    const/16 v14, 0x2710

    if-gt v2, v14, :cond_88

    const/4 v3, 0x0

    :goto_49
    if-ge v3, v2, :cond_87

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v8

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPackageStats:Landroid/util/ArrayMap;

    invoke-virtual {v9, v8}, Landroid/util/ArrayMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    invoke-static {v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->detachIfNotNull(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    invoke-virtual {v0, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getPackageStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    move-result-object v9

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v10

    if-gt v10, v14, :cond_86

    iget-object v12, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mWakeupAlarms:Landroid/util/ArrayMap;

    invoke-virtual {v12}, Landroid/util/ArrayMap;->clear()V

    const/4 v12, 0x0

    :goto_4a
    if-ge v12, v10, :cond_83

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v4

    new-instance v11, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v11, v14}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    invoke-virtual {v11, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->readSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v14, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mWakeupAlarms:Landroid/util/ArrayMap;

    invoke-virtual {v14, v4, v11}, Landroid/util/ArrayMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    add-int/lit8 v12, v12, 0x1

    const/4 v11, 0x1

    goto :goto_4a

    :cond_83
    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v4

    const/16 v14, 0x2710

    if-gt v4, v14, :cond_85

    const/4 v9, 0x0

    :goto_4b
    if-ge v9, v4, :cond_84

    invoke-virtual {v7}, Landroid/os/Parcel;->readString()Ljava/lang/String;

    move-result-object v10

    invoke-virtual {v0, v8, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getServiceStatsLocked(Ljava/lang/String;Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;

    move-result-object v10

    invoke-virtual {v7}, Landroid/os/Parcel;->readLong()J

    move-result-wide v11

    iput-wide v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mStartTimeMs:J

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    iput v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mStarts:I

    invoke-virtual {v7}, Landroid/os/Parcel;->readInt()I

    move-result v11

    iput v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mLaunches:I

    add-int/lit8 v9, v9, 0x1

    goto :goto_4b

    :cond_84
    add-int/lit8 v3, v3, 0x1

    const/4 v11, 0x1

    goto :goto_49

    :cond_85
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many services "

    invoke-static {v4, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_86
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many wakeup alarms "

    invoke-static {v10, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_87
    add-int/lit8 v13, v13, 0x1

    move v11, v14

    move v9, v15

    move-wide/from16 v3, v16

    move/from16 v12, v25

    const/4 v8, 0x0

    const/4 v10, 0x1

    const/16 v16, 0x0

    goto/16 :goto_29

    :cond_88
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many packages "

    invoke-static {v2, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_89
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many processes "

    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_8a
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many sensors "

    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_8b
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many job timers "

    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_8c
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many syncs "

    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_8d
    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many wake locks "

    invoke-static {v8, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_8e
    return-void

    :cond_8f
    move/from16 v25, v12

    new-instance v0, Landroid/os/ParcelFormatException;

    const-string v1, "File corrupt: too many uids "

    move/from16 v2, v25

    invoke-static {v2, v1}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v1

    invoke-direct {v0, v1}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v0

    :cond_90
    new-instance v1, Landroid/os/ParcelFormatException;

    const-string v2, "File corrupt: too many wakeup reasons "

    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v1

    :cond_91
    new-instance v1, Landroid/os/ParcelFormatException;

    const-string v2, "File corrupt: too many kernel wake locks "

    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v1

    :cond_92
    new-instance v1, Landroid/os/ParcelFormatException;

    const-string v2, "File corrupt: too many screen-off rpm stats "

    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v1

    :cond_93
    new-instance v1, Landroid/os/ParcelFormatException;

    const-string v2, "File corrupt: too many rpm stats "

    invoke-static {v0, v2}, Landroid/frameworks/vibrator/VibrationParam$1$$ExternalSyntheticOutline0;->m(ILjava/lang/String;)Ljava/lang/String;

    move-result-object v0

    invoke-direct {v1, v0}, Landroid/os/ParcelFormatException;-><init>(Ljava/lang/String;)V

    throw v1
.end method

.method public readWifiNetworkStatsLocked(Landroid/app/usage/NetworkStatsManager;)Landroid/net/NetworkStats;
    .locals 0

    invoke-virtual {p1}, Landroid/app/usage/NetworkStatsManager;->getWifiUidStats()Landroid/net/NetworkStats;

    move-result-object p0

    return-object p0
.end method

.method public final recordDailyStatsIfNeededLocked(JZ)V
    .locals 4

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    cmp-long v0, p1, v0

    if-ltz v0, :cond_0

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsLocked()V

    return-void

    :cond_0
    if-eqz p3, :cond_1

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    cmp-long p3, p1, v0

    if-ltz p3, :cond_1

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsLocked()V

    return-void

    :cond_1
    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    const-wide/32 v2, 0x5265c00

    sub-long/2addr v0, v2

    cmp-long p1, p1, v0

    if-gez p1, :cond_2

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsLocked()V

    :cond_2
    return-void
.end method

.method public final recordDailyStatsLocked()V
    .locals 10

    new-instance v0, Landroid/os/BatteryStats$DailyItem;

    invoke-direct {v0}, Landroid/os/BatteryStats$DailyItem;-><init>()V

    iget-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    iput-wide v1, v0, Landroid/os/BatteryStats$DailyItem;->mStartTime:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v1

    iput-wide v1, v0, Landroid/os/BatteryStats$DailyItem;->mEndTime:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v1, v1, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    const/4 v2, 0x1

    const/4 v3, 0x0

    if-lez v1, :cond_0

    new-instance v1, Landroid/os/BatteryStats$LevelStepTracker;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v5, v4, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    iget-object v4, v4, Landroid/os/BatteryStats$LevelStepTracker;->mStepDurations:[J

    invoke-direct {v1, v5, v4}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I[J)V

    iput-object v1, v0, Landroid/os/BatteryStats$DailyItem;->mDischargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    move v1, v2

    goto :goto_0

    :cond_0
    move v1, v3

    :goto_0
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v4, v4, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    if-lez v4, :cond_1

    new-instance v1, Landroid/os/BatteryStats$LevelStepTracker;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v5, v4, Landroid/os/BatteryStats$LevelStepTracker;->mNumStepDurations:I

    iget-object v4, v4, Landroid/os/BatteryStats$LevelStepTracker;->mStepDurations:[J

    invoke-direct {v1, v5, v4}, Landroid/os/BatteryStats$LevelStepTracker;-><init>(I[J)V

    iput-object v1, v0, Landroid/os/BatteryStats$DailyItem;->mChargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    move v1, v2

    :cond_1
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    if-eqz v4, :cond_2

    iput-object v4, v0, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    const/4 v1, 0x0

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    goto :goto_1

    :cond_2
    move v2, v1

    :goto_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v1}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v1}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateDailyDeadlineLocked()V

    if-eqz v2, :cond_4

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v4, v0}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :goto_2
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v0}, Ljava/util/ArrayList;->size()I

    move-result v0

    const/16 v4, 0xa

    if-le v0, v4, :cond_3

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v0, v3}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;

    goto :goto_2

    :cond_3
    new-instance v6, Ljava/io/ByteArrayOutputStream;

    invoke-direct {v6}, Ljava/io/ByteArrayOutputStream;-><init>()V

    :try_start_0
    invoke-static {v6}, Landroid/util/Xml;->resolveSerializer(Ljava/io/OutputStream;)Lcom/android/modules/utils/TypedXmlSerializer;

    move-result-object v0

    invoke-virtual {p0, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeDailyItemsLocked(Lcom/android/modules/utils/TypedXmlSerializer;)V

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v3

    sub-long v7, v3, v1

    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;

    move-result-object v0

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$10;

    const/4 v9, 0x0

    move-object v5, p0

    invoke-direct/range {v4 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl$10;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Ljava/lang/Object;JI)V

    invoke-virtual {v0, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0

    :catch_0
    :cond_4
    return-void
.end method

.method public final removeCpuStatsForUidRangeLocked(II)V
    .locals 3

    if-ne p1, p2, :cond_2

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    invoke-virtual {p2, p1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;->removeUid(I)V

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {p2, p1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->removeUid(I)V

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-boolean p2, p2, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->TRACK_CPU_ACTIVE_CLUSTER_TIME:Z

    if-eqz p2, :cond_0

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    invoke-virtual {p2, p1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;->removeUid(I)V

    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    invoke-virtual {p2, p1}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;->removeUid(I)V

    :cond_0
    iget-object p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    if-eqz p2, :cond_1

    invoke-virtual {p2, p1}, Lcom/android/internal/os/KernelSingleUidTimeReader;->removeUid(I)V

    :cond_1
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    add-int/lit8 p1, p1, 0x1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    return-void

    :cond_2
    if-ge p1, p2, :cond_a

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0, p1, p2}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->removeUidsInRange(II)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    invoke-virtual {v0, p1, p2}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;->removeUidsInRange(II)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-boolean v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->TRACK_CPU_ACTIVE_CLUSTER_TIME:Z

    if-eqz v0, :cond_3

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    invoke-virtual {v0, p1, p2}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;->removeUidsInRange(II)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    invoke-virtual {v0, p1, p2}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;->removeUidsInRange(II)V

    :cond_3
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    if-eqz v0, :cond_4

    invoke-virtual {v0, p1, p2}, Lcom/android/internal/os/KernelSingleUidTimeReader;->removeUidsInRange(II)V

    :cond_4
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsUidResolver:Lcom/android/server/power/stats/PowerStatsUidResolver;

    monitor-enter v0

    :try_start_0
    iget-object v1, v0, Lcom/android/server/power/stats/PowerStatsUidResolver;->mIsolatedUids:Landroid/util/SparseIntArray;

    invoke-virtual {v1, p1}, Landroid/util/SparseIntArray;->indexOfKey(I)I

    move-result p1

    iget-object v1, v0, Lcom/android/server/power/stats/PowerStatsUidResolver;->mIsolatedUids:Landroid/util/SparseIntArray;

    invoke-virtual {v1, p2}, Landroid/util/SparseIntArray;->indexOfKey(I)I

    move-result p2

    if-gez p1, :cond_5

    not-int p1, p1

    :cond_5
    if-gez p2, :cond_6

    not-int p2, p2

    add-int/lit8 p2, p2, -0x1

    :cond_6
    if-le p1, p2, :cond_7

    monitor-exit v0

    goto :goto_2

    :catchall_0
    move-exception p0

    goto :goto_3

    :cond_7
    new-instance v1, Landroid/util/IntArray;

    sub-int v2, p2, p1

    invoke-direct {v1, v2}, Landroid/util/IntArray;-><init>(I)V

    :goto_0
    if-gt p1, p2, :cond_8

    iget-object v2, v0, Lcom/android/server/power/stats/PowerStatsUidResolver;->mIsolatedUids:Landroid/util/SparseIntArray;

    invoke-virtual {v2, p1}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v2

    invoke-virtual {v1, v2}, Landroid/util/IntArray;->add(I)V

    add-int/lit8 p1, p1, 0x1

    goto :goto_0

    :cond_8
    monitor-exit v0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    invoke-virtual {v1}, Landroid/util/IntArray;->size()I

    move-result p1

    add-int/lit8 p1, p1, -0x1

    :goto_1
    if-ltz p1, :cond_9

    invoke-virtual {v1, p1}, Landroid/util/IntArray;->get(I)I

    move-result p2

    invoke-virtual {v0, p2}, Lcom/android/server/power/stats/PowerStatsUidResolver;->releaseIsolatedUid(I)V

    add-int/lit8 p1, p1, -0x1

    goto :goto_1

    :cond_9
    :goto_2
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    add-int/lit8 p1, p1, 0x1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    return-void

    :goto_3
    :try_start_1
    monitor-exit v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw p0

    :cond_a
    const-string p0, "BatteryStatsImpl"

    new-instance v0, Ljava/lang/StringBuilder;

    const-string v1, "End UID "

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string p2, " is smaller than start UID "

    invoke-virtual {v0, p2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object p1

    invoke-static {p0, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void
.end method

.method public final removeUidStatsLocked(IJ)V
    .locals 7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-eqz v0, :cond_0

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->detachFromTimeBase()V

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->remove(I)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingRemovedUids:Ljava/util/Queue;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;

    move v4, p1

    move-object v2, p0

    move v3, p1

    move-wide v5, p2

    invoke-direct/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl$UidToRemove;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;IIJ)V

    invoke-interface {v0, v1}, Ljava/util/Queue;->add(Ljava/lang/Object;)Z

    return-void
.end method

.method public final reportExcessiveCpuLocked(IJJLjava/lang/String;)V
    .locals 0

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result p1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p0, p1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-eqz p0, :cond_1

    invoke-virtual {p0, p6}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getProcessStatsLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;

    move-result-object p0

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mExcessivePower:Ljava/util/ArrayList;

    if-nez p1, :cond_0

    new-instance p1, Ljava/util/ArrayList;

    invoke-direct {p1}, Ljava/util/ArrayList;-><init>()V

    iput-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mExcessivePower:Ljava/util/ArrayList;

    :cond_0
    new-instance p1, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;

    invoke-direct {p1}, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;-><init>()V

    const/4 p6, 0x2

    iput p6, p1, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->type:I

    iput-wide p2, p1, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->overTime:J

    iput-wide p4, p1, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->usedTime:J

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mExcessivePower:Ljava/util/ArrayList;

    invoke-virtual {p0, p1}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_1
    return-void
.end method

.method public final resetAllStatsAndHistoryLocked()V
    .locals 13

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v3

    const-wide/16 v0, 0x3e8

    mul-long v7, v3, v0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v5

    mul-long v9, v5, v0

    const/4 v2, 0x2

    move-object v1, p0

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetAllStatsLocked(IJJ)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->pullPendingStateUpdatesLocked()V

    iget-object p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0, v5, v6, v3, v4}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    iget p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget-object p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    const-wide/16 v11, 0x0

    if-nez v0, :cond_0

    iput-wide v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mPastUptimeUs:J

    iput-wide v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mPastRealtimeUs:J

    goto :goto_0

    :cond_0
    iput-wide v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeStartUs:J

    iput-wide v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeStartUs:J

    :goto_0
    iget-object p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-nez v0, :cond_1

    iput-wide v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mPastUptimeUs:J

    iput-wide v11, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mPastRealtimeUs:J

    goto :goto_1

    :cond_1
    iput-wide v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mUptimeStartUs:J

    iput-wide v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRealtimeStartUs:J

    :goto_1
    iget-boolean p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedIn:Z

    if-nez p0, :cond_6

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result p0

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryCCInfo()I

    move-result v0

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    const/4 v7, 0x0

    if-eqz v2, :cond_2

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    goto :goto_2

    :cond_2
    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isDozeState(I)Z

    move-result v2

    if-eqz v2, :cond_3

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    goto :goto_2

    :cond_3
    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    :goto_2
    iget-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v0, :cond_5

    iget v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v0}, Landroid/view/Display;->isOnState(I)Z

    move-result v0

    if-eqz v0, :cond_4

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    goto :goto_3

    :cond_4
    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput p0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    goto :goto_3

    :cond_5
    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    :goto_3
    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    iput v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    :cond_6
    invoke-virtual {v1, v5, v6, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->initActiveHistoryEventsLocked(JJ)V

    return-void
.end method

.method public final resetAllStatsLocked(IJJ)V
    .locals 15

    move-wide/from16 v1, p4

    const-wide/16 v3, 0x3e8

    mul-long v6, p2, v3

    mul-long v8, v1, v3

    const/4 v3, 0x0

    iput v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    invoke-virtual {p0, v6, v7, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->initTimes(JJ)V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v4, v3

    :goto_0
    const/4 v11, 0x5

    if-ge v4, v11, :cond_0

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_0
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v4, v4

    move v5, v3

    :goto_1
    if-ge v5, v4, :cond_2

    iget-object v10, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v10, v10, v5

    iget-object v12, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v12, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v12, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v12, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v12, v3

    :goto_2
    if-ge v12, v11, :cond_1

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v13, v13, v12

    invoke-virtual {v13, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v12, v12, 0x1

    goto :goto_2

    :cond_1
    add-int/lit8 v5, v5, 0x1

    goto :goto_1

    :cond_2
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v4, v3

    :goto_3
    if-ge v4, v11, :cond_3

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v4, v4, 0x1

    goto :goto_3

    :cond_3
    move v4, v3

    :goto_4
    if-ge v4, v11, :cond_4

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    add-int/lit8 v4, v4, 0x1

    goto :goto_4

    :cond_4
    move v4, v3

    :goto_5
    if-ge v4, v11, :cond_5

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    add-int/lit8 v4, v4, 0x1

    goto :goto_5

    :cond_5
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    move v4, v3

    :goto_6
    const/4 v12, 0x4

    if-ge v4, v12, :cond_6

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    add-int/lit8 v4, v4, 0x1

    goto :goto_6

    :cond_6
    move v4, v3

    :goto_7
    if-ge v4, v12, :cond_7

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    invoke-virtual {v5, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v4, v4, 0x1

    goto :goto_7

    :cond_7
    move v4, v3

    :goto_8
    const/16 v5, 0x10

    const-wide/16 v13, 0x0

    if-ge v4, v5, :cond_8

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v5, v5, v4

    iput-wide v13, v5, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v5, v5, v4

    iput-wide v13, v5, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v4, v4, 0x1

    goto :goto_8

    :cond_8
    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iput-wide v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->reset()V

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v4, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;J)Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v4, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->resetIfNotNull([Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;J)Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const/4 v5, -0x1

    if-eqz v4, :cond_9

    invoke-virtual {v4}, Lcom/android/internal/os/PowerProfile;->getBatteryCapacity()D

    move-result-wide v11

    double-to-int v4, v11

    iput v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    goto :goto_9

    :cond_9
    iput v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    :goto_9
    iput v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    iput v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    iput v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v4, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iput-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastIdleTimeStartMs:J

    iput-wide v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    iput-wide v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAudioOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mVideoOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v1, v3

    :goto_a
    sget v2, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    if-ge v1, v2, :cond_a

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_a

    :cond_a
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v1, v3

    :goto_b
    sget v2, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    if-ge v1, v2, :cond_b

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_b

    :cond_b
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v1, v3

    :goto_c
    const/16 v2, 0xa

    if-ge v1, v2, :cond_c

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v1

    iput-wide v13, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v1

    iput-wide v13, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    add-int/lit8 v1, v1, 0x1

    goto :goto_c

    :cond_c
    move v1, v3

    :goto_d
    const/4 v2, 0x3

    if-ge v1, v2, :cond_12

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v2, v2, v1

    if-nez v2, :cond_d

    goto :goto_12

    :cond_d
    iget-object v4, v2, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v5, v4

    move v10, v3

    :goto_e
    if-ge v10, v5, :cond_11

    move v12, v3

    :goto_f
    const/4 v11, 0x5

    if-ge v12, v11, :cond_f

    aget-object v11, v4, v10

    aget-object v11, v11, v12

    invoke-virtual {v11, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerStateTxDurationMs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v11, :cond_e

    goto :goto_10

    :cond_e
    aget-object v11, v11, v10

    aget-object v11, v11, v12

    iput-wide v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    :goto_10
    add-int/lit8 v12, v12, 0x1

    goto :goto_f

    :cond_f
    iget-object v11, v2, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerFrequencyRxDurationMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v11, :cond_10

    goto :goto_11

    :cond_10
    aget-object v11, v11, v10

    iput-wide v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    :goto_11
    add-int/lit8 v10, v10, 0x1

    goto :goto_e

    :cond_11
    :goto_12
    add-int/lit8 v1, v1, 0x1

    goto :goto_d

    :cond_12
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    move v1, v3

    :goto_13
    const/16 v2, 0x8

    if-ge v1, v2, :cond_13

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_13

    :cond_13
    move v1, v3

    :goto_14
    const/16 v2, 0xd

    if-ge v1, v2, :cond_14

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_14

    :cond_14
    move v1, v3

    :goto_15
    const/4 v11, 0x5

    if-ge v1, v11, :cond_15

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_15

    :cond_15
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->reset(J)V

    move v1, v3

    :goto_16
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v4, v2

    if-ge v1, v4, :cond_16

    aget-object v2, v2, v1

    invoke-virtual {v2, v8, v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->reset(JZ)Z

    add-int/lit8 v1, v1, 0x1

    goto :goto_16

    :cond_16
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->reset(J)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v1, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->reset(J)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-interface {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;->reset()V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-interface {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;->reset()V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->reset()V

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->reset()V

    iput v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumConnectivityChange:I

    move v1, v3

    :goto_17
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I

    move-result v2

    const/4 v4, 0x1

    if-ge v1, v2, :cond_18

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    move-object v5, v2

    check-cast v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move/from16 v10, p1

    invoke-virtual/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->reset(JJI)Z

    move-result v2

    if-eqz v2, :cond_17

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->detachFromTimeBase()V

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v5

    invoke-virtual {v2, v5}, Landroid/util/SparseArray;->remove(I)V

    add-int/lit8 v1, v1, -0x1

    :cond_17
    add-int/2addr v1, v4

    goto :goto_17

    :cond_18
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_1a

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_18
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_19

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    goto :goto_18

    :cond_19
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->clear()V

    :cond_1a
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_1c

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_19
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1b

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    goto :goto_19

    :cond_1b
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->clear()V

    :cond_1c
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_1e

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_1a
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1d

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    goto :goto_1a

    :cond_1d
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->clear()V

    :cond_1e
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v1}, Landroid/util/LongSparseArray;->size()I

    move-result v1

    if-lez v1, :cond_20

    move v1, v3

    :goto_1b
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v2}, Landroid/util/LongSparseArray;->size()I

    move-result v2

    if-ge v1, v2, :cond_1f

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v5, v1}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;

    invoke-virtual {v2, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_1b

    :cond_1f
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v1}, Landroid/util/LongSparseArray;->clear()V

    :cond_20
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_22

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_1c
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_21

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    goto :goto_1c

    :cond_21
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->clear()V

    :cond_22
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->size()I

    move-result v1

    if-lez v1, :cond_24

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->values()Ljava/util/Collection;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Collection;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_1d
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_23

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v5, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->remove(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBaseObs;)V

    goto :goto_1d

    :cond_23
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v1}, Ljava/util/HashMap;->clear()V

    :cond_24
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    iput-boolean v3, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mHasHistoryStepDetails:Z

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuUserTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepCpuUserTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepCpuSystemTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepCpuSystemTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatUserTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatUserTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSystemTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatSystemTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIOWaitTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatIOWaitTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIrqTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatIrqTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatSoftIrqTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatSoftIrqTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mCurStepStatIdleTimeMs:J

    iput-wide v13, v1, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mLastStepStatIdleTimeMs:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    if-eqz v1, :cond_25

    invoke-virtual {v1}, Lcom/android/internal/os/RailStats;->reset()V

    :cond_25
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    invoke-static {v1}, Lcom/android/internal/power/EnergyConsumerStats;->resetIfNotNull(Lcom/android/internal/power/EnergyConsumerStats;)V

    iput v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    iput v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumUidsRemoved:I

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->initDischarge()V

    move/from16 v10, p1

    const/4 v11, 0x5

    if-ne v10, v11, :cond_26

    goto :goto_1e

    :cond_26
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v1}, Lcom/android/internal/os/BatteryStatsHistory;->reset()V

    :goto_1e
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    sget v2, Landroid/os/BatteryStats;->NUM_PROTECT_BATTERY_MODE_TYPES:I

    if-ge v1, v2, :cond_27

    invoke-static {v1, v3}, Ljava/lang/Math;->max(II)I

    move-result v1

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v2, v1}, Lcom/android/internal/os/BatteryStatsHistory;->setProtectBatteryState(I)V

    :cond_27
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeSyncLocked()V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    invoke-virtual {v1, v4}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v1

    if-eqz v1, :cond_28

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->schedulePowerStatsSampleCollection()V

    :cond_28
    iput-boolean v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    const-string/jumbo v2, "reset"

    const/16 v3, 0xff

    invoke-virtual {v1, v3, v2}, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->scheduleSync(ILjava/lang/String;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    const/4 v1, 0x4

    invoke-virtual {v0, v1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    return-void
.end method

.method public final saveBatteryUsageStatsOnReset()V
    .locals 5

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSaveBatteryUsageStatsOnReset:Z

    if-nez v0, :cond_0

    return-void

    :cond_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAccumulateBatteryUsageStats:Z

    if-eqz v0, :cond_1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryUsageStatsProvider:Lcom/android/server/power/stats/BatteryUsageStatsProvider;

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryStatsSession()Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;

    move-result-object v1

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    invoke-virtual {v0, v1, p0}, Lcom/android/server/power/stats/BatteryUsageStatsProvider;->accumulateBatteryUsageStats(Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;)V

    return-void

    :cond_1
    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryUsageStatsProvider:Lcom/android/server/power/stats/BatteryUsageStatsProvider;

    new-instance v1, Landroid/os/BatteryUsageStatsQuery$Builder;

    invoke-direct {v1}, Landroid/os/BatteryUsageStatsQuery$Builder;-><init>()V

    const-wide/16 v2, 0x0

    invoke-virtual {v1, v2, v3}, Landroid/os/BatteryUsageStatsQuery$Builder;->setMaxStatsAgeMs(J)Landroid/os/BatteryUsageStatsQuery$Builder;

    move-result-object v1

    invoke-virtual {v1}, Landroid/os/BatteryUsageStatsQuery$Builder;->includePowerModels()Landroid/os/BatteryUsageStatsQuery$Builder;

    move-result-object v1

    invoke-virtual {v1}, Landroid/os/BatteryUsageStatsQuery$Builder;->includeProcessStateData()Landroid/os/BatteryUsageStatsQuery$Builder;

    move-result-object v1

    invoke-virtual {v1}, Landroid/os/BatteryUsageStatsQuery$Builder;->build()Landroid/os/BatteryUsageStatsQuery;

    move-result-object v1

    invoke-virtual {v0, p0, v1}, Lcom/android/server/power/stats/BatteryUsageStatsProvider;->getBatteryUsageStats(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/os/BatteryUsageStatsQuery;)Landroid/os/BatteryUsageStats;

    move-result-object v0

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    invoke-virtual {v1}, Lcom/android/internal/os/MonotonicClock;->monotonicTime()J

    move-result-wide v1

    invoke-virtual {v0}, Landroid/os/BatteryUsageStats;->getStatsDuration()J

    move-result-wide v3

    sub-long/2addr v1, v3

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    invoke-virtual {v3}, Lcom/android/internal/os/MonotonicClock;->write()V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsStore:Lcom/android/server/power/stats/PowerStatsStore;

    iget-object v3, p0, Lcom/android/server/power/stats/PowerStatsStore;->mHandler:Landroid/os/Handler;

    invoke-virtual {v3}, Landroid/os/Handler;->getLooper()Landroid/os/Looper;

    move-result-object v4

    invoke-virtual {v4}, Landroid/os/Looper;->isCurrentThread()Z

    move-result v4

    if-eqz v4, :cond_2

    invoke-virtual {p0, v1, v2, v0}, Lcom/android/server/power/stats/PowerStatsStore;->storeBatteryUsageStats(JLandroid/os/BatteryUsageStats;)V

    return-void

    :cond_2
    new-instance v4, Lcom/android/server/power/stats/PowerStatsStore$$ExternalSyntheticLambda2;

    invoke-direct {v4, p0, v1, v2, v0}, Lcom/android/server/power/stats/PowerStatsStore$$ExternalSyntheticLambda2;-><init>(Lcom/android/server/power/stats/PowerStatsStore;JLandroid/os/BatteryUsageStats;)V

    invoke-virtual {v3, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    return-void

    :catchall_0
    move-exception v0

    :try_start_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v0
.end method

.method public final scheduleNextResetWhilePluggedInCheck()V
    .locals 6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAlarmManager:Landroid/app/AlarmManager;

    if-nez v0, :cond_0

    return-void

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->RESET_WHILE_PLUGGED_IN_MINIMUM_DURATION_HOURS:I

    int-to-long v2, v2

    const-wide/32 v4, 0x36ee80

    mul-long/2addr v2, v4

    add-long/2addr v2, v0

    invoke-static {}, Ljava/util/Calendar;->getInstance()Ljava/util/Calendar;

    move-result-object v0

    invoke-virtual {v0, v2, v3}, Ljava/util/Calendar;->setTimeInMillis(J)V

    const/16 v1, 0xe

    const/4 v4, 0x0

    invoke-virtual {v0, v1, v4}, Ljava/util/Calendar;->set(II)V

    const/16 v1, 0xd

    invoke-virtual {v0, v1, v4}, Ljava/util/Calendar;->set(II)V

    const/16 v1, 0xc

    invoke-virtual {v0, v1, v4}, Ljava/util/Calendar;->set(II)V

    const/16 v1, 0xb

    const/4 v4, 0x2

    invoke-virtual {v0, v1, v4}, Ljava/util/Calendar;->set(II)V

    invoke-virtual {v0}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v0

    cmp-long v2, v0, v2

    if-gez v2, :cond_1

    const-wide/32 v2, 0x5265c00

    add-long/2addr v0, v2

    :cond_1
    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAlarmManager:Landroid/app/AlarmManager;

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda0;

    invoke-direct {v4, p0, v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/app/AlarmManager;J)V

    invoke-virtual {v3, v4}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    return-void
.end method

.method public final schedulePowerStatsSampleCollection()V
    .locals 1

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemReady:Z

    if-nez v0, :cond_0

    return-void

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakelockPowerStatsCollector:Lcom/android/server/power/stats/WakelockPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenPowerStatsCollector:Lcom/android/server/power/stats/ScreenPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerStatsCollector:Lcom/android/server/power/stats/MobileRadioPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerStatsCollector:Lcom/android/server/power/stats/WifiPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerStatsCollector:Lcom/android/server/power/stats/BluetoothPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraPowerStatsCollector:Lcom/android/server/power/stats/CameraPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGnssPowerStatsCollector:Lcom/android/server/power/stats/GnssPowerStatsCollector;

    invoke-virtual {v0}, Lcom/android/server/power/stats/PowerStatsCollector;->forceSchedule()Z

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    invoke-virtual {p0}, Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;->forceSchedule()Z

    return-void
.end method

.method public final scheduleSyncExternalStatsLocked(ILjava/lang/String;)V
    .locals 0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    if-eqz p0, :cond_0

    invoke-virtual {p0, p1, p2}, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->scheduleSync(ILjava/lang/String;)V

    :cond_0
    return-void
.end method

.method public final setBatteryStateLocked(IIIIIIIIJIIIIIJJJ)V
    .locals 34

    move-object/from16 v0, p0

    move/from16 v2, p1

    move/from16 v4, p2

    move/from16 v5, p3

    move/from16 v3, p4

    move/from16 v6, p5

    move/from16 v7, p6

    move/from16 v8, p7

    move/from16 v12, p11

    move/from16 v10, p12

    move/from16 v11, p13

    move/from16 v9, p14

    move/from16 v13, p15

    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    if-eqz v1, :cond_0

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    if-eq v1, v2, :cond_1

    :cond_0
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v1, 0x1f

    invoke-static {v1, v2}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_1
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    if-eqz v1, :cond_2

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPlugType:I

    if-eq v1, v5, :cond_3

    :cond_2
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v1, 0x20

    invoke-static {v1, v5}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_3
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    if-eqz v1, :cond_4

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    if-eq v1, v3, :cond_5

    :cond_4
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 v1, 0x1e

    invoke-static {v1, v3}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    :cond_5
    const/4 v15, 0x1

    if-nez v5, :cond_6

    if-eq v2, v15, :cond_6

    move/from16 v21, v15

    goto :goto_0

    :cond_6
    const/16 v21, 0x0

    :goto_0
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    if-nez v1, :cond_8

    iput-boolean v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHaveBatteryLevel:Z

    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    move/from16 v15, v21

    if-ne v15, v1, :cond_7

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    xor-int/lit8 v14, v15, 0x1

    invoke-virtual {v1, v14}, Lcom/android/internal/os/BatteryStatsHistory;->setPluggedInState(Z)V

    :cond_7
    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/4 v14, 0x1

    invoke-virtual {v1, v14, v2, v3, v8}, Lcom/android/internal/os/BatteryStatsHistory;->setBatteryState(ZIII)V

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastDischargeStepLevel:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinDischargeStepLevel:I

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxChargeStepLevel:I

    move/from16 v17, v15

    goto :goto_5

    :cond_8
    move v14, v15

    move/from16 v15, v21

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    if-ne v1, v3, :cond_a

    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eq v1, v15, :cond_9

    goto :goto_1

    :cond_9
    move/from16 v17, v15

    goto :goto_4

    :cond_a
    :goto_1
    const/16 v1, 0x64

    if-lt v3, v1, :cond_b

    if-eqz v15, :cond_b

    move v1, v14

    :goto_2
    move/from16 v17, v15

    move-wide/from16 v14, p20

    goto :goto_3

    :cond_b
    const/4 v1, 0x0

    goto :goto_2

    :goto_3
    invoke-virtual {v0, v14, v15, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->recordDailyStatsIfNeededLocked(JZ)V

    :goto_4
    const/4 v14, 0x0

    :goto_5
    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    if-eqz v17, :cond_d

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v15}, Lcom/android/internal/os/BatteryStatsHistory;->isRecordingHistory()Z

    move-result v15

    if-nez v15, :cond_c

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v20, 0x1

    move-wide/from16 v18, p18

    move/from16 p20, v14

    move/from16 v23, v17

    const/4 v14, 0x1

    move-wide/from16 v16, p16

    invoke-virtual/range {v15 .. v20}, Lcom/android/internal/os/BatteryStatsHistory;->startRecordingHistory(JJZ)V

    goto :goto_6

    :cond_c
    move/from16 p20, v14

    move/from16 v23, v17

    const/4 v14, 0x1

    goto :goto_6

    :cond_d
    move/from16 p20, v14

    move/from16 v23, v17

    const/4 v14, 0x1

    const/16 v15, 0x60

    if-ge v3, v15, :cond_e

    if-eq v2, v14, :cond_e

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v15}, Lcom/android/internal/os/BatteryStatsHistory;->isRecordingHistory()Z

    move-result v15

    if-nez v15, :cond_e

    iget-object v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/16 v20, 0x1

    move-wide/from16 v16, p16

    move-wide/from16 v18, p18

    invoke-virtual/range {v15 .. v20}, Lcom/android/internal/os/BatteryStatsHistory;->startRecordingHistory(JJZ)V

    :cond_e
    :goto_6
    iget v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    if-gez v15, :cond_f

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    :cond_f
    iget-boolean v15, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    move/from16 v14, v23

    if-eq v14, v15, :cond_28

    iput v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    iput v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHealth:I

    iput v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPlugType:I

    iput v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTemperature:I

    iput v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryVoltageMv:I

    iput v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecTxShareEvent:I

    iput v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecOnline:I

    iput v11, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecCurrentEvent:I

    iput v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecEvent:I

    iput v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOtgOnline:I

    move v15, v1

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual/range {v1 .. v13}, Lcom/android/internal/os/BatteryStatsHistory;->setBatteryState(IIIIIIIIIIII)V

    move v6, v3

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    if-ge v8, v1, :cond_11

    int-to-long v1, v1

    int-to-long v3, v8

    sub-long/2addr v1, v3

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v3}, Landroid/view/Display;->isDozeState(I)Z

    move-result v3

    if-eqz v3, :cond_10

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_10
    iget v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    const/4 v4, 0x1

    if-ne v3, v4, :cond_12

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_11
    const/4 v4, 0x2

    goto :goto_7

    :cond_12
    const/4 v4, 0x2

    if-ne v3, v4, :cond_13

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_13
    :goto_7
    iput v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    invoke-virtual {v1, v4}, Landroid/os/Handler;->obtainMessage(I)Landroid/os/Message;

    move-result-object v1

    iput v14, v1, Landroid/os/Message;->arg1:I

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    invoke-virtual {v2, v1}, Landroid/os/Handler;->sendMessage(Landroid/os/Message;)Z

    const-wide/16 v1, 0x3e8

    mul-long v9, p18, v1

    mul-long v11, p16, v1

    iget v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    if-eqz v14, :cond_24

    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNoAutoReset:Z

    if-eqz v1, :cond_15

    :cond_14
    :goto_8
    move-object v14, v0

    goto/16 :goto_b

    :cond_15
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemReady:Z

    if-nez v1, :cond_16

    goto :goto_8

    :cond_16
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v1}, Lcom/android/internal/os/BatteryStatsHistory;->isResetEnabled()Z

    move-result v1

    if-nez v1, :cond_17

    goto :goto_8

    :cond_17
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsConfig:Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;

    iget v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;->mFlags:I

    const/4 v14, 0x1

    and-int/2addr v1, v14

    if-ne v1, v14, :cond_19

    const/4 v1, 0x5

    if-ne v15, v1, :cond_18

    goto :goto_9

    :cond_18
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->gatBatteryHistoryResetLevel()I

    move-result v1

    if-lt v6, v1, :cond_19

    goto :goto_9

    :cond_19
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatsConfig:Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;

    iget v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsConfig;->mFlags:I

    const/4 v4, 0x2

    and-int/2addr v1, v4

    if-ne v1, v4, :cond_1a

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    const/16 v2, 0x14

    if-ge v1, v2, :cond_1a

    const/16 v1, 0x50

    if-lt v6, v1, :cond_1a

    goto :goto_9

    :cond_1a
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getHighDischargeAmountSinceCharge()I

    move-result v1

    const/16 v2, 0xc8

    if-lt v1, v2, :cond_14

    :goto_9
    const-string/jumbo v1, "Resetting battery stats: level="

    const-string v2, " status="

    const-string v3, " dischargeLevel="

    invoke-static {v6, v15, v1, v2, v3}, Lcom/android/internal/util/jobs/ArrayUtils$$ExternalSyntheticOutline0;->m(IILjava/lang/String;Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " lowAmount="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getLowDischargeAmountSinceCharge()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, " highAmount="

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getHighDischargeAmountSinceCharge()I

    move-result v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "BatteryStatsImpl"

    invoke-static {v2, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->getLowDischargeAmountSinceCharge()I

    move-result v1

    const/16 v2, 0x14

    if-lt v1, v2, :cond_1b

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    move-wide v3, v1

    invoke-static {}, Landroid/os/Parcel;->obtain()Landroid/os/Parcel;

    move-result-object v2

    const/4 v14, 0x1

    invoke-virtual {v0, v2, v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeSummaryToParcel(Landroid/os/Parcel;Z)V

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v13

    sub-long v3, v13, v3

    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;

    move-result-object v13

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$10;

    const/4 v5, 0x1

    move-object/from16 v1, p0

    invoke-direct/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$10;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Ljava/lang/Object;JI)V

    move-object v14, v1

    invoke-virtual {v13, v0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    goto :goto_a

    :cond_1b
    move-object v14, v0

    :goto_a
    const/4 v0, 0x3

    invoke-virtual {v14, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->startNewSession(I)V

    if-lez v8, :cond_1c

    if-lez v6, :cond_1c

    div-int/lit16 v0, v8, 0x3e8

    int-to-double v0, v0

    int-to-double v2, v6

    const-wide/high16 v4, 0x4059000000000000L    # 100.0

    div-double/2addr v2, v4

    div-double/2addr v0, v2

    double-to-int v0, v0

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    :cond_1c
    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    const/4 v5, 0x1

    const/4 v8, 0x1

    goto :goto_c

    :goto_b
    const/4 v5, 0x0

    const/4 v8, 0x0

    :goto_c
    iget-boolean v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mCharging:Z

    if-eqz v0, :cond_1d

    const/4 v0, 0x0

    invoke-virtual {v14, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->setChargingLocked(Z)Z

    :cond_1d
    const/4 v4, 0x1

    iput-boolean v4, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    iput-boolean v4, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    iput v6, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastDischargeStepLevel:I

    iput v6, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinDischargeStepLevel:I

    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->clearTime()V

    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->clearTime()V

    iget v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    const/4 v13, 0x0

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    invoke-virtual {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->pullPendingStateUpdatesLocked()V

    if-eqz v5, :cond_1e

    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v1, p16

    move-wide/from16 v3, p18

    invoke-virtual/range {v0 .. v5}, Lcom/android/internal/os/BatteryStatsHistory;->startRecordingHistory(JJZ)V

    move-wide/from16 v32, v3

    move-wide v4, v1

    move-wide/from16 v0, v32

    invoke-virtual {v14, v4, v5, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->initActiveHistoryEventsLocked(JJ)V

    goto :goto_d

    :cond_1e
    move-wide/from16 v4, p16

    move-wide/from16 v0, p18

    :goto_d
    iput-boolean v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedIn:Z

    iget-object v2, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mAlarmManager:Landroid/app/AlarmManager;

    if-eqz v2, :cond_1f

    iget-object v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v13, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda16;

    invoke-direct {v13, v14, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda16;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;Landroid/app/AlarmManager;)V

    invoke-virtual {v3, v13}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    :cond_1f
    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget-boolean v6, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedIn:Z

    move-wide v1, v4

    move/from16 v5, p4

    move-wide/from16 v3, p18

    invoke-virtual/range {v0 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordBatteryState(JJIZ)V

    move v3, v5

    move-wide v4, v1

    iput v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    iput v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    invoke-virtual {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v0

    invoke-virtual {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryCCInfo()I

    move-result v1

    invoke-static {v7}, Landroid/view/Display;->isOnState(I)Z

    move-result v2

    if-eqz v2, :cond_20

    iput v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    const/4 v13, 0x0

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    goto :goto_e

    :cond_20
    const/4 v13, 0x0

    invoke-static {v7}, Landroid/view/Display;->isDozeState(I)Z

    move-result v2

    if-eqz v2, :cond_21

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    goto :goto_e

    :cond_21
    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v3, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iput v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    :goto_e
    iget-boolean v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mIsSilentLogOn:Z

    if-eqz v1, :cond_23

    iget v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v1}, Landroid/view/Display;->isOnState(I)Z

    move-result v1

    if-eqz v1, :cond_22

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    goto :goto_f

    :cond_22
    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    goto :goto_f

    :cond_23
    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    :goto_f
    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    iput v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    const/4 v0, 0x1

    move/from16 p7, v0

    move/from16 p2, v7

    move-wide/from16 p3, v9

    move-wide/from16 p5, v11

    move-object/from16 p1, v14

    invoke-virtual/range {p1 .. p7}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateTimeBasesLocked(IJJZ)V

    move-object/from16 v6, p1

    move v1, v8

    goto :goto_10

    :cond_24
    move-wide v3, v11

    move v11, v7

    move-wide v7, v9

    move-wide v9, v3

    move-wide/from16 v4, p16

    move-object v14, v0

    move v3, v6

    const/4 v13, 0x0

    iput-boolean v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    iput-boolean v13, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    invoke-virtual {v14}, Lcom/android/server/power/stats/BatteryStatsImpl;->pullPendingStateUpdatesLocked()V

    const/4 v6, 0x1

    iput-boolean v6, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedIn:Z

    iput-wide v4, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedInRealTimeMs:J

    iget-object v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v1, v4

    move v5, v3

    move-wide/from16 v3, p18

    invoke-virtual/range {v0 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordBatteryState(JJIZ)V

    move v12, v5

    iput v12, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    iput v12, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iget v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    if-ge v12, v0, :cond_25

    iget v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mLowDischargeAmountSinceCharge:I

    sub-int/2addr v0, v12

    add-int/lit8 v2, v0, -0x1

    add-int/2addr v2, v1

    iput v2, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mLowDischargeAmountSinceCharge:I

    iget v1, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHighDischargeAmountSinceCharge:I

    add-int/2addr v0, v1

    iput v0, v14, Lcom/android/server/power/stats/BatteryStatsImpl;->mHighDischargeAmountSinceCharge:I

    :cond_25
    invoke-virtual {v14, v11, v11}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateDischargeScreenLevelsLocked(II)V

    const/4 v6, 0x0

    move-wide v2, v7

    move-wide v4, v9

    move v1, v11

    move-object v0, v14

    invoke-virtual/range {v0 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateTimeBasesLocked(IJJZ)V

    move-object v6, v0

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v0}, Landroid/os/BatteryStats$LevelStepTracker;->init()V

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxChargeStepLevel:I

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    const/4 v13, 0x0

    iput v13, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleNextResetWhilePluggedInCheck()V

    const/4 v1, 0x0

    :goto_10
    if-nez v1, :cond_26

    iget-wide v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWriteTimeMs:J

    const-wide/32 v2, 0xea60

    add-long/2addr v0, v2

    cmp-long v0, v0, p16

    if-gez v0, :cond_27

    :cond_26
    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    if-eqz v0, :cond_27

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0}, Lcom/android/internal/os/BatteryStatsHistory;->isReadOnly()Z

    move-result v0

    if-nez v0, :cond_27

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeAsyncLocked()V

    :cond_27
    const/4 v15, 0x1

    :goto_11
    move/from16 v14, p8

    goto/16 :goto_1a

    :cond_28
    move v1, v6

    move-object v6, v0

    move v0, v1

    move v1, v12

    move/from16 v23, v14

    move-wide/from16 v14, p18

    move v12, v3

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    if-eq v3, v12, :cond_29

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    const/16 p20, 0x1

    const/16 v18, 0x1

    goto :goto_12

    :cond_29
    move/from16 v18, p20

    const/16 p20, 0x0

    :goto_12
    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    if-eq v3, v2, :cond_2a

    iput v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    const/4 v2, 0x1

    goto :goto_13

    :cond_2a
    move/from16 v2, p20

    :goto_13
    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHealth:I

    if-eq v3, v4, :cond_2b

    iput v4, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHealth:I

    const/4 v2, 0x1

    :cond_2b
    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPlugType:I

    if-eq v3, v5, :cond_2c

    iput v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPlugType:I

    const/4 v2, 0x1

    :cond_2c
    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTemperature:I

    add-int/lit8 v4, v3, 0xa

    if-ge v0, v4, :cond_2d

    add-int/lit8 v3, v3, -0xa

    if-gt v0, v3, :cond_2e

    :cond_2d
    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTemperature:I

    const/4 v2, 0x1

    :cond_2e
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryVoltageMv:I

    add-int/lit8 v3, v0, 0x14

    if-gt v7, v3, :cond_2f

    const/16 v3, 0x14

    sub-int/2addr v0, v3

    if-ge v7, v0, :cond_30

    :cond_2f
    iput v7, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryVoltageMv:I

    const/4 v2, 0x1

    :cond_30
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecTxShareEvent:I

    if-eq v0, v9, :cond_31

    iput v9, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecTxShareEvent:I

    const/4 v2, 0x1

    :cond_31
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecOnline:I

    if-eq v0, v10, :cond_32

    iput v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecOnline:I

    const/4 v2, 0x1

    :cond_32
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecCurrentEvent:I

    if-eq v0, v11, :cond_33

    iput v11, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecCurrentEvent:I

    const/4 v2, 0x1

    :cond_33
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecEvent:I

    if-eq v0, v1, :cond_34

    iput v1, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecEvent:I

    const/4 v2, 0x1

    :cond_34
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mOtgOnline:I

    if-eq v0, v13, :cond_35

    iput v13, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mOtgOnline:I

    const/4 v2, 0x1

    :cond_35
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    add-int/lit8 v1, v0, 0xa

    if-ge v8, v1, :cond_36

    add-int/lit8 v1, v0, -0xa

    if-gt v8, v1, :cond_3a

    :cond_36
    if-ge v8, v0, :cond_39

    int-to-long v0, v0

    int-to-long v2, v8

    sub-long/2addr v0, v2

    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v2}, Landroid/view/Display;->isDozeState(I)Z

    move-result v2

    if-eqz v2, :cond_37

    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_37
    iget v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleMode:I

    const/4 v4, 0x1

    if-ne v2, v4, :cond_38

    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    goto :goto_14

    :cond_38
    const/4 v4, 0x2

    if-ne v2, v4, :cond_39

    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_39
    :goto_14
    iput v8, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    const/4 v2, 0x1

    :cond_3a
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    int-to-long v0, v0

    const/16 v3, 0x30

    shl-long/2addr v0, v3

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    int-to-long v3, v3

    const/16 v5, 0x38

    shl-long/2addr v3, v5

    or-long/2addr v0, v3

    and-int/lit16 v3, v12, 0xff

    int-to-long v3, v3

    const/16 v5, 0x28

    shl-long/2addr v3, v5

    or-long/2addr v0, v3

    if-eqz v23, :cond_3c

    const/4 v13, 0x0

    invoke-virtual {v6, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->setChargingLocked(Z)Z

    move-result v3

    or-int v7, v2, v3

    iget v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastDischargeStepLevel:I

    if-eq v2, v12, :cond_3b

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinDischargeStepLevel:I

    if-le v3, v12, :cond_3b

    move-wide/from16 v32, v0

    move v1, v2

    move-wide/from16 v2, v32

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    sub-int/2addr v1, v12

    move-wide/from16 v4, p16

    invoke-virtual/range {v0 .. v5}, Landroid/os/BatteryStats$LevelStepTracker;->addLevelSteps(IJJ)V

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v1, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastDischargeStepLevel:I

    sub-int/2addr v1, v12

    invoke-virtual/range {v0 .. v5}, Landroid/os/BatteryStats$LevelStepTracker;->addLevelSteps(IJJ)V

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastDischargeStepLevel:I

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinDischargeStepLevel:I

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    const/4 v13, 0x0

    iput v13, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    :cond_3b
    move-wide/from16 v4, p16

    goto/16 :goto_19

    :cond_3c
    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->BATTERY_CHARGING_ENFORCE_LEVEL:I

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->gatBatteryHistoryResetLevel()I

    move-result v4

    invoke-static {v3, v4}, Ljava/lang/Math;->min(II)I

    move-result v3

    if-lt v12, v3, :cond_3e

    const/4 v4, 0x1

    invoke-virtual {v6, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->setChargingLocked(Z)Z

    move-result v3

    :goto_15
    or-int/2addr v2, v3

    :cond_3d
    :goto_16
    move v7, v2

    goto :goto_17

    :cond_3e
    iget-boolean v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mCharging:Z

    if-nez v3, :cond_40

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    if-ge v3, v12, :cond_3f

    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    iget-object v4, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

    invoke-virtual {v3, v4}, Landroid/os/Handler;->hasCallbacks(Ljava/lang/Runnable;)Z

    move-result v3

    if-nez v3, :cond_3d

    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    iget-object v4, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

    iget-object v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->BATTERY_CHARGED_DELAY_MS:I

    int-to-long v7, v5

    invoke-virtual {v3, v4, v7, v8}, Landroid/os/Handler;->postDelayed(Ljava/lang/Runnable;J)Z

    goto :goto_16

    :cond_3f
    if-le v3, v12, :cond_3d

    iget-object v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    iget-object v4, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

    invoke-virtual {v3, v4}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    goto :goto_16

    :cond_40
    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    if-le v3, v12, :cond_3d

    const/4 v13, 0x0

    invoke-virtual {v6, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->setChargingLocked(Z)Z

    move-result v3

    goto :goto_15

    :goto_17
    iget v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    if-eq v2, v12, :cond_41

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxChargeStepLevel:I

    if-ge v3, v12, :cond_41

    move-wide/from16 v32, v0

    move v1, v2

    move-wide/from16 v2, v32

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    sub-int v1, v12, v1

    move-wide/from16 v4, p16

    invoke-virtual/range {v0 .. v5}, Landroid/os/BatteryStats$LevelStepTracker;->addLevelSteps(IJJ)V

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    iget v1, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    sub-int v1, v12, v1

    invoke-virtual/range {v0 .. v5}, Landroid/os/BatteryStats$LevelStepTracker;->addLevelSteps(IJJ)V

    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxChargeStepLevel:I

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurStepMode:I

    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mInitStepMode:I

    const/4 v13, 0x0

    iput v13, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mModStepMode:I

    goto :goto_18

    :cond_41
    move-wide/from16 v4, p16

    :goto_18
    iput v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastChargeStepLevel:I

    :goto_19
    if-eqz v7, :cond_42

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget v1, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryStatus:I

    iget v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    iget v3, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryHealth:I

    iget v7, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPlugType:I

    iget v8, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTemperature:I

    iget v9, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryVoltageMv:I

    iget v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryChargeUah:I

    iget v11, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecTxShareEvent:I

    iget v12, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecOnline:I

    iget v13, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecCurrentEvent:I

    move-object/from16 v19, v0

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatterySecEvent:I

    move/from16 v30, v0

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mOtgOnline:I

    move/from16 v31, v0

    move/from16 v20, v1

    move/from16 v21, v2

    move/from16 v22, v3

    move/from16 v23, v7

    move/from16 v24, v8

    move/from16 v25, v9

    move/from16 v26, v10

    move/from16 v27, v11

    move/from16 v28, v12

    move/from16 v29, v13

    invoke-virtual/range {v19 .. v31}, Lcom/android/internal/os/BatteryStatsHistory;->setBatteryState(IIIIIIIIIIII)V

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0, v4, v5, v14, v15}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    :cond_42
    move/from16 v15, v18

    goto/16 :goto_11

    :goto_1a
    iput v14, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    const/4 v1, -0x1

    if-ne v0, v1, :cond_43

    iput v14, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    goto :goto_1b

    :cond_43
    invoke-static {v0, v14}, Ljava/lang/Math;->min(II)I

    move-result v0

    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    :goto_1b
    iget v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    invoke-static {v0, v14}, Ljava/lang/Math;->max(II)I

    move-result v0

    iput v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    move-wide/from16 v0, p9

    iput-wide v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTimeToFullSeconds:J

    iget-boolean v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mAccumulateBatteryUsageStats:Z

    if-eqz v0, :cond_45

    iget-object v1, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryUsageStatsProvider:Lcom/android/server/power/stats/BatteryUsageStatsProvider;

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    monitor-enter v1

    :try_start_0
    iget-object v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v2}, Lcom/android/internal/os/BatteryStatsHistory;->getMonotonicHistorySize()J

    move-result-wide v2

    iget-wide v4, v1, Lcom/android/server/power/stats/BatteryUsageStatsProvider;->mLastAccumulationMonotonicHistorySize:J

    sub-long v4, v2, v4

    iget v7, v1, Lcom/android/server/power/stats/BatteryUsageStatsProvider;->mAccumulatedBatteryUsageStatsSpanSize:I

    int-to-long v7, v7

    cmp-long v4, v4, v7

    if-gez v4, :cond_44

    monitor-exit v1

    goto :goto_1d

    :catchall_0
    move-exception v0

    goto :goto_1c

    :cond_44
    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryUsageStatsProvider;->mLastAccumulationMonotonicHistorySize:J

    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    invoke-virtual {v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryStatsSession()Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;

    move-result-object v2

    new-instance v3, Lcom/android/server/power/stats/BatteryUsageStatsProvider$$ExternalSyntheticLambda1;

    invoke-direct {v3, v1, v2, v0}, Lcom/android/server/power/stats/BatteryUsageStatsProvider$$ExternalSyntheticLambda1;-><init>(Lcom/android/server/power/stats/BatteryUsageStatsProvider;Lcom/android/server/power/stats/BatteryStatsImpl$BatteryStatsSession;Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;)V

    invoke-virtual {v0, v3}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    goto :goto_1d

    :goto_1c
    :try_start_1
    monitor-exit v1
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw v0

    :cond_45
    :goto_1d
    if-eqz v15, :cond_46

    iget-object v0, v6, Lcom/android/server/power/stats/BatteryStatsImpl;->mStepDetailsProvider:Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;->mBatteryStats:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v2, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider$$ExternalSyntheticLambda0;

    invoke-direct {v2, v0}, Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider$$ExternalSyntheticLambda0;-><init>(Lcom/android/server/power/stats/BatteryHistoryStepDetailsProvider;)V

    invoke-virtual {v1, v2}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    :cond_46
    return-void
.end method

.method public final setChargingLocked(Z)Z
    .locals 2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeferSetCharging:Lcom/android/server/power/stats/BatteryStatsImpl$5;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCharging:Z

    if-eq v0, p1, :cond_0

    iput-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCharging:Z

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0, p1}, Lcom/android/internal/os/BatteryStatsHistory;->setChargingState(Z)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    const/4 p1, 0x3

    invoke-virtual {p0, p1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    const/4 p0, 0x1

    return p0

    :cond_0
    const/4 p0, 0x0

    return p0
.end method

.method public final setPowerStatsCollectorEnabled(I)V
    .locals 2

    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v1, 0x1

    invoke-virtual {v0, p1, v1}, Landroid/util/SparseBooleanArray;->put(IZ)V

    monitor-exit p0

    return-void

    :catchall_0
    move-exception p1

    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw p1
.end method

.method public final setRecordAllHistoryLocked(Z)V
    .locals 12

    iput-boolean p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mRecordAllHistory:Z

    const/4 v0, 0x0

    const/4 v1, 0x1

    if-nez p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const/4 v2, 0x5

    invoke-virtual {p1, v2}, Landroid/os/BatteryStats$HistoryEventTracker;->removeEvents(I)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    const/16 v2, 0xd

    invoke-virtual {p1, v2}, Landroid/os/BatteryStats$HistoryEventTracker;->removeEvents(I)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {p1, v1}, Landroid/os/BatteryStats$HistoryEventTracker;->getStateForEvent(I)Ljava/util/HashMap;

    move-result-object p1

    if-eqz p1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v5

    invoke-virtual {p1}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object p1

    invoke-interface {p1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object p1

    :cond_0
    invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_3

    invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/Map$Entry;

    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    move-object v10, v2

    check-cast v10, Landroid/util/SparseIntArray;

    move v11, v0

    :goto_0
    invoke-virtual {v10}, Landroid/util/SparseIntArray;->size()I

    move-result v2

    if-ge v11, v2, :cond_0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-interface {v1}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v7

    move-object v8, v7

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v10, v11}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v9

    const/16 v7, 0x4001

    invoke-virtual/range {v2 .. v9}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    add-int/lit8 v11, v11, 0x1

    goto :goto_0

    :cond_1
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mActiveEvents:Landroid/os/BatteryStats$HistoryEventTracker;

    invoke-virtual {p1, v1}, Landroid/os/BatteryStats$HistoryEventTracker;->getStateForEvent(I)Ljava/util/HashMap;

    move-result-object p1

    if-eqz p1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v5

    invoke-virtual {p1}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object p1

    invoke-interface {p1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object p1

    :cond_2
    invoke-interface {p1}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_3

    invoke-interface {p1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/Map$Entry;

    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    move-object v10, v2

    check-cast v10, Landroid/util/SparseIntArray;

    move v11, v0

    :goto_1
    invoke-virtual {v10}, Landroid/util/SparseIntArray;->size()I

    move-result v2

    if-ge v11, v2, :cond_2

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-interface {v1}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v7

    move-object v8, v7

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v10, v11}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v9

    const v7, 0x8001

    invoke-virtual/range {v2 .. v9}, Lcom/android/internal/os/BatteryStatsHistory;->recordEvent(JJILjava/lang/String;I)V

    add-int/lit8 v11, v11, 0x1

    goto :goto_1

    :cond_3
    return-void
.end method

.method public final setTemperatureNCurrentLocked(IIJJII)V
    .locals 10

    move/from16 v0, p7

    move/from16 v1, p8

    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAp_temp:I

    const/4 v3, 0x1

    if-eq v2, p1, :cond_0

    int-to-byte p1, p1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAp_temp:I

    move p1, v3

    goto :goto_0

    :cond_0
    const/4 p1, 0x0

    :goto_0
    iget v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPa_temp:I

    if-eq v2, p2, :cond_1

    int-to-byte p1, p2

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPa_temp:I

    move p1, v3

    :cond_1
    iget p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSkin_temp:I

    if-eq p2, v0, :cond_2

    int-to-byte p1, v0

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSkin_temp:I

    move p1, v3

    :cond_2
    iget p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurrent:I

    if-eq p2, v1, :cond_3

    int-to-short p1, v1

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurrent:I

    goto :goto_1

    :cond_3
    move v3, p1

    :goto_1
    if-eqz v3, :cond_4

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    iget v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mAp_temp:I

    iget v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPa_temp:I

    iget v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSkin_temp:I

    iget v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSub_batt_temp:I

    iget v9, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCurrent:I

    invoke-virtual/range {v4 .. v9}, Lcom/android/internal/os/BatteryStatsHistory;->setTemperatureNCurrent(IIIII)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v0, p5

    invoke-virtual {p0, p3, p4, v0, v1}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    :cond_4
    return-void
.end method

.method public final startAddingCpuStatsLocked()Z
    .locals 2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mExternalSync:Lcom/android/server/power/stats/BatteryExternalStatsWorker;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryExternalStatsWorker;->mHandler:Landroid/os/Handler;

    const/4 v1, 0x2

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeMessages(I)V

    iget-boolean p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    return p0
.end method

.method public final startNewSession(I)V
    .locals 6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    invoke-virtual {v0}, Lcom/android/internal/os/MonotonicClock;->monotonicTime()J

    move-result-wide v0

    iget-wide v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicStartTime:J

    const-wide/32 v4, 0xea60

    add-long/2addr v2, v4

    cmp-long v0, v0, v2

    if-gez v0, :cond_0

    const-string p0, "BatteryStatsImpl"

    const-string p1, "Battery session session duration is too short, ignoring reset request"

    invoke-static {p0, p1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    return-void

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda5;

    const/4 v2, 0x0

    invoke-direct {v1, p1, v2, p0}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda5;-><init>(IILjava/lang/Object;)V

    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    return-void
.end method

.method public final stopAllGpsSignalQualityTimersLocked(J)V
    .locals 2

    const/4 v0, 0x0

    :goto_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v1, v1

    if-ge v0, v1, :cond_2

    const/4 v1, -0x1

    if-ne v0, v1, :cond_0

    goto :goto_2

    :cond_0
    :goto_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v1, v1, v0

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-eqz v1, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v1, v1, v0

    invoke-virtual {v1, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_1

    :cond_1
    :goto_2
    add-int/lit8 v0, v0, 0x1

    goto :goto_0

    :cond_2
    return-void
.end method

.method public final systemServicesReady(Landroid/content/Context;)V
    .locals 13

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    invoke-virtual {p1}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    iput-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "battery_stats_constants"

    invoke-static {v2}, Landroid/provider/Settings$Global;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    const/4 v3, 0x0

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "battery_charging_state_update_delay"

    invoke-static {v2}, Landroid/provider/Settings$Global;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "battery_charging_state_enforce_level"

    invoke-static {v2}, Landroid/provider/Settings$Global;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "protect_battery"

    invoke-static {v2}, Landroid/provider/Settings$Global;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "screen_brightness_mode"

    invoke-static {v2}, Landroid/provider/Settings$System;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "refresh_rate_mode"

    invoke-static {v2}, Landroid/provider/Settings$Secure;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "refresh_rate_mode_cover"

    invoke-static {v2}, Landroid/provider/Settings$Secure;->getUriFor(Ljava/lang/String;)Landroid/net/Uri;

    move-result-object v2

    invoke-virtual {v0, v2, v3, v1}, Landroid/content/ContentResolver;->registerContentObserver(Landroid/net/Uri;ZLandroid/database/ContentObserver;)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->updateConstants()V

    :try_start_0
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->mResolver:Landroid/content/ContentResolver;

    const-string/jumbo v2, "screen_brightness_mode"

    invoke-static {v0, v2}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;)I

    move-result v0

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->this$0:Lcom/android/server/power/stats/BatteryStatsImpl;

    invoke-virtual {v2, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteScreenAutoBrightnessLocked(I)V
    :try_end_0
    .catch Landroid/provider/Settings$SettingNotFoundException; {:try_start_0 .. :try_end_0} :catch_0

    goto :goto_0

    :catch_0
    move-exception v0

    invoke-virtual {v0}, Landroid/provider/Settings$SettingNotFoundException;->printStackTrace()V

    :goto_0
    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->updateDisplayHighRefreshRateLocked()V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->updateProtectBatteryModeLocked()V

    new-instance v0, Landroid/content/IntentFilter;

    invoke-direct {v0}, Landroid/content/IntentFilter;-><init>()V

    const-string/jumbo v1, "android.hardware.usb.action.USB_STATE"

    invoke-virtual {v0, v1}, Landroid/content/IntentFilter;->addAction(Ljava/lang/String;)V

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$7;

    const/4 v2, 0x1

    invoke-direct {v1, p0, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$7;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;I)V

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    const/4 v4, 0x0

    invoke-virtual {p1, v1, v0, v4, v2}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;)Landroid/content/Intent;

    monitor-enter p0

    :try_start_1
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUsbDataState:I

    const/4 v2, 0x1

    if-nez v1, :cond_1

    invoke-virtual {p1, v4, v0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    move-result-object v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_2

    if-eqz v0, :cond_0

    :try_start_2
    const-string/jumbo v1, "connected"

    invoke-virtual {v0, v1, v3}, Landroid/content/Intent;->getBooleanExtra(Ljava/lang/String;Z)Z

    move-result v0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    if-eqz v0, :cond_0

    move v10, v2

    goto :goto_1

    :catchall_0
    move-exception v0

    move-object p1, v0

    move-object v5, p0

    goto/16 :goto_d

    :cond_0
    move v10, v3

    :goto_1
    :try_start_3
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v8
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_2

    move-object v5, p0

    :try_start_4
    invoke-virtual/range {v5 .. v10}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteUsbConnectionStateLocked(JJZ)V

    goto :goto_3

    :catchall_1
    move-exception v0

    :goto_2
    move-object p1, v0

    goto/16 :goto_d

    :catchall_2
    move-exception v0

    move-object v5, p0

    goto :goto_2

    :cond_1
    move-object v5, p0

    :goto_3
    monitor-exit v5
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_1

    const-string/jumbo p0, "com.sec.modem.settings.cplogging.ACTION_SILENTLOG_START"

    const-string/jumbo v0, "com.sec.modem.settings.cplogging.ACTION_SILENTLOG_STOP"

    invoke-static {p0, v0}, Lcom/android/server/DirEncryptServiceHelper$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Landroid/content/IntentFilter;

    move-result-object v8

    new-instance v7, Lcom/android/server/power/stats/BatteryStatsImpl$7;

    const/4 p0, 0x0

    invoke-direct {v7, v5, p0}, Lcom/android/server/power/stats/BatteryStatsImpl$7;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;I)V

    iget-object v10, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    const/4 v11, 0x2

    const-string/jumbo v9, "com.sec.modem.settings.cplogging.permission.SILENTLOG"

    move-object v6, p1

    invoke-virtual/range {v6 .. v11}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;Ljava/lang/String;Landroid/os/Handler;I)Landroid/content/Intent;

    const-string/jumbo p0, "android.net.wifi.WIFI_AP_STATE_CHANGED"

    invoke-static {p0}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;)Landroid/content/IntentFilter;

    move-result-object p0

    new-instance p1, Lcom/android/server/power/stats/BatteryStatsImpl$7;

    const/4 v0, 0x2

    invoke-direct {p1, v5, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$7;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;I)V

    invoke-virtual {v6, p1, p0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    monitor-enter v5

    :try_start_5
    iget p1, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mUsbDataState:I

    const/16 v0, 0xe

    if-ne p1, v0, :cond_4

    invoke-virtual {v6, v4, p0}, Landroid/content/Context;->registerReceiver(Landroid/content/BroadcastReceiver;Landroid/content/IntentFilter;)Landroid/content/Intent;

    move-result-object p0

    if-eqz p0, :cond_2

    const-string/jumbo p1, "wifi_state"

    invoke-virtual {p0, p1, v0}, Landroid/content/Intent;->getIntExtra(Ljava/lang/String;I)I

    move-result v0

    goto :goto_4

    :catchall_3
    move-exception v0

    move-object p0, v0

    goto/16 :goto_c

    :cond_2
    :goto_4
    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide p0

    iget-object v1, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v7

    const/16 v1, 0xd

    if-ne v0, v1, :cond_3

    move v1, v2

    goto :goto_5

    :cond_3
    move v1, v3

    :goto_5
    iget v9, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHotspotState:I

    if-eq v9, v0, :cond_4

    iput v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHotspotState:I

    iget-object v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0, v1}, Lcom/android/internal/os/BatteryStatsHistory;->setWifiApState(Z)V

    iget-object v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v0, p0, p1, v7, v8}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    :cond_4
    monitor-exit v5
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_3

    iput-boolean v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemServicesReady:Z

    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {p0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide p0

    iput-wide p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryCCUpdateTime:J

    iput-wide p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBatteryRawUpdateTime:J

    iget-boolean p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingReportCharging:Z

    if-eqz p0, :cond_5

    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    const/4 p1, 0x3

    invoke-virtual {p0, p1}, Landroid/os/Handler;->sendEmptyMessage(I)Z

    iput-boolean v3, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mPendingReportCharging:Z

    :cond_5
    const-string/jumbo p0, "phone"

    invoke-virtual {v6, p0}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Landroid/telephony/TelephonyManager;

    iput-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mTelephonyManager:Landroid/telephony/TelephonyManager;

    new-instance p0, Lcom/android/server/power/stats/BatteryStatsImpl$CustomTelephonyCallback;

    invoke-direct {p0, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$CustomTelephonyCallback;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;)V

    iput-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomTelephonyCallback:Lcom/android/server/power/stats/BatteryStatsImpl$CustomTelephonyCallback;

    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mTelephonyManager:Landroid/telephony/TelephonyManager;

    new-instance p1, Landroid/os/HandlerExecutor;

    iget-object v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    invoke-direct {p1, v0}, Landroid/os/HandlerExecutor;-><init>(Landroid/os/Handler;)V

    iget-object v0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomTelephonyCallback:Lcom/android/server/power/stats/BatteryStatsImpl$CustomTelephonyCallback;

    invoke-virtual {p0, p1, v0}, Landroid/telephony/TelephonyManager;->registerTelephonyCallback(Ljava/util/concurrent/Executor;Landroid/telephony/TelephonyCallback;)V

    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-virtual {p0}, Ljava/io/File;->list()[Ljava/lang/String;

    move-result-object p0

    if-eqz p0, :cond_b

    array-length p1, p0

    move v0, v3

    :goto_6
    if-ge v0, p1, :cond_b

    aget-object v1, p0, v0

    const-string v7, "BCheck"

    invoke-virtual {v1, v7}, Ljava/lang/String;->startsWith(Ljava/lang/String;)Z

    move-result v7

    if-eqz v7, :cond_6

    new-instance v7, Ljava/io/File;

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-direct {v7, v8, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    const-string v8, "BatteryStatsImpl"

    const-string v9, " has been deleted ("

    invoke-static {v1, v9}, Lcom/android/internal/util/jobs/Preconditions$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v7}, Ljava/io/File;->delete()Z

    move-result v7

    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Z)Ljava/lang/StringBuilder;

    const-string v7, ")"

    invoke-virtual {v1, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v8, v1}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto/16 :goto_8

    :cond_6
    const-string/jumbo v7, "batterystats.bin"

    invoke-virtual {v1, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_7

    new-instance v7, Ljava/io/File;

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-direct {v7, v8, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    const-string v1, "BatteryStatsImpl"

    new-instance v8, Ljava/lang/StringBuilder;

    const-string/jumbo v9, "stats, "

    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v7}, Ljava/io/File;->length()J

    move-result-wide v9

    invoke-virtual {v8, v9, v10}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo v7, "bytes"

    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v1, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_8

    :cond_7
    const-string/jumbo v7, "batterystats-daily.xml"

    invoke-virtual {v1, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_8

    new-instance v7, Ljava/io/File;

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-direct {v7, v8, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    const-string v1, "BatteryStatsImpl"

    new-instance v8, Ljava/lang/StringBuilder;

    const-string/jumbo v9, "daily, "

    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v7}, Ljava/io/File;->length()J

    move-result-wide v9

    invoke-virtual {v8, v9, v10}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo v7, "bytes"

    invoke-virtual {v8, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v7

    invoke-static {v1, v7}, Landroid/util/Slog;->i(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_8

    :cond_8
    const-string/jumbo v7, "battery-history"

    invoke-virtual {v1, v7}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z

    move-result v7

    if-eqz v7, :cond_a

    new-instance v7, Ljava/io/File;

    iget-object v8, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemDir:Ljava/io/File;

    invoke-direct {v7, v8, v1}, Ljava/io/File;-><init>(Ljava/io/File;Ljava/lang/String;)V

    invoke-virtual {v7}, Ljava/io/File;->listFiles()[Ljava/io/File;

    move-result-object v1

    if-eqz v1, :cond_a

    array-length v7, v1

    const-wide/16 v8, 0x0

    move v10, v3

    :goto_7
    if-ge v10, v7, :cond_9

    aget-object v11, v1, v10

    invoke-virtual {v11}, Ljava/io/File;->length()J

    move-result-wide v11

    add-long/2addr v8, v11

    add-int/lit8 v10, v10, 0x1

    goto :goto_7

    :cond_9
    const-string v7, "BatteryStatsImpl"

    new-instance v10, Ljava/lang/StringBuilder;

    const-string/jumbo v11, "history, "

    invoke-direct {v10, v11}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    array-length v1, v1

    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string/jumbo v1, "files, "

    invoke-virtual {v10, v1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v10, v8, v9}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string/jumbo v1, "bytes"

    invoke-static {v10, v1, v7}, Lcom/android/server/DeviceIdleController$$ExternalSyntheticOutline0;->m(Ljava/lang/StringBuilder;Ljava/lang/String;Ljava/lang/String;)V

    :cond_a
    :goto_8
    add-int/lit8 v0, v0, 0x1

    goto/16 :goto_6

    :cond_b
    new-instance p0, Ljava/io/File;

    const-string p1, "/sys/class/power_supply/battery"

    const-string/jumbo v0, "time_to_full_now"

    invoke-direct {p0, p1, v0}, Ljava/io/File;-><init>(Ljava/lang/String;Ljava/lang/String;)V

    invoke-virtual {p0}, Ljava/io/File;->exists()Z

    move-result p0

    if-nez p0, :cond_c

    iput-boolean v3, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mFeatureComputeChargeTimeModel:Z

    :cond_c
    monitor-enter v5

    :try_start_6
    const-class p0, Landroid/app/AlarmManager;

    invoke-virtual {v6, p0}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object p0

    check-cast p0, Landroid/app/AlarmManager;

    iput-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mAlarmManager:Landroid/app/AlarmManager;

    iget-boolean p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryPluggedIn:Z

    if-eqz p0, :cond_d

    invoke-virtual {v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->scheduleNextResetWhilePluggedInCheck()V

    goto :goto_9

    :catchall_4
    move-exception v0

    move-object p0, v0

    goto :goto_b

    :cond_d
    :goto_9
    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerManagerFlags:Lcom/android/server/power/feature/PowerManagerFlags;

    iget-object p0, p0, Lcom/android/server/power/feature/PowerManagerFlags;->mFrameworkWakelockInfo:Lcom/android/server/power/feature/PowerManagerFlags$FlagState;

    invoke-virtual {p0}, Lcom/android/server/power/feature/PowerManagerFlags$FlagState;->isEnabled()Z

    move-result p0

    if-eqz p0, :cond_10

    iget-object p0, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkEvents:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;

    iget-boolean p1, p0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mIsInitialized:Z

    if-eqz p1, :cond_e

    goto :goto_a

    :cond_e
    const-class p1, Landroid/app/StatsManager;

    invoke-virtual {v6, p1}, Landroid/content/Context;->getSystemService(Ljava/lang/Class;)Ljava/lang/Object;

    move-result-object p1

    check-cast p1, Landroid/app/StatsManager;

    const-string v0, "BatteryStatsPulledMetrics"

    if-nez p1, :cond_f

    const-string p0, "Error retrieving StatsManager. Cannot initialize BatteryStatsPulledMetrics."

    invoke-static {v0, p0}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_a

    :cond_f
    const-string/jumbo v1, "Registering callback with StatsManager"

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    sget-object v0, Lcom/android/internal/util/ConcurrentUtils;->DIRECT_EXECUTOR:Ljava/util/concurrent/Executor;

    iget-object v1, p0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mStatsPullCallbackHandler:Lcom/android/server/power/stats/WakelockStatsFrameworkEvents$StatsPullCallbackHandler;

    const/16 v3, 0x27f6

    invoke-virtual {p1, v3, v4, v0, v1}, Landroid/app/StatsManager;->setPullAtomCallback(ILandroid/app/StatsManager$PullAtomMetadata;Ljava/util/concurrent/Executor;Landroid/app/StatsManager$StatsPullAtomCallback;)V

    iput-boolean v2, p0, Lcom/android/server/power/stats/WakelockStatsFrameworkEvents;->mIsInitialized:Z

    :cond_10
    :goto_a
    monitor-exit v5

    return-void

    :goto_b
    monitor-exit v5
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_4

    throw p0

    :goto_c
    :try_start_7
    monitor-exit v5
    :try_end_7
    .catchall {:try_start_7 .. :try_end_7} :catchall_3

    throw p0

    :goto_d
    :try_start_8
    monitor-exit v5
    :try_end_8
    .catchall {:try_start_8 .. :try_end_8} :catchall_1

    throw p1
.end method

.method public final updateAllPhoneStateLocked(IIIJJ)V
    .locals 12

    move-wide/from16 v2, p4

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceStateRaw:I

    iput p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSimStateRaw:I

    iput p3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthBinRaw:I

    const/4 v4, 0x0

    const/4 v5, 0x1

    if-ne p2, v5, :cond_0

    if-ne p1, v5, :cond_0

    if-lez p3, :cond_0

    move p1, v4

    :cond_0
    const/16 v6, 0x5e

    const/4 v7, 0x3

    const/high16 v8, 0x200000

    const/4 v9, -0x1

    if-ne p1, v7, :cond_1

    move v7, v4

    move v10, v7

    move v11, v5

    move v1, v9

    :goto_0
    move v5, v10

    goto :goto_2

    :cond_1
    if-nez p1, :cond_2

    goto :goto_1

    :cond_2
    if-ne p1, v5, :cond_4

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v1

    if-nez v1, :cond_3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-static {v6, p1, p2, v4}, Lcom/android/internal/util/FrameworkStatsLog;->write(IIII)V

    move v1, v4

    move v7, v5

    move v10, v7

    move v11, v10

    move v5, v8

    goto :goto_2

    :cond_3
    move v1, v4

    move v10, v1

    move v7, v5

    move v11, v7

    goto :goto_0

    :cond_4
    :goto_1
    move v1, p3

    move v7, v4

    move v10, v7

    move v11, v5

    goto :goto_0

    :goto_2
    if-nez v7, :cond_5

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v7}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result v7

    if-eqz v7, :cond_5

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v7, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {v7}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-static {v6, p1, p2, v1}, Lcom/android/internal/util/FrameworkStatsLog;->write(IIII)V

    move v6, v8

    move v10, v11

    goto :goto_3

    :cond_5
    move v6, v4

    :goto_3
    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceState:I

    if-eq v0, p1, :cond_6

    iput p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneServiceState:I

    move v7, p1

    move v10, v11

    goto :goto_4

    :cond_6
    move v7, v9

    :goto_4
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthBin:I

    if-eq p1, v1, :cond_d

    if-ltz p1, :cond_7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, v0, p1

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    :cond_7
    if-ltz v1, :cond_9

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v1

    invoke-virtual {p1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result p1

    if-nez p1, :cond_8

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v1

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    :cond_8
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    const/16 p1, 0x28

    invoke-static {p1, v1}, Lcom/android/internal/util/FrameworkStatsLog;->write(II)V

    move v9, v1

    move v10, v11

    goto :goto_8

    :cond_9
    :goto_5
    sget p1, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    if-ge v4, p1, :cond_c

    if-ne v4, v9, :cond_a

    goto :goto_7

    :cond_a
    :goto_6
    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v4

    invoke-virtual {p1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->isRunningLocked()Z

    move-result p1

    if-eqz p1, :cond_b

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object p1, p1, v4

    invoke-virtual {p1, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->stopRunningLocked(J)V

    goto :goto_6

    :cond_b
    :goto_7
    add-int/lit8 v4, v4, 0x1

    goto :goto_5

    :cond_c
    :goto_8
    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthBin:I

    :cond_d
    move v8, v9

    if-eqz v10, :cond_e

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide v1, v2

    move-wide/from16 v3, p6

    invoke-virtual/range {v0 .. v8}, Lcom/android/internal/os/BatteryStatsHistory;->recordPhoneStateChangeEvent(JJIIII)V

    :cond_e
    return-void
.end method

.method public final updateBluetoothStateLocked(Landroid/bluetooth/BluetoothActivityEnergyInfo;JJJ)V
    .locals 42

    move-object/from16 v0, p0

    move-wide/from16 v2, p4

    if-nez p1, :cond_0

    return-void

    :cond_0
    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v1, :cond_1

    iget-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    if-eqz v1, :cond_2

    :cond_1
    move-object/from16 v9, p1

    goto/16 :goto_10

    :cond_2
    const/4 v1, 0x1

    iput-boolean v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasBluetoothReporting:Z

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerRxTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v10, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->rxTimeMs:J

    cmp-long v4, v4, v10

    const-wide/16 v10, 0x0

    if-ltz v4, :cond_3

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerTxTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v12, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->txTimeMs:J

    cmp-long v4, v4, v12

    if-ltz v4, :cond_3

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerIdleTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v12, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->idleTimeMs:J

    cmp-long v4, v4, v12

    if-ltz v4, :cond_3

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerEnergyUsed()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v12, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->energy:J

    cmp-long v4, v4, v12

    if-gez v4, :cond_4

    :cond_3
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iput-wide v10, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->idleTimeMs:J

    iput-wide v10, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->rxTimeMs:J

    iput-wide v10, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->txTimeMs:J

    iput-wide v10, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->energy:J

    iget-object v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidRxBytes:Landroid/util/SparseLongArray;

    invoke-virtual {v5}, Landroid/util/SparseLongArray;->clear()V

    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidTxBytes:Landroid/util/SparseLongArray;

    invoke-virtual {v4}, Landroid/util/SparseLongArray;->clear()V

    :cond_4
    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerRxTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v12, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->rxTimeMs:J

    sub-long v12, v4, v12

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerTxTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-wide v14, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->txTimeMs:J

    sub-long v14, v4, v14

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerIdleTimeMillis()J

    move-result-wide v4

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    move-wide/from16 v16, v10

    iget-wide v10, v8, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->idleTimeMs:J

    sub-long v10, v4, v10

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-eqz v4, :cond_5

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    if-eqz v4, :cond_5

    cmp-long v4, p2, v16

    if-lez v4, :cond_5

    new-instance v4, Landroid/util/SparseDoubleArray;

    invoke-direct {v4}, Landroid/util/SparseDoubleArray;-><init>()V

    :goto_0
    move-object v8, v4

    goto :goto_1

    :cond_5
    const/4 v4, 0x0

    goto :goto_0

    :goto_1
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    const/16 v18, 0x0

    move-wide/from16 v19, v16

    move/from16 v5, v18

    :goto_2
    const-wide/16 v21, 0x3e8

    if-ge v5, v4, :cond_8

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move/from16 v24, v5

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v5, :cond_7

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    if-nez v5, :cond_6

    goto :goto_3

    :cond_6
    mul-long v6, v2, v21

    invoke-virtual {v5, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v25

    div-long v25, v25, v21

    add-long v19, v25, v19

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v1, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    :cond_7
    :goto_3
    add-int/lit8 v5, v24, 0x1

    const/4 v1, 0x1

    goto :goto_2

    :cond_8
    cmp-long v1, v19, v12

    if-lez v1, :cond_9

    const/4 v1, 0x1

    goto :goto_4

    :cond_9
    move/from16 v1, v18

    :goto_4
    cmp-long v5, v19, v14

    if-lez v5, :cond_a

    const/16 v23, 0x1

    goto :goto_5

    :cond_a
    move/from16 v23, v18

    :goto_5
    new-instance v6, Landroid/util/SparseLongArray;

    invoke-direct {v6, v4}, Landroid/util/SparseLongArray;-><init>(I)V

    new-instance v7, Landroid/util/SparseLongArray;

    invoke-direct {v7, v4}, Landroid/util/SparseLongArray;-><init>(I)V

    move-wide/from16 v24, v12

    move-wide/from16 v26, v14

    move/from16 v5, v18

    :goto_6
    if-ge v5, v4, :cond_12

    move/from16 v28, v1

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move/from16 v29, v4

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v4, :cond_b

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    if-nez v4, :cond_c

    :cond_b
    move-wide/from16 v30, v10

    goto/16 :goto_9

    :cond_c
    move-wide/from16 v30, v10

    mul-long v9, v2, v21

    invoke-virtual {v4, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v32

    div-long v32, v32, v21

    cmp-long v4, v32, v16

    if-lez v4, :cond_11

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v4, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-object v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    iget-object v11, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v11, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getRealtime(J)J

    move-result-wide v9

    iget v11, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->mNesting:I

    if-lez v11, :cond_d

    iget-wide v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTotalTimeUs:J

    move-wide/from16 v34, v2

    iget-wide v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->mUpdateTime:J

    sub-long v2, v9, v2

    iget v11, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->mDutyCycle:I

    move-wide/from16 v36, v2

    int-to-long v2, v11

    mul-long v2, v2, v36

    const-wide/16 v36, 0x64

    div-long v2, v2, v36

    add-long v2, v2, v34

    iput-wide v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTotalTimeUs:J

    iput-wide v9, v4, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->mUpdateTime:J

    :cond_d
    iget-wide v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTotalTimeUs:J

    iput-wide v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTimeBeforeMarkUs:J

    if-eqz v28, :cond_e

    mul-long v2, v12, v32

    div-long v2, v2, v19

    goto :goto_7

    :cond_e
    move-wide/from16 v2, v32

    :goto_7
    if-eqz v23, :cond_f

    mul-long v32, v32, v14

    div-long v32, v32, v19

    :cond_f
    move-wide/from16 v9, v32

    iget v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v6, v4, v2, v3}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    iget v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v7, v4, v9, v10}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    if-eqz v8, :cond_10

    iget v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    const-wide/16 v39, 0x0

    move-wide/from16 v35, v2

    move-object/from16 v34, v4

    move-wide/from16 v37, v9

    invoke-virtual/range {v34 .. v40}, Lcom/android/server/power/stats/BluetoothPowerCalculator;->calculatePowerMah(JJJ)D

    move-result-wide v2

    invoke-virtual {v8, v1, v2, v3}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    goto :goto_8

    :cond_10
    move-wide/from16 v35, v2

    move-wide/from16 v37, v9

    :goto_8
    sub-long v24, v24, v35

    sub-long v26, v26, v37

    :cond_11
    :goto_9
    add-int/lit8 v5, v5, 0x1

    move-wide/from16 v2, p4

    move/from16 v1, v28

    move/from16 v4, v29

    move-wide/from16 v10, v30

    goto/16 :goto_6

    :cond_12
    move-wide/from16 v30, v10

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getUidTraffic()Ljava/util/List;

    move-result-object v9

    invoke-interface {v9}, Ljava/util/List;->size()I

    move-result v10

    move-wide/from16 v19, v16

    move-wide/from16 v21, v19

    move/from16 v11, v18

    :goto_a
    if-ge v11, v10, :cond_13

    invoke-interface {v9, v11}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Landroid/bluetooth/UidTraffic;

    invoke-virtual {v2}, Landroid/bluetooth/UidTraffic;->getRxBytes()J

    move-result-wide v3

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-object v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidRxBytes:Landroid/util/SparseLongArray;

    const/16 v23, 0x5

    invoke-virtual {v2}, Landroid/bluetooth/UidTraffic;->getUid()I

    move-result v1

    invoke-virtual {v5, v1}, Landroid/util/SparseLongArray;->get(I)J

    move-result-wide v28

    sub-long v3, v3, v28

    invoke-virtual {v2}, Landroid/bluetooth/UidTraffic;->getTxBytes()J

    move-result-wide v28

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidTxBytes:Landroid/util/SparseLongArray;

    invoke-virtual {v2}, Landroid/bluetooth/UidTraffic;->getUid()I

    move-result v5

    invoke-virtual {v1, v5}, Landroid/util/SparseLongArray;->get(I)J

    move-result-wide v32

    move-wide/from16 v40, v14

    sub-long v14, v28, v32

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const/4 v5, 0x4

    aget-object v1, v1, v5

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v1, v1, v23

    invoke-virtual {v1, v14, v15}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual {v2}, Landroid/bluetooth/UidTraffic;->getUid()I

    move-result v1

    invoke-virtual {v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-wide/from16 v34, v3

    move-wide/from16 v2, p4

    move-wide/from16 v4, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v32

    const/16 v33, 0x4

    const-wide/16 v36, 0x0

    invoke-virtual/range {v32 .. v37}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    move-wide/from16 v3, v34

    const/16 v35, 0x5

    const-wide/16 v38, 0x0

    move-wide/from16 v36, v14

    move-object/from16 v34, v32

    invoke-virtual/range {v34 .. v39}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    add-long v21, v21, v3

    add-long v19, v19, v36

    add-int/lit8 v11, v11, 0x1

    move-wide/from16 v14, v40

    goto :goto_a

    :cond_13
    move-wide/from16 v40, v14

    const/16 v23, 0x5

    cmp-long v11, v19, v16

    if-nez v11, :cond_15

    cmp-long v1, v21, v16

    if-eqz v1, :cond_14

    goto :goto_b

    :cond_14
    move-wide/from16 v2, p4

    move/from16 v9, v23

    goto/16 :goto_f

    :cond_15
    :goto_b
    cmp-long v1, v24, v16

    if-nez v1, :cond_16

    cmp-long v1, v26, v16

    if-eqz v1, :cond_14

    :cond_16
    move/from16 v14, v18

    :goto_c
    if-ge v14, v10, :cond_19

    invoke-interface {v9, v14}, Ljava/util/List;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Landroid/bluetooth/UidTraffic;

    invoke-virtual {v1}, Landroid/bluetooth/UidTraffic;->getUid()I

    move-result v15

    invoke-virtual {v1}, Landroid/bluetooth/UidTraffic;->getRxBytes()J

    move-result-wide v2

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidRxBytes:Landroid/util/SparseLongArray;

    invoke-virtual {v4, v15}, Landroid/util/SparseLongArray;->get(I)J

    move-result-wide v4

    sub-long v28, v2, v4

    invoke-virtual {v1}, Landroid/bluetooth/UidTraffic;->getTxBytes()J

    move-result-wide v1

    iget-object v3, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    iget-object v3, v3, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->uidTxBytes:Landroid/util/SparseLongArray;

    invoke-virtual {v3, v15}, Landroid/util/SparseLongArray;->get(I)J

    move-result-wide v3

    sub-long v32, v1, v3

    invoke-virtual {v0, v15}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    move-wide/from16 v2, p4

    move-wide/from16 v4, p6

    move-object/from16 v34, v9

    move/from16 v9, v23

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateBluetoothControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    cmp-long v0, v21, v16

    if-lez v0, :cond_17

    cmp-long v0, v28, v16

    if-lez v0, :cond_17

    mul-long v28, v28, v24

    div-long v0, v28, v21

    invoke-virtual {v6, v15, v0, v1}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    :cond_17
    if-lez v11, :cond_18

    cmp-long v0, v32, v16

    if-lez v0, :cond_18

    mul-long v32, v32, v26

    div-long v0, v32, v19

    invoke-virtual {v7, v15, v0, v1}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    :cond_18
    add-int/lit8 v14, v14, 0x1

    move-object/from16 v0, p0

    move/from16 v23, v9

    move-object/from16 v9, v34

    goto :goto_c

    :cond_19
    move/from16 v9, v23

    move/from16 v10, v18

    :goto_d
    invoke-virtual {v7}, Landroid/util/SparseLongArray;->size()I

    move-result v0

    if-ge v10, v0, :cond_1b

    invoke-virtual {v7, v10}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v1

    invoke-virtual {v7, v10}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v14

    move-object/from16 v0, p0

    move-wide/from16 v2, p4

    move-wide/from16 v4, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v11

    invoke-virtual {v11}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateBluetoothControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    move-result-object v4

    invoke-static {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v4

    aget-object v4, v4, v18

    invoke-static {v4, v14, v15, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    if-eqz v8, :cond_1a

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    const-wide/16 v20, 0x0

    const-wide/16 v24, 0x0

    move-object/from16 v19, v4

    move-wide/from16 v22, v14

    invoke-virtual/range {v19 .. v25}, Lcom/android/server/power/stats/BluetoothPowerCalculator;->calculatePowerMah(JJJ)D

    move-result-wide v4

    invoke-virtual {v8, v1, v4, v5}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    :cond_1a
    add-int/lit8 v10, v10, 0x1

    goto :goto_d

    :cond_1b
    move-object/from16 v0, p0

    move-wide/from16 v2, p4

    move/from16 v7, v18

    :goto_e
    invoke-virtual {v6}, Landroid/util/SparseLongArray;->size()I

    move-result v1

    if-ge v7, v1, :cond_1d

    invoke-virtual {v6, v7}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v10

    invoke-virtual {v6, v7}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v14

    invoke-virtual {v6, v7}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v1

    move-wide/from16 v4, p6

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v1

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateBluetoothControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v1

    invoke-static {v1, v14, v15, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    if-eqz v8, :cond_1c

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    const-wide/16 v22, 0x0

    const-wide/16 v24, 0x0

    move-object/from16 v19, v1

    move-wide/from16 v20, v14

    invoke-virtual/range {v19 .. v25}, Lcom/android/server/power/stats/BluetoothPowerCalculator;->calculatePowerMah(JJJ)D

    move-result-wide v4

    invoke-virtual {v8, v10, v4, v5}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    :cond_1c
    add-int/lit8 v7, v7, 0x1

    goto :goto_e

    :cond_1d
    :goto_f
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v1

    invoke-static {v1, v12, v13, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v1

    aget-object v1, v1, v18

    move-wide/from16 v4, v40

    invoke-static {v1, v4, v5, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-nez v6, :cond_1e

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->createTimeMultiStateCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v6

    iput-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_1e
    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-wide/from16 v6, v30

    invoke-static {v1, v6, v7, v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v10, "bluetooth.controller.voltage"

    invoke-virtual {v1, v10}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v10

    const-wide v14, 0x408f400000000000L    # 1000.0

    div-double/2addr v10, v14

    const-wide/16 v14, 0x0

    cmpl-double v1, v10, v14

    if-eqz v1, :cond_1f

    invoke-virtual/range {p1 .. p1}, Landroid/bluetooth/BluetoothActivityEnergyInfo;->getControllerEnergyUsed()J

    move-result-wide v14

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    move-wide/from16 p6, v10

    iget-wide v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->energy:J

    sub-long/2addr v14, v9

    long-to-double v9, v14

    div-double v14, v9, p6

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    double-to-long v9, v14

    invoke-virtual {v1, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_1f
    move-wide v9, v14

    if-eqz v8, :cond_20

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    move-wide/from16 v14, p2

    const/4 v11, 0x5

    invoke-virtual {v1, v11, v14, v15}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothPowerCalculator:Lcom/android/server/power/stats/BluetoothPowerCalculator;

    move-wide/from16 v17, v4

    move-wide/from16 v19, v6

    move-wide v15, v12

    invoke-virtual/range {v14 .. v20}, Lcom/android/server/power/stats/BluetoothPowerCalculator;->calculatePowerMah(JJJ)D

    move-result-wide v4

    const-wide v6, 0x414b774000000000L    # 3600000.0

    div-double/2addr v9, v6

    invoke-static {v4, v5, v9, v10}, Ljava/lang/Math;->max(DD)D

    move-result-wide v5

    const/4 v1, 0x5

    move-object v4, v8

    move-wide v7, v2

    move-wide/from16 v2, p2

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    :cond_20
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    move-object/from16 v9, p1

    invoke-virtual {v0, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->set(Landroid/bluetooth/BluetoothActivityEnergyInfo;)V

    return-void

    :goto_10
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastBluetoothActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;

    invoke-virtual {v0, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$BluetoothActivityInfoCache;->set(Landroid/bluetooth/BluetoothActivityEnergyInfo;)V

    return-void
.end method

.method public final updateCameraEnergyConsumerStatsLocked(JJ)V
    .locals 16

    move-object/from16 v0, p0

    move-wide/from16 v2, p1

    move-wide/from16 v7, p3

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_0

    goto/16 :goto_5

    :cond_0
    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v4, :cond_7

    const-wide/16 v4, 0x0

    cmp-long v6, v2, v4

    if-gtz v6, :cond_1

    goto :goto_5

    :cond_1
    iget-boolean v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    const-wide/16 v9, 0x3e8

    const/4 v11, 0x0

    if-eqz v6, :cond_3

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    :goto_0
    if-ge v11, v1, :cond_7

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v11}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v2, :cond_2

    goto :goto_1

    :cond_2
    mul-long v3, v7, v9

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    invoke-virtual {v2, v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :goto_1
    add-int/lit8 v11, v11, 0x1

    goto :goto_0

    :cond_3
    const/16 v6, 0x8

    invoke-virtual {v1, v6, v2, v3}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    move-wide v5, v4

    new-instance v4, Landroid/util/SparseDoubleArray;

    invoke-direct {v4}, Landroid/util/SparseDoubleArray;-><init>()V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    :goto_2
    if-ge v11, v1, :cond_6

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v12, v11}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v13, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v13, :cond_4

    move-wide v14, v5

    goto :goto_3

    :cond_4
    mul-long v14, v7, v9

    invoke-virtual {v13, v14, v15}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v14

    invoke-virtual {v13, v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :goto_3
    cmp-long v13, v14, v5

    if-nez v13, :cond_5

    goto :goto_4

    :cond_5
    iget v12, v12, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    long-to-double v13, v14

    invoke-virtual {v4, v12, v13, v14}, Landroid/util/SparseDoubleArray;->put(ID)V

    :goto_4
    add-int/lit8 v11, v11, 0x1

    goto :goto_2

    :cond_6
    const/16 v1, 0x8

    const-wide/16 v5, 0x0

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    :cond_7
    :goto_5
    return-void
.end method

.method public final updateCellularBatteryStats(Landroid/telephony/ModemActivityInfo;Landroid/net/NetworkStats;JJJ)V
    .locals 47

    move-object/from16 v1, p0

    move-object/from16 v0, p1

    move-object/from16 v7, p2

    monitor-enter p0

    const/4 v15, 0x1

    const/16 v16, 0x0

    if-nez v0, :cond_0

    monitor-exit p0

    move-wide/from16 v9, p5

    goto :goto_2

    :cond_0
    move v2, v15

    move/from16 v3, v16

    :goto_0
    :try_start_0
    sget v4, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    if-ge v2, v4, :cond_2

    invoke-virtual {v0, v2}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v4

    invoke-virtual {v0, v3}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v8

    cmp-long v4, v4, v8

    if-lez v4, :cond_1

    move v3, v2

    :cond_1
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :catchall_0
    move-exception v0

    goto/16 :goto_1c

    :cond_2
    sub-int/2addr v4, v15

    if-ne v3, v4, :cond_3

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    const/high16 v13, 0x80000

    move-wide/from16 v9, p5

    move-wide/from16 v11, p7

    invoke-virtual/range {v8 .. v13}, Lcom/android/internal/os/BatteryStatsHistory;->recordState2StartEvent(JJI)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    goto :goto_1

    :cond_3
    move-wide/from16 v9, p5

    :goto_1
    monitor-exit p0

    :goto_2
    monitor-enter p0

    if-eqz v7, :cond_4

    :try_start_1
    invoke-virtual {v1, v7}, Lcom/android/server/power/stats/BatteryStatsImpl;->notifyNetworkStatsUpdatedCallbacksLocked(Landroid/net/NetworkStats;)V

    goto :goto_3

    :catchall_1
    move-exception v0

    goto/16 :goto_1b

    :cond_4
    :goto_3
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    const-wide/16 v17, 0x3e8

    mul-long v3, v9, v17

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    div-long v5, v5, v17

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v11

    div-long v11, v11, v17

    invoke-static {v5, v6, v11, v12}, Ljava/lang/Math;->min(JJ)J

    move-result-wide v11

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v2, :cond_23

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    if-eqz v2, :cond_5

    goto/16 :goto_1a

    :cond_5
    const-wide/16 v19, 0x0

    cmp-long v2, p3, v19

    if-lez v2, :cond_7

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->isMobileRadioEnergyConsumerSupportedLocked()Z

    move-result v2

    if-eqz v2, :cond_7

    cmp-long v2, v5, v19

    if-nez v2, :cond_6

    move-wide/from16 v11, v19

    goto :goto_4

    :cond_6
    mul-long v11, v11, p3

    const-wide/16 v13, 0x2

    div-long v13, v5, v13

    add-long/2addr v11, v13

    div-long/2addr v11, v5

    :goto_4
    sub-long v13, p3, v11

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const/16 v8, 0x9

    invoke-virtual {v2, v8, v11, v12}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const/4 v8, 0x7

    invoke-virtual {v2, v8, v13, v14}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    new-instance v2, Landroid/util/SparseDoubleArray;

    invoke-direct {v2}, Landroid/util/SparseDoubleArray;-><init>()V

    :goto_5
    move-wide/from16 v22, v13

    goto :goto_6

    :cond_7
    const-wide/16 v13, -0x1

    const/4 v2, 0x0

    goto :goto_5

    :goto_6
    const-wide/16 v24, 0x0

    if-eqz v0, :cond_d

    iput-boolean v15, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasModemReporting:Z

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v11, v8, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-nez v11, :cond_8

    invoke-virtual {v8}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->createTimeMultiStateCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v11

    iput-object v11, v8, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_8
    iget-object v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getIdleTimeMillis()J

    move-result-wide v11

    invoke-static {v8, v11, v12, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getSleepTimeMillis()J

    move-result-wide v11

    invoke-virtual {v8, v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v8}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v8

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getReceiveTimeMillis()J

    move-result-wide v11

    invoke-static {v8, v11, v12, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    move/from16 v8, v16

    :goto_7
    sget v11, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    if-ge v8, v11, :cond_9

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v11}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v11

    aget-object v11, v11, v8

    invoke-virtual {v0, v8}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v12

    invoke-static {v11, v12, v13, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_7

    :cond_9
    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v11, "modem.controller.voltage"

    invoke-virtual {v8, v11}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v11

    const-wide v13, 0x408f400000000000L    # 1000.0

    div-double/2addr v11, v13

    cmpl-double v8, v11, v24

    if-eqz v8, :cond_b

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getSleepTimeMillis()J

    move-result-wide v13

    long-to-double v13, v13

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    move/from16 v26, v15

    const-string/jumbo v15, "modem.controller.sleep"

    invoke-virtual {v8, v15}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v27

    mul-double v13, v13, v27

    move-wide/from16 v27, v5

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getIdleTimeMillis()J

    move-result-wide v5

    long-to-double v5, v5

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v15, "modem.controller.idle"

    invoke-virtual {v8, v15}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v29

    mul-double v5, v5, v29

    add-double/2addr v5, v13

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getReceiveTimeMillis()J

    move-result-wide v13

    long-to-double v13, v13

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v15, "modem.controller.rx"

    invoke-virtual {v8, v15}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v29

    mul-double v13, v13, v29

    add-double/2addr v13, v5

    move/from16 v5, v16

    :goto_8
    sget v6, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    sget v8, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    invoke-static {v6, v8}, Ljava/lang/Math;->min(II)I

    move-result v6

    if-ge v5, v6, :cond_a

    invoke-virtual {v0, v5}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v6

    long-to-double v6, v6

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v15, "modem.controller.tx"

    invoke-virtual {v8, v15, v5}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;I)D

    move-result-wide v29

    mul-double v6, v6, v29

    add-double/2addr v13, v6

    add-int/lit8 v5, v5, 0x1

    move-object/from16 v7, p2

    goto :goto_8

    :cond_a
    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    double-to-long v6, v13

    invoke-virtual {v5, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    invoke-virtual {v5}, Lcom/android/internal/os/RailStats;->getCellularTotalEnergyUseduWs()J

    move-result-wide v5

    long-to-double v5, v5

    div-double/2addr v5, v11

    double-to-long v5, v5

    iget-object v7, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v7, v7, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mMonitoredRailChargeConsumedMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v7, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    long-to-double v5, v5

    const-wide v11, 0x414b774000000000L    # 3600000.0

    div-double v13, v5, v11

    move-wide/from16 v11, p7

    invoke-virtual/range {v8 .. v14}, Lcom/android/internal/os/BatteryStatsHistory;->recordWifiConsumedCharge(JJD)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    invoke-virtual {v5}, Lcom/android/internal/os/RailStats;->resetCellularTotalEnergyUsed()V

    goto :goto_9

    :cond_b
    move-wide/from16 v27, v5

    move/from16 v26, v15

    :goto_9
    invoke-virtual {v1, v0, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl;->incrementPerRatDataLocked(Landroid/telephony/ModemActivityInfo;J)Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;

    move-result-object v8

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->PER_UID_MODEM_MODEL:I

    const/4 v6, 0x2

    if-ne v5, v6, :cond_c

    if-eqz v8, :cond_c

    move/from16 v5, v26

    goto :goto_a

    :cond_c
    move/from16 v5, v16

    :goto_a
    move v7, v5

    goto :goto_b

    :cond_d
    move-wide/from16 v27, v5

    move/from16 v26, v15

    move/from16 v7, v16

    const/4 v8, 0x0

    :goto_b
    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v5, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v11

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v5, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    if-eqz p2, :cond_22

    invoke-virtual/range {p2 .. p2}, Landroid/net/NetworkStats;->iterator()Ljava/util/Iterator;

    move-result-object v13

    move-wide/from16 v5, v19

    move-wide v14, v5

    :goto_c
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v21

    if-eqz v21, :cond_10

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v21

    check-cast v21, Landroid/net/NetworkStats$Entry;

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v29

    cmp-long v29, v29, v19

    if-nez v29, :cond_e

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v29

    cmp-long v29, v29, v19

    if-nez v29, :cond_e

    goto :goto_c

    :cond_e
    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v29

    add-long v14, v14, v29

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v29

    add-long v29, v5, v29

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getUid()I

    move-result v5

    invoke-virtual {v1, v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v5

    move-wide/from16 p3, v9

    move-wide v9, v3

    move-wide/from16 v3, p3

    move-wide/from16 p3, v11

    move-wide/from16 v11, v27

    move/from16 v27, v7

    move-object v7, v2

    move v2, v5

    move-wide/from16 v5, p7

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v31

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v33

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v35

    const/16 v32, 0x0

    invoke-virtual/range {v31 .. v36}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v33

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v35

    const/16 v32, 0x1

    invoke-virtual/range {v31 .. v36}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getSet()I

    move-result v2

    if-nez v2, :cond_f

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v33

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v35

    const/16 v32, 0x6

    invoke-virtual/range {v31 .. v36}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v33

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v35

    const/16 v32, 0x7

    invoke-virtual/range {v31 .. v36}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    :cond_f
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v16

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v3

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v26

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v3

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v16

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v3

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v26

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v3

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    move-object v2, v7

    move-wide v3, v9

    move/from16 v7, v27

    move-wide/from16 v5, v29

    move-wide/from16 v9, p5

    move-wide/from16 v27, v11

    move-wide/from16 v11, p3

    goto/16 :goto_c

    :cond_10
    move-wide v9, v3

    move-wide/from16 p3, v11

    move-wide/from16 v11, v27

    move/from16 v27, v7

    move-object v7, v2

    add-long v2, v14, v5

    cmp-long v4, v2, v19

    move-wide/from16 v28, v9

    if-lez v4, :cond_1c

    invoke-virtual/range {p2 .. p2}, Landroid/net/NetworkStats;->iterator()Ljava/util/Iterator;

    move-result-object v13

    move-wide/from16 v32, p3

    move-wide/from16 v30, v2

    :goto_d
    invoke-interface {v13}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_1b

    invoke-interface {v13}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    move-object/from16 v21, v2

    check-cast v21, Landroid/net/NetworkStats$Entry;

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v2

    cmp-long v2, v2, v19

    if-nez v2, :cond_11

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v2

    cmp-long v2, v2, v19

    if-nez v2, :cond_11

    goto :goto_d

    :cond_11
    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getUid()I

    move-result v2

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v2

    move-wide/from16 v3, p5

    move-wide/from16 v37, v5

    move-wide/from16 v5, p7

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v2

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v5

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v34

    add-long v5, v5, v34

    mul-long v34, v32, v5

    div-long v9, v34, v30

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureNetworkActivityLocked()V

    move-wide/from16 p2, v5

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getMobileRadioActiveTimeCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v5

    invoke-static {v5, v9, v10, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v5, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-wide/from16 v34, v9

    const-wide/16 v9, 0x1

    invoke-virtual {v5, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    if-eqz v7, :cond_16

    if-eqz v27, :cond_15

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v5

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v9

    cmp-long v26, v14, v19

    if-eqz v26, :cond_12

    move-wide/from16 v39, v11

    iget-wide v11, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->rxConsumptionMah:D

    move-wide/from16 v41, v11

    long-to-double v11, v5

    mul-double v11, v11, v41

    move-wide/from16 v41, v11

    long-to-double v11, v14

    div-double v11, v41, v11

    add-double v11, v11, v24

    move-wide/from16 v45, v37

    move-wide/from16 v36, v11

    move-wide/from16 v11, v45

    goto :goto_e

    :cond_12
    move-wide/from16 v39, v11

    move-wide/from16 v11, v37

    move-wide/from16 v36, v24

    :goto_e
    cmp-long v38, v11, v19

    if-nez v38, :cond_14

    if-eqz v26, :cond_13

    iget-wide v3, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->txToTotalRatio:D

    cmpl-double v3, v3, v24

    if-eqz v3, :cond_13

    goto :goto_f

    :cond_13
    move-wide/from16 v3, v36

    goto :goto_10

    :cond_14
    :goto_f
    long-to-double v3, v11

    move-wide/from16 v41, v3

    iget-wide v3, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->txToTotalRatio:D

    move-wide/from16 v43, v3

    long-to-double v3, v14

    mul-double v3, v3, v43

    add-double v3, v3, v41

    long-to-double v9, v9

    long-to-double v5, v5

    mul-double v5, v5, v43

    add-double/2addr v5, v9

    iget-wide v9, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->txConsumptionMah:D

    mul-double/2addr v9, v5

    div-double/2addr v9, v3

    add-double v3, v9, v36

    goto :goto_10

    :cond_15
    move-wide/from16 v39, v11

    move-wide/from16 v11, v37

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    div-long v9, v34, v17

    iget-object v3, v3, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mActivePowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    iget-wide v3, v3, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v5, v9

    mul-double/2addr v3, v5

    :goto_10
    iget v5, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v7, v5, v3, v4}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    goto :goto_11

    :cond_16
    move-wide/from16 v39, v11

    move-wide/from16 v11, v37

    :goto_11
    sub-long v32, v32, v34

    sub-long v30, v30, p2

    if-eqz v0, :cond_19

    iget-object v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mModemControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    if-nez v3, :cond_17

    new-instance v3, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v4, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v4, v4, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    sget v6, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    invoke-direct {v3, v6, v5, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;-><init>(ILcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mModemControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    :cond_17
    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mModemControllerActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    cmp-long v3, v14, v19

    if-lez v3, :cond_18

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v3

    cmp-long v3, v3, v19

    if-lez v3, :cond_18

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v3

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getReceiveTimeMillis()J

    move-result-wide v5

    mul-long/2addr v3, v5

    div-long/2addr v3, v14

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v5

    move-wide/from16 v9, p5

    invoke-static {v5, v3, v4, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    goto :goto_12

    :cond_18
    move-wide/from16 v9, p5

    :goto_12
    cmp-long v3, v11, v19

    if-lez v3, :cond_1a

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v3

    cmp-long v3, v3, v19

    if-lez v3, :cond_1a

    move/from16 v3, v16

    :goto_13
    sget v4, Lcom/android/server/power/stats/BatteryStatsImpl;->MODEM_TX_POWER_LEVEL_COUNT:I

    if-ge v3, v4, :cond_1a

    invoke-virtual/range {v21 .. v21}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v4

    invoke-virtual {v0, v3}, Landroid/telephony/ModemActivityInfo;->getTransmitDurationMillisAtPowerLevel(I)J

    move-result-wide v34

    mul-long v4, v4, v34

    div-long/2addr v4, v11

    invoke-static {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v6

    aget-object v6, v6, v3

    invoke-static {v6, v4, v5, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    add-int/lit8 v3, v3, 0x1

    goto :goto_13

    :cond_19
    move-wide/from16 v9, p5

    :cond_1a
    move-wide v5, v11

    move-wide/from16 v11, v39

    goto/16 :goto_d

    :cond_1b
    move-wide/from16 v39, v11

    move-wide/from16 v11, v32

    :goto_14
    move-wide/from16 v9, p5

    goto :goto_15

    :cond_1c
    move-wide/from16 v39, v11

    move-wide/from16 v11, p3

    goto :goto_14

    :goto_15
    cmp-long v2, v11, v19

    if-lez v2, :cond_1d

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const-wide/16 v3, 0x1

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :cond_1d
    if-eqz v7, :cond_22

    if-eqz v27, :cond_20

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getSleepTimeMillis()J

    move-result-wide v2

    invoke-virtual {v0}, Landroid/telephony/ModemActivityInfo;->getIdleTimeMillis()J

    move-result-wide v4

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iget-object v6, v0, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mSleepPowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    if-eqz v6, :cond_1f

    iget-object v0, v0, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mIdlePowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    if-nez v0, :cond_1e

    goto :goto_16

    :cond_1e
    iget-wide v11, v6, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v2, v2

    mul-double/2addr v11, v2

    iget-wide v2, v0, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v4, v4

    mul-double/2addr v2, v4

    add-double/2addr v2, v11

    goto :goto_17

    :cond_1f
    :goto_16
    const-wide/high16 v2, 0x7ff8000000000000L    # Double.NaN

    :goto_17
    add-double v2, v2, v24

    iget-wide v4, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->rxConsumptionMah:D

    add-double/2addr v2, v4

    iget-wide v4, v8, Lcom/android/server/power/stats/BatteryStatsImpl$RxTxConsumption;->txConsumptionMah:D

    add-double/2addr v2, v4

    goto :goto_19

    :cond_20
    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iget-object v0, v0, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mActivePowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    iget-wide v2, v0, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    move-wide/from16 v11, v39

    long-to-double v4, v11

    mul-double/2addr v2, v4

    add-double v2, v2, v24

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v0, v0

    move/from16 v4, v16

    :goto_18
    if-ge v4, v0, :cond_21

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v5, v5, v4

    move-wide/from16 v11, v28

    invoke-virtual {v5, v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    div-long v5, v5, v17

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v8, v8, v4

    invoke-virtual {v8, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iget-object v8, v8, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mIdlePowerEstimators:[Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    aget-object v8, v8, v4

    iget-wide v13, v8, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v5, v5

    mul-double/2addr v13, v5

    add-double/2addr v2, v13

    add-int/lit8 v4, v4, 0x1

    move-wide/from16 v28, v11

    goto :goto_18

    :cond_21
    move-wide/from16 v11, v28

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v11, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v4

    div-long v4, v4, v17

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v0, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioPowerCalculator:Lcom/android/server/power/stats/MobileRadioPowerCalculator;

    iget-object v0, v0, Lcom/android/server/power/stats/MobileRadioPowerCalculator;->mScanPowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    iget-wide v11, v0, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v4, v4

    mul-double/2addr v11, v4

    add-double/2addr v2, v11

    :goto_19
    const/4 v0, 0x7

    move-object v5, v7

    move-wide v8, v9

    move-wide v6, v2

    move-wide/from16 v3, v22

    move v2, v0

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    :cond_22
    monitor-exit p0

    return-void

    :cond_23
    :goto_1a
    monitor-exit p0

    return-void

    :goto_1b
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    throw v0

    :goto_1c
    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v0
.end method

.method public updateClusterSpeedTimes(Landroid/util/SparseLongArray;ZZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V
    .locals 25

    move-object/from16 v0, p0

    move-object/from16 v6, p1

    move/from16 v7, p2

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    array-length v2, v1

    new-array v8, v2, [[J

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-eqz v2, :cond_0

    array-length v2, v2

    array-length v3, v1

    if-eq v2, v3, :cond_1

    :cond_0
    array-length v2, v1

    new-array v2, v2, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iput-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    :cond_1
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-eqz v2, :cond_2

    array-length v2, v2

    array-length v3, v1

    if-eq v2, v3, :cond_3

    :cond_2
    array-length v1, v1

    new-array v1, v1, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    :cond_3
    const-wide/16 v1, 0x0

    move-wide v10, v1

    const/4 v3, 0x0

    :goto_0
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    array-length v5, v4

    if-ge v3, v5, :cond_a

    aget-object v4, v4, v3

    if-eqz v4, :cond_8

    invoke-virtual {v4}, Lcom/android/internal/os/KernelCpuSpeedReader;->readDelta()[J

    move-result-object v4

    aput-object v4, v8, v3

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v4, v4, v3

    if-eqz v4, :cond_4

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getSize()I

    move-result v4

    aget-object v5, v8, v3

    array-length v5, v5

    if-eq v4, v5, :cond_5

    :cond_4
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v5, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v5, v4, v3

    :cond_5
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v4, v4, v3

    aget-object v5, v8, v3

    invoke-virtual {v4, v5, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->addCountLocked([JZ)V

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v4, v4, v3

    if-eqz v4, :cond_6

    invoke-virtual {v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->getSize()I

    move-result v4

    aget-object v5, v8, v3

    array-length v5, v5

    if-eq v4, v5, :cond_7

    :cond_6
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    new-instance v5, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v5, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v5, v4, v3

    :cond_7
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    aget-object v4, v4, v3

    aget-object v5, v8, v3

    move/from16 v12, p3

    invoke-virtual {v4, v5, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->addCountLocked([JZ)V

    aget-object v4, v8, v3

    if-eqz v4, :cond_9

    array-length v4, v4

    add-int/lit8 v4, v4, -0x1

    :goto_1
    if-ltz v4, :cond_9

    aget-object v5, v8, v3

    aget-wide v13, v5, v4

    add-long/2addr v10, v13

    add-int/lit8 v4, v4, -0x1

    goto :goto_1

    :cond_8
    move/from16 v12, p3

    :cond_9
    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    :cond_a
    cmp-long v1, v10, v1

    if-eqz v1, :cond_13

    invoke-virtual {v6}, Landroid/util/SparseLongArray;->size()I

    move-result v12

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v2

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    const/4 v13, 0x0

    :goto_2
    if-ge v13, v12, :cond_13

    invoke-virtual {v6, v13}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v1

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v15

    invoke-virtual {v6, v13}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v20

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v1}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v1

    iget-object v14, v15, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-eqz v14, :cond_b

    array-length v14, v14

    array-length v9, v1

    if-eq v14, v9, :cond_c

    :cond_b
    array-length v9, v1

    new-array v9, v9, [[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iput-object v9, v15, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    :cond_c
    const/4 v9, 0x0

    :goto_3
    array-length v14, v1

    if-ge v9, v14, :cond_12

    aget-object v14, v8, v9

    array-length v14, v14

    move-object/from16 p3, v1

    iget-object v1, v15, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-object/from16 v16, v1

    aget-object v1, v16, v9

    if-eqz v1, :cond_d

    array-length v1, v1

    if-eq v14, v1, :cond_e

    :cond_d
    new-array v1, v14, [Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aput-object v1, v16, v9

    :cond_e
    aget-object v1, v16, v9

    move-object/from16 v22, v1

    const/4 v1, 0x0

    :goto_4
    if-ge v1, v14, :cond_11

    aget-object v16, v22, v1

    move/from16 v17, v1

    if-nez v16, :cond_f

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    move-wide/from16 v23, v2

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    aput-object v1, v22, v17

    goto :goto_5

    :cond_f
    move-wide/from16 v23, v2

    :goto_5
    aget-object v1, v8, v9

    aget-wide v1, v1, v17

    mul-long v1, v1, v20

    div-long/2addr v1, v10

    aget-object v3, v22, v17

    invoke-virtual {v3, v1, v2, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(JZ)V

    if-eqz p4, :cond_10

    move-wide/from16 v18, v1

    move/from16 v16, v9

    move v1, v14

    move-object/from16 v14, p4

    invoke-virtual/range {v14 .. v19}, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->addCpuClusterSpeedDurationsMs(Lcom/android/server/power/stats/BatteryStatsImpl$Uid;IIJ)V

    goto :goto_6

    :cond_10
    move/from16 v16, v9

    move v1, v14

    :goto_6
    add-int/lit8 v2, v17, 0x1

    move v14, v1

    move v1, v2

    move/from16 v9, v16

    move-wide/from16 v2, v23

    goto :goto_4

    :cond_11
    move-wide/from16 v23, v2

    move/from16 v16, v9

    add-int/lit8 v9, v16, 0x1

    move-object/from16 v1, p3

    goto :goto_3

    :cond_12
    move-wide/from16 v23, v2

    add-int/lit8 v13, v13, 0x1

    goto/16 :goto_2

    :cond_13
    return-void
.end method

.method public final updateCpuTimeLocked(ZZ[J)V
    .locals 22

    move-object/from16 v0, p0

    move/from16 v1, p1

    move/from16 v2, p2

    move-object/from16 v3, p3

    const/4 v4, 0x0

    if-eqz v2, :cond_1

    new-instance v5, Ljava/util/ArrayList;

    invoke-direct {v5}, Ljava/util/ArrayList;-><init>()V

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v6}, Ljava/util/ArrayList;->size()I

    move-result v6

    add-int/lit8 v6, v6, -0x1

    :goto_0
    if-ltz v6, :cond_2

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPartialTimers:Ljava/util/ArrayList;

    invoke-virtual {v7, v6}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    iget-boolean v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mInList:Z

    if-eqz v8, :cond_0

    iget-object v8, v7, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->mUid:Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-eqz v8, :cond_0

    iget v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    const/16 v9, 0x3e8

    if-eq v8, v9, :cond_0

    invoke-virtual {v5, v7}, Ljava/util/ArrayList;->add(Ljava/lang/Object;)Z

    :cond_0
    add-int/lit8 v6, v6, -0x1

    goto :goto_0

    :cond_1
    move-object v5, v4

    :cond_2
    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->markPartialTimersAsEligible()V

    const/4 v6, 0x0

    if-nez v1, :cond_5

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidUserSysTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;

    invoke-virtual {v1, v6, v4}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidUserSysTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v1, v6, v4}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    add-int/lit8 v1, v1, 0x2

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->TRACK_CPU_ACTIVE_CLUSTER_TIME:Z

    if-eqz v1, :cond_3

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidActiveTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;

    invoke-virtual {v1, v6, v4}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidActiveTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidClusterTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;

    invoke-virtual {v1, v6, v4}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidClusterTimeReader;->readDelta(ZLcom/android/internal/os/KernelCpuUidTimeReader$Callback;)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    add-int/lit8 v1, v1, 0x2

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    :cond_3
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    array-length v1, v1

    add-int/lit8 v1, v1, -0x1

    :goto_1
    if-ltz v1, :cond_14

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedReaders:[Lcom/android/internal/os/KernelCpuSpeedReader;

    aget-object v2, v2, v1

    if-eqz v2, :cond_4

    invoke-virtual {v2}, Lcom/android/internal/os/KernelCpuSpeedReader;->readDelta()[J

    :cond_4
    add-int/lit8 v1, v1, -0x1

    goto :goto_1

    :cond_5
    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUserInfoProvider:Lcom/android/server/power/stats/BatteryStatsImpl$UserInfoProvider;

    invoke-virtual {v7}, Lcom/android/server/power/stats/BatteryStatsImpl$UserInfoProvider;->refreshUserIds()V

    iget-object v7, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v7}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->allUidTimesAvailable()Z

    move-result v7

    if-eqz v7, :cond_6

    move-object v7, v4

    goto :goto_2

    :cond_6
    new-instance v7, Landroid/util/SparseLongArray;

    invoke-direct {v7}, Landroid/util/SparseLongArray;-><init>()V

    :goto_2
    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const-string v9, "BatteryStatsImpl"

    if-eqz v8, :cond_9

    const/4 v10, 0x3

    invoke-virtual {v8, v10}, Lcom/android/internal/power/EnergyConsumerStats;->isStandardBucketSupported(I)Z

    move-result v8

    if-eqz v8, :cond_9

    if-nez v3, :cond_7

    const-string/jumbo v8, "POWER_BUCKET_CPU supported but no EnergyConsumer Cpu Cluster charge reported on updateCpuTimeLocked!"

    invoke-static {v9, v8}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_3

    :cond_7
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerCalculator:Lcom/android/server/power/stats/CpuPowerCalculator;

    if-nez v4, :cond_8

    new-instance v4, Lcom/android/server/power/stats/CpuPowerCalculator;

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    invoke-direct {v4, v8, v10}, Lcom/android/server/power/stats/CpuPowerCalculator;-><init>(Lcom/android/internal/os/CpuScalingPolicies;Lcom/android/internal/os/PowerProfile;)V

    iput-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerCalculator:Lcom/android/server/power/stats/CpuPowerCalculator;

    :cond_8
    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerCalculator:Lcom/android/server/power/stats/CpuPowerCalculator;

    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v10}, Lcom/android/internal/os/CpuScalingPolicies;->getPolicies()[I

    move-result-object v10

    array-length v10, v10

    invoke-direct {v4, v8, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;-><init>(Lcom/android/server/power/stats/CpuPowerCalculator;I)V

    :cond_9
    :goto_3
    invoke-virtual {v0, v5, v7, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->readKernelUidCpuTimesLocked(Ljava/util/ArrayList;Landroid/util/SparseLongArray;Z)V

    if-eqz v7, :cond_a

    invoke-virtual {v0, v7, v1, v2, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateClusterSpeedTimes(Landroid/util/SparseLongArray;ZZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V

    :cond_a
    invoke-virtual {v0, v5, v1, v2, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->readKernelUidCpuFreqTimesLocked(Ljava/util/ArrayList;ZZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    add-int/lit8 v2, v2, 0x2

    iput v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mConstants:Lcom/android/server/power/stats/BatteryStatsImpl$Constants;

    iget-boolean v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Constants;->TRACK_CPU_ACTIVE_CLUSTER_TIME:Z

    if-eqz v2, :cond_b

    invoke-virtual/range {p0 .. p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->readKernelUidCpuActiveTimesLocked(Z)V

    invoke-virtual {v0, v1, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->readKernelUidCpuClusterTimesLocked(ZLcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;)V

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    add-int/lit8 v1, v1, 0x2

    iput v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumAllUidCpuTimeReads:I

    :cond_b
    if-eqz v4, :cond_14

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_c

    goto/16 :goto_a

    :cond_c
    array-length v1, v3

    const-wide/16 v7, 0x0

    move v2, v6

    move-wide v12, v7

    :goto_4
    if-ge v2, v1, :cond_d

    aget-wide v10, v3, v2

    add-long/2addr v12, v10

    add-int/lit8 v2, v2, 0x1

    goto :goto_4

    :cond_d
    cmp-long v2, v12, v7

    if-gtz v2, :cond_e

    goto/16 :goto_a

    :cond_e
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v14

    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const/4 v11, 0x3

    invoke-virtual/range {v10 .. v15}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJJ)V

    new-array v0, v1, [D

    move v2, v6

    :goto_5
    if-ge v2, v1, :cond_10

    iget-object v5, v4, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->totalClusterChargesMah:[D

    aget-wide v10, v5, v2

    const-wide/16 v12, 0x0

    cmpg-double v5, v10, v12

    if-gtz v5, :cond_f

    aput-wide v12, v0, v2

    goto :goto_6

    :cond_f
    aget-wide v12, v3, v2

    long-to-double v12, v12

    div-double/2addr v12, v10

    aput-wide v12, v0, v2

    :goto_6
    add-int/lit8 v2, v2, 0x1

    goto :goto_5

    :cond_10
    iget-object v2, v4, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->perUidCpuClusterChargesMah:Landroid/util/ArrayMap;

    invoke-virtual {v2}, Landroid/util/ArrayMap;->size()I

    move-result v2

    int-to-long v2, v2

    move v5, v6

    :goto_7
    int-to-long v10, v5

    cmp-long v10, v10, v2

    if-gez v10, :cond_14

    iget-object v10, v4, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->perUidCpuClusterChargesMah:Landroid/util/ArrayMap;

    invoke-virtual {v10, v5}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v11, v4, Lcom/android/server/power/stats/BatteryStatsImpl$CpuDeltaPowerAccumulator;->perUidCpuClusterChargesMah:Landroid/util/ArrayMap;

    invoke-virtual {v11, v5}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, [D

    move v12, v6

    move-wide/from16 p1, v7

    move-wide/from16 v6, p1

    :goto_8
    if-ge v12, v1, :cond_11

    aget-wide v16, v11, v12

    aget-wide v18, v0, v12

    mul-double v16, v16, v18

    const-wide/high16 v18, 0x3fe0000000000000L    # 0.5

    move-wide/from16 v20, v14

    add-double v13, v16, v18

    double-to-long v13, v13

    add-long/2addr v6, v13

    add-int/lit8 v12, v12, 0x1

    move-wide/from16 v14, v20

    goto :goto_8

    :cond_11
    move-wide/from16 v20, v14

    cmp-long v8, v6, p1

    if-gez v8, :cond_12

    const-string/jumbo v8, "Unexpected proportional EnergyConsumer charge ("

    const-string v11, ") for uid "

    invoke-static {v8, v6, v7, v11}, Lcom/android/server/BatteryService$$ExternalSyntheticOutline0;->m(Ljava/lang/String;JLjava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    iget v7, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v6

    invoke-static {v9, v6}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    move-wide/from16 v14, v20

    goto :goto_9

    :cond_12
    iget-object v8, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v8, :cond_13

    new-instance v8, Lcom/android/internal/power/EnergyConsumerStats;

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-direct {v8, v11}, Lcom/android/internal/power/EnergyConsumerStats;-><init>(Lcom/android/internal/power/EnergyConsumerStats$Config;)V

    iput-object v8, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    :cond_13
    iget-object v14, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const/4 v15, 0x3

    move-wide/from16 v16, v6

    move-wide/from16 v18, v20

    invoke-virtual/range {v14 .. v19}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJJ)V

    move-wide/from16 v14, v18

    :goto_9
    add-int/lit8 v5, v5, 0x1

    move-wide/from16 v7, p1

    const/4 v6, 0x0

    goto :goto_7

    :cond_14
    :goto_a
    return-void
.end method

.method public final updateCpuTimesForAllUids()V
    .locals 11

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 v1, 0x1

    invoke-virtual {v0, v1}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result v0

    if-eqz v0, :cond_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuPowerStatsCollector:Lcom/android/server/power/stats/CpuPowerStatsCollector;

    invoke-virtual {p0}, Lcom/android/server/power/stats/PowerStatsCollector;->schedule()Z

    return-void

    :cond_0
    monitor-enter p0

    :try_start_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->isFastCpuTimesReader()Z

    move-result v0

    if-nez v0, :cond_1

    monitor-exit p0

    return-void

    :catchall_0
    move-exception v0

    goto/16 :goto_4

    :cond_1
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->ensureKernelSingleUidTimeReaderLocked()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuUidFreqTimeReader:Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;

    invoke-virtual {v0}, Lcom/android/internal/os/KernelCpuUidTimeReader$KernelCpuUidFreqTimeReader;->getAllUidCpuFreqTimeMs()Landroid/util/SparseArray;

    move-result-object v0

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v2

    sub-int/2addr v2, v1

    :goto_0
    if-ltz v2, :cond_9

    invoke-virtual {v0, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v4

    invoke-virtual {p0, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v1

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v3, v1}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-nez v3, :cond_2

    goto :goto_3

    :cond_2
    iget v5, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    const/4 v6, 0x7

    if-ne v5, v6, :cond_3

    goto :goto_3

    :cond_3
    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v5}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v6

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v5}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    invoke-virtual {v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v5, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v9, v5, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v5, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v10, v5, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    if-eq v4, v1, :cond_7

    invoke-static {v4}, Landroid/os/Process;->isSdkSandboxUid(I)Z

    move-result v5

    if-eqz v5, :cond_4

    goto :goto_2

    :cond_4
    iget-object v1, v3, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mChildUids:Landroid/util/SparseArray;

    if-nez v1, :cond_5

    const/4 v1, 0x0

    goto :goto_1

    :cond_5
    invoke-virtual {v1, v4}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$ChildUid;

    :goto_1
    if-eqz v1, :cond_8

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$ChildUid;->cpuTimeInFreqCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    if-eqz v5, :cond_8

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    if-nez v1, :cond_6

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {v1}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result v1

    new-array v1, v1, [J

    iput-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    :cond_6
    iget-object v8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual/range {v3 .. v8}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J[J)V

    invoke-virtual {v9, v8}, Lcom/android/internal/os/LongArrayMultiStateCounter;->addCounts([J)V

    invoke-virtual {v10, v8}, Lcom/android/internal/os/LongArrayMultiStateCounter;->addCounts([J)V

    goto :goto_3

    :cond_7
    :goto_2
    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual {v3, v1, v9, v6, v7}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J)V

    iget-object v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual {v3, v1, v10, v6, v7}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J)V

    :cond_8
    :goto_3
    add-int/lit8 v2, v2, -0x1

    goto :goto_0

    :cond_9
    monitor-exit p0

    return-void

    :goto_4
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final updateCustomEnergyConsumerStatsLocked(IJLandroid/util/SparseLongArray;)V
    .locals 16

    move-object/from16 v0, p0

    move-object/from16 v7, p4

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_0

    goto/16 :goto_3

    :cond_0
    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v2, :cond_7

    iget-boolean v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    if-nez v2, :cond_7

    const-wide/16 v8, 0x0

    cmp-long v2, p2, v8

    if-gtz v2, :cond_1

    goto/16 :goto_3

    :cond_1
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v5

    move/from16 v2, p1

    move-wide/from16 v3, p2

    invoke-virtual/range {v1 .. v6}, Lcom/android/internal/power/EnergyConsumerStats;->updateCustomBucket(IJJ)V

    if-nez v7, :cond_2

    goto :goto_3

    :cond_2
    invoke-virtual {v7}, Landroid/util/SparseLongArray;->size()I

    move-result v1

    const/4 v2, 0x0

    :goto_0
    if-ge v2, v1, :cond_7

    invoke-virtual {v7, v2}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v5

    invoke-virtual {v0, v5}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v5

    invoke-virtual {v7, v2}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v12

    cmp-long v6, v12, v8

    if-nez v6, :cond_4

    :cond_3
    :goto_1
    move/from16 v11, p1

    goto :goto_2

    :cond_4
    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v5}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    if-eqz v6, :cond_6

    sget-object v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->sTempBinderCallStats:Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;

    iget-object v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v5, :cond_5

    new-instance v5, Lcom/android/internal/power/EnergyConsumerStats;

    iget-object v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-direct {v5, v10}, Lcom/android/internal/power/EnergyConsumerStats;-><init>(Lcom/android/internal/power/EnergyConsumerStats$Config;)V

    iput-object v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    :cond_5
    iget-object v10, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    iget-object v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v5, v5, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v5}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v14

    move/from16 v11, p1

    invoke-virtual/range {v10 .. v15}, Lcom/android/internal/power/EnergyConsumerStats;->updateCustomBucket(IJJ)V

    goto :goto_1

    :cond_6
    invoke-static {v5}, Landroid/os/Process;->isIsolated(I)Z

    move-result v6

    if-nez v6, :cond_3

    const-string/jumbo v6, "Received EnergyConsumer charge "

    const-string v10, " for custom bucket "

    move/from16 v11, p1

    invoke-static {v11, v6, v3, v4, v10}, Lcom/android/server/SystemServiceManager$$ExternalSyntheticOutline0;->m(ILjava/lang/String;JLjava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v6

    const-string v10, " for non-existent uid "

    invoke-virtual {v6, v10}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6, v5}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    const-string v6, "BatteryStatsImpl"

    invoke-static {v6, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    :goto_2
    add-int/lit8 v2, v2, 0x1

    goto :goto_0

    :cond_7
    :goto_3
    return-void
.end method

.method public final updateDailyDeadlineLocked()V
    .locals 5

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->currentTimeMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    invoke-static {}, Ljava/util/Calendar;->getInstance()Ljava/util/Calendar;

    move-result-object v2

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->setTimeInMillis(J)V

    const/4 v0, 0x6

    invoke-virtual {v2, v0}, Ljava/util/Calendar;->get(I)I

    move-result v1

    const/4 v3, 0x1

    add-int/2addr v1, v3

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->set(II)V

    const/16 v0, 0xe

    const/4 v1, 0x0

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->set(II)V

    const/16 v0, 0xd

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->set(II)V

    const/16 v0, 0xc

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->set(II)V

    const/16 v0, 0xb

    invoke-virtual {v2, v0, v3}, Ljava/util/Calendar;->set(II)V

    invoke-virtual {v2}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v3

    iput-wide v3, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    const/4 v1, 0x3

    invoke-virtual {v2, v0, v1}, Ljava/util/Calendar;->set(II)V

    invoke-virtual {v2}, Ljava/util/Calendar;->getTimeInMillis()J

    move-result-wide v0

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    return-void
.end method

.method public final updateDischargeScreenLevelsLocked(II)V
    .locals 2

    invoke-static {p1}, Landroid/view/Display;->isOnState(I)Z

    move-result v0

    if-eqz v0, :cond_0

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    sub-int/2addr v0, v1

    if-lez v0, :cond_2

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOn:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceCharge:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceCharge:I

    goto :goto_0

    :cond_0
    invoke-static {p1}, Landroid/view/Display;->isDozeState(I)Z

    move-result v0

    if-eqz v0, :cond_1

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    sub-int/2addr v0, v1

    if-lez v0, :cond_2

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDoze:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceCharge:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceCharge:I

    goto :goto_0

    :cond_1
    invoke-static {p1}, Landroid/view/Display;->isOffState(I)Z

    move-result v0

    if-eqz v0, :cond_2

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    sub-int/2addr v0, v1

    if-lez v0, :cond_2

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOff:I

    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceCharge:I

    add-int/2addr v1, v0

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceCharge:I

    :cond_2
    :goto_0
    invoke-static {p2}, Landroid/view/Display;->isOnState(I)Z

    move-result v0

    const/4 v1, 0x0

    if-eqz v0, :cond_3

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    goto :goto_1

    :cond_3
    invoke-static {p2}, Landroid/view/Display;->isDozeState(I)Z

    move-result v0

    if-eqz v0, :cond_4

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    goto :goto_1

    :cond_4
    invoke-static {p2}, Landroid/view/Display;->isOffState(I)Z

    move-result v0

    if-eqz v0, :cond_5

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevel:I

    iput v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevel:I

    iget v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    iput v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevel:I

    :cond_5
    :goto_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHandler:Lcom/android/server/power/stats/BatteryStatsImpl$MyHandler;

    new-instance v1, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda6;

    invoke-direct {v1, p0, p1, p2}, Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda6;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl;II)V

    invoke-virtual {v0, v1}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    return-void
.end method

.method public final updateDisplayEnergyConsumerStatsLocked([J[IJ)V
    .locals 14

    move-object/from16 v0, p2

    move-wide/from16 v7, p3

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_0

    goto/16 :goto_5

    :cond_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v1, v1

    array-length v2, v0

    if-ne v1, v2, :cond_1

    array-length v1, v0

    goto :goto_0

    :cond_1
    iget v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayMismatchWtfCount:I

    add-int/lit8 v2, v1, 0x1

    iput v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDisplayMismatchWtfCount:I

    rem-int/lit8 v1, v1, 0x64

    if-nez v1, :cond_2

    new-instance v1, Ljava/lang/StringBuilder;

    const-string/jumbo v2, "Mismatch between PowerProfile reported display count ("

    invoke-direct {v1, v2}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v2, v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, ") and PowerStatsHal reported display count ("

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    array-length v2, v0

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    const-string v2, ")"

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    const-string v2, "BatteryStatsImpl"

    invoke-static {v2, v1}, Landroid/util/Slog;->wtf(Ljava/lang/String;Ljava/lang/String;)I

    :cond_2
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v2, v1

    array-length v3, v0

    if-ge v2, v3, :cond_3

    array-length v1, v1

    goto :goto_0

    :cond_3
    array-length v1, v0

    :goto_0
    new-array v2, v1, [I

    const/4 v3, 0x0

    move v4, v3

    :goto_1
    if-ge v4, v1, :cond_4

    aget v5, v0, v4

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v6, v6, v4

    iget v9, v6, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenStateAtLastEnergyMeasurement:I

    aput v9, v2, v4

    iput v5, v6, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenStateAtLastEnergyMeasurement:I

    add-int/lit8 v4, v4, 0x1

    goto :goto_1

    :cond_4
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-nez v0, :cond_5

    goto :goto_5

    :cond_5
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    if-eqz v0, :cond_6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0

    move v1, v3

    :goto_2
    if-ge v1, v0, :cond_a

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    invoke-static {v2, v7, v8, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->-$$Nest$mmarkProcessForegroundTimeUs(Lcom/android/server/power/stats/BatteryStatsImpl$Uid;JZ)J

    add-int/lit8 v1, v1, 0x1

    goto :goto_2

    :cond_6
    const-wide/16 v4, 0x0

    move-object v6, v2

    move v0, v3

    move v9, v0

    move-wide v2, v4

    :goto_3
    if-ge v0, v1, :cond_9

    aget-wide v10, p1, v0

    cmp-long v12, v10, v4

    if-gtz v12, :cond_7

    goto :goto_4

    :cond_7
    aget v12, v6, v0

    invoke-static {v12}, Lcom/android/internal/power/EnergyConsumerStats;->getDisplayPowerBucket(I)I

    move-result v12

    iget-object v13, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    invoke-virtual {v13, v12, v10, v11}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    if-nez v12, :cond_8

    add-long/2addr v2, v10

    :cond_8
    :goto_4
    add-int/lit8 v0, v0, 0x1

    goto :goto_3

    :cond_9
    cmp-long v0, v2, v4

    if-gtz v0, :cond_b

    :cond_a
    :goto_5
    return-void

    :cond_b
    move-wide v0, v4

    new-instance v4, Landroid/util/SparseDoubleArray;

    invoke-direct {v4}, Landroid/util/SparseDoubleArray;-><init>()V

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v5}, Landroid/util/SparseArray;->size()I

    move-result v5

    :goto_6
    if-ge v9, v5, :cond_d

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v6, v9}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    const/4 v10, 0x1

    invoke-static {v6, v7, v8, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->-$$Nest$mmarkProcessForegroundTimeUs(Lcom/android/server/power/stats/BatteryStatsImpl$Uid;JZ)J

    move-result-wide v10

    cmp-long v12, v10, v0

    if-nez v12, :cond_c

    goto :goto_7

    :cond_c
    iget v6, v6, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    long-to-double v10, v10

    invoke-virtual {v4, v6, v10, v11}, Landroid/util/SparseDoubleArray;->put(ID)V

    :goto_7
    add-int/lit8 v9, v9, 0x1

    goto :goto_6

    :cond_d
    const/4 v1, 0x0

    const-wide/16 v5, 0x0

    move-object v0, p0

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    return-void
.end method

.method public final updateGnssEnergyConsumerStatsLocked(JJ)V
    .locals 17

    move-object/from16 v0, p0

    move-wide/from16 v2, p1

    move-wide/from16 v7, p3

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    if-nez v1, :cond_0

    goto/16 :goto_6

    :cond_0
    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v4, :cond_9

    const-wide/16 v4, 0x0

    cmp-long v6, v2, v4

    if-gtz v6, :cond_1

    goto/16 :goto_6

    :cond_1
    iget-boolean v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    const-wide/16 v9, 0x3e8

    const/16 v11, -0x2710

    const/4 v12, 0x0

    if-eqz v6, :cond_4

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    :goto_0
    if-ge v12, v1, :cond_9

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSensorStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v11}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;

    if-nez v2, :cond_2

    goto :goto_1

    :cond_2
    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;->mTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v2, :cond_3

    goto :goto_1

    :cond_3
    mul-long v3, v7, v9

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    invoke-virtual {v2, v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :goto_1
    add-int/lit8 v12, v12, 0x1

    goto :goto_0

    :cond_4
    const/4 v6, 0x6

    invoke-virtual {v1, v6, v2, v3}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    move-wide v5, v4

    new-instance v4, Landroid/util/SparseDoubleArray;

    invoke-direct {v4}, Landroid/util/SparseDoubleArray;-><init>()V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v1}, Landroid/util/SparseArray;->size()I

    move-result v1

    :goto_2
    if-ge v12, v1, :cond_8

    iget-object v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v13, v12}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v14, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSensorStats:Landroid/util/SparseArray;

    invoke-virtual {v14, v11}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;

    if-nez v14, :cond_5

    goto :goto_3

    :cond_5
    iget-object v14, v14, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;->mTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-nez v14, :cond_6

    :goto_3
    move-wide v15, v5

    goto :goto_4

    :cond_6
    move-wide v15, v5

    mul-long v5, v7, v9

    invoke-virtual {v14, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    invoke-virtual {v14, v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :goto_4
    cmp-long v14, v5, v15

    if-nez v14, :cond_7

    goto :goto_5

    :cond_7
    iget v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    long-to-double v5, v5

    invoke-virtual {v4, v13, v5, v6}, Landroid/util/SparseDoubleArray;->put(ID)V

    :goto_5
    add-int/lit8 v12, v12, 0x1

    move-wide v5, v15

    goto :goto_2

    :cond_8
    const/4 v1, 0x6

    const-wide/16 v5, 0x0

    invoke-virtual/range {v0 .. v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    :cond_9
    :goto_6
    return-void
.end method

.method public final updateKernelMemoryBandwidthLocked(J)V
    .locals 16

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryBandwidthStats:Lcom/android/internal/os/KernelMemoryBandwidthStats;

    invoke-virtual {v1}, Lcom/android/internal/os/KernelMemoryBandwidthStats;->updateStats()V

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryBandwidthStats:Lcom/android/internal/os/KernelMemoryBandwidthStats;

    invoke-virtual {v1}, Lcom/android/internal/os/KernelMemoryBandwidthStats;->getBandwidthEntries()Landroid/util/LongSparseLongArray;

    move-result-object v1

    invoke-virtual {v1}, Landroid/util/LongSparseLongArray;->size()I

    move-result v2

    const/4 v3, 0x0

    :goto_0
    if-ge v3, v2, :cond_1

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v1, v3}, Landroid/util/LongSparseLongArray;->keyAt(I)J

    move-result-wide v5

    invoke-virtual {v4, v5, v6}, Landroid/util/LongSparseArray;->indexOfKey(J)I

    move-result v4

    if-ltz v4, :cond_0

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v5, v4}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    :goto_1
    move-object v8, v4

    goto :goto_2

    :cond_0
    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v1, v3}, Landroid/util/LongSparseLongArray;->keyAt(I)J

    move-result-wide v6

    invoke-virtual {v5, v6, v7, v4}, Landroid/util/LongSparseArray;->put(JLjava/lang/Object;)V

    goto :goto_1

    :goto_2
    invoke-virtual {v1, v3}, Landroid/util/LongSparseLongArray;->valueAt(I)J

    move-result-wide v9

    const-wide/16 v11, 0x0

    const/4 v13, 0x1

    move-wide/from16 v14, p1

    invoke-virtual/range {v8 .. v15}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    add-int/lit8 v3, v3, 0x1

    goto :goto_0

    :cond_1
    return-void
.end method

.method public final updateKernelWakelocksLocked(J)V
    .locals 14

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockReader:Lcom/android/server/power/stats/KernelWakelockReader;

    if-nez v0, :cond_0

    goto/16 :goto_2

    :cond_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpWakelockStats:Lcom/android/server/power/stats/KernelWakelockStats;

    invoke-virtual {v0, v1}, Lcom/android/server/power/stats/KernelWakelockReader;->readKernelWakelockStats(Lcom/android/server/power/stats/KernelWakelockStats;)Lcom/android/server/power/stats/KernelWakelockStats;

    move-result-object v0

    if-nez v0, :cond_1

    const-string p0, "BatteryStatsImpl"

    const-string v0, "Couldn\'t get kernel wake lock stats"

    invoke-static {p0, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    return-void

    :cond_1
    invoke-virtual {v0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :goto_0
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_3

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/Map$Entry;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v3

    check-cast v3, Ljava/lang/String;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/KernelWakelockStats$Entry;

    iget-object v4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v4, v3}, Ljava/util/HashMap;->get(Ljava/lang/Object;)Ljava/lang/Object;

    move-result-object v4

    check-cast v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-nez v4, :cond_2

    new-instance v4, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    iget-object v6, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v4, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;-><init>(Lcom/android/internal/os/Clock;Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v5, v3, v4}, Ljava/util/HashMap;->put(Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;

    :cond_2
    move-object v6, v4

    iget-wide v7, v2, Lcom/android/server/power/stats/KernelWakelockStats$Entry;->totalTimeUs:J

    iget-wide v9, v2, Lcom/android/server/power/stats/KernelWakelockStats$Entry;->activeTimeUs:J

    iget v11, v2, Lcom/android/server/power/stats/KernelWakelockStats$Entry;->count:I

    move-wide v12, p1

    invoke-virtual/range {v6 .. v13}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    iget v2, v2, Lcom/android/server/power/stats/KernelWakelockStats$Entry;->version:I

    iput v2, v6, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mUpdateVersion:I

    goto :goto_0

    :cond_3
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {p0}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object p0

    invoke-interface {p0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object p0

    :goto_1
    invoke-interface {p0}, Ljava/util/Iterator;->hasNext()Z

    move-result v1

    if-eqz v1, :cond_5

    invoke-interface {p0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Ljava/util/Map$Entry;

    invoke-interface {v1}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v1

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mUpdateVersion:I

    iget v3, v0, Lcom/android/server/power/stats/KernelWakelockStats;->kernelWakelockVersion:I

    if-eq v2, v3, :cond_4

    const-wide/16 v2, 0x0

    move-wide v12, p1

    invoke-virtual {v1, v2, v3, v12, v13}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->computeRunTimeLocked(JJ)J

    move-result-wide v4

    iput-wide v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mTotalTimeUs:J

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->computeCurrentCountLocked()I

    move-result v4

    iput v4, v1, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->mCount:I

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mCurrentReportedTotalTimeUs:J

    iput-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mBaseReportedTotalTimeUs:J

    const/4 v2, 0x0

    iput v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mCurrentReportedCount:I

    iput v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mBaseReportedCount:I

    iput-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->mTrackingReportedValues:Z

    goto :goto_1

    :cond_4
    move-wide v12, p1

    goto :goto_1

    :cond_5
    :goto_2
    return-void
.end method

.method public final updateOldDischargeSilentLogOnLevelPermilLocked(II)V
    .locals 0

    invoke-static {p1}, Landroid/view/Display;->isOnState(I)Z

    move-result p1

    if-eqz p1, :cond_0

    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    sub-int/2addr p1, p2

    if-lez p1, :cond_1

    iget p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    add-int/2addr p2, p1

    iput p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    return-void

    :cond_0
    iget p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    sub-int/2addr p1, p2

    if-lez p1, :cond_1

    iget p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    add-int/2addr p2, p1

    iput p2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    :cond_1
    return-void
.end method

.method public updateProcStateCpuTimesLocked(IJJ)V
    .locals 8

    iget-object p4, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerStatsCollectorEnabled:Landroid/util/SparseBooleanArray;

    const/4 p5, 0x1

    invoke-virtual {p4, p5}, Landroid/util/SparseBooleanArray;->get(I)Z

    move-result p4

    if-eqz p4, :cond_0

    goto :goto_2

    :cond_0
    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->ensureKernelSingleUidTimeReaderLocked()V

    invoke-virtual {p0, p1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(I)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object p4

    iget-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumSingleUidCpuTimeReads:J

    const-wide/16 v2, 0x1

    add-long/2addr v0, v2

    iput-wide v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumSingleUidCpuTimeReads:J

    sget-object v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->sTempBinderCallStats:Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;

    invoke-virtual {p4, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v0, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {p4, p2, p3}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->ensureMultiStateCounters(J)V

    iget-object v1, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual {v2, p1, v0, p2, p3}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J)V

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    invoke-virtual {v2, p1, v1, p2, p3}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J)V

    iget-object p1, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mChildUids:Landroid/util/SparseArray;

    if-eqz p1, :cond_3

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    if-nez p1, :cond_1

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCpuScalingPolicies:Lcom/android/internal/os/CpuScalingPolicies;

    invoke-virtual {p1}, Lcom/android/internal/os/CpuScalingPolicies;->getScalingStepCount()I

    move-result p1

    new-array p1, p1, [J

    iput-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    :cond_1
    iget-object v7, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpCpuTimeInFreq:[J

    iget-object p1, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mChildUids:Landroid/util/SparseArray;

    invoke-virtual {p1}, Landroid/util/SparseArray;->size()I

    move-result p1

    sub-int/2addr p1, p5

    :goto_0
    if-ltz p1, :cond_3

    iget-object p5, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mChildUids:Landroid/util/SparseArray;

    invoke-virtual {p5, p1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object p5

    check-cast p5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$ChildUid;

    iget-object v4, p5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$ChildUid;->cpuTimeInFreqCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    if-eqz v4, :cond_2

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelSingleUidTimeReader:Lcom/android/internal/os/KernelSingleUidTimeReader;

    iget-object p5, p4, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mChildUids:Landroid/util/SparseArray;

    invoke-virtual {p5, p1}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v3

    move-wide v5, p2

    invoke-virtual/range {v2 .. v7}, Lcom/android/internal/os/KernelSingleUidTimeReader;->addDelta(ILcom/android/internal/os/LongArrayMultiStateCounter;J[J)V

    invoke-virtual {v0, v7}, Lcom/android/internal/os/LongArrayMultiStateCounter;->addCounts([J)V

    invoke-virtual {v1, v7}, Lcom/android/internal/os/LongArrayMultiStateCounter;->addCounts([J)V

    goto :goto_1

    :cond_2
    move-wide v5, p2

    :goto_1
    add-int/lit8 p1, p1, -0x1

    move-wide p2, v5

    goto :goto_0

    :cond_3
    :goto_2
    return-void
.end method

.method public final updateRailStatsLocked()V
    .locals 2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mCustomEnergyConsumerPowerStatsCollector:Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;

    iget-boolean v1, v0, Lcom/android/server/power/stats/PowerStatsCollector;->mEnabled:Z

    if-eqz v1, :cond_0

    invoke-virtual {v0}, Lcom/android/server/power/stats/CustomEnergyConsumerPowerStatsCollector;->schedule()Z

    return-void

    :cond_0
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerRetriever:Lcom/android/server/am/BatteryStatsService;

    if-eqz v0, :cond_2

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    invoke-virtual {v0}, Lcom/android/internal/os/RailStats;->isRailStatsAvailable()Z

    move-result v0

    if-nez v0, :cond_1

    goto :goto_0

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerRetriever:Lcom/android/server/am/BatteryStatsService;

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    invoke-virtual {v0, p0}, Lcom/android/server/am/BatteryStatsService;->fillRailDataStats(Lcom/android/internal/os/RailStats;)V

    :cond_2
    :goto_0
    return-void
.end method

.method public final updateRpmStatsLocked(J)V
    .locals 23

    move-object/from16 v0, p0

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRpmStats:Lcom/android/internal/os/RpmStats;

    if-nez v1, :cond_0

    goto/16 :goto_2

    :cond_0
    iget-object v1, v1, Lcom/android/internal/os/RpmStats;->mPlatformLowPowerStats:Ljava/util/Map;

    invoke-interface {v1}, Ljava/util/Map;->entrySet()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :cond_1
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    const-string v3, "."

    const-wide/16 v4, 0x3e8

    if-eqz v2, :cond_2

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/Map$Entry;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;

    iget-wide v7, v7, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;->mTimeMs:J

    mul-long v10, v7, v4

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;

    iget v14, v7, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;->mCount:I

    invoke-virtual {v0, v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRpmTimerLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    move-result-object v9

    const-wide/16 v12, 0x0

    move-wide/from16 v15, p1

    invoke-virtual/range {v9 .. v16}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;

    iget-object v2, v2, Lcom/android/internal/os/RpmStats$PowerStatePlatformSleepState;->mVoters:Ljava/util/Map;

    invoke-interface {v2}, Ljava/util/Map;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_0
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_1

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/util/Map$Entry;

    invoke-static {v6, v3}, Lcom/android/internal/util/jobs/Preconditions$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-interface {v7}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/internal/os/RpmStats$PowerStateElement;

    iget-wide v9, v9, Lcom/android/internal/os/RpmStats$PowerStateElement;->mTimeMs:J

    mul-long v16, v9, v4

    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/internal/os/RpmStats$PowerStateElement;

    iget v7, v7, Lcom/android/internal/os/RpmStats$PowerStateElement;->mCount:I

    invoke-virtual {v0, v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRpmTimerLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    move-result-object v15

    const-wide/16 v18, 0x0

    move-wide/from16 v21, p1

    move/from16 v20, v7

    invoke-virtual/range {v15 .. v22}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    goto :goto_0

    :cond_2
    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRpmStats:Lcom/android/internal/os/RpmStats;

    iget-object v1, v1, Lcom/android/internal/os/RpmStats;->mSubsystemLowPowerStats:Ljava/util/Map;

    invoke-interface {v1}, Ljava/util/Map;->entrySet()Ljava/util/Set;

    move-result-object v1

    invoke-interface {v1}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v1

    :cond_3
    invoke-interface {v1}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_4

    invoke-interface {v1}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/Map$Entry;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/internal/os/RpmStats$PowerStateSubsystem;

    iget-object v2, v2, Lcom/android/internal/os/RpmStats$PowerStateSubsystem;->mStates:Ljava/util/Map;

    invoke-interface {v2}, Ljava/util/Map;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_1
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v7

    if-eqz v7, :cond_3

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Ljava/util/Map$Entry;

    invoke-static {v6, v3}, Lcom/android/internal/util/jobs/Preconditions$$ExternalSyntheticOutline0;->m(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v8

    invoke-interface {v7}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Ljava/lang/String;

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/internal/os/RpmStats$PowerStateElement;

    iget-wide v9, v9, Lcom/android/internal/os/RpmStats$PowerStateElement;->mTimeMs:J

    mul-long v16, v9, v4

    invoke-interface {v7}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v7

    check-cast v7, Lcom/android/internal/os/RpmStats$PowerStateElement;

    iget v7, v7, Lcom/android/internal/os/RpmStats$PowerStateElement;->mCount:I

    invoke-virtual {v0, v8}, Lcom/android/server/power/stats/BatteryStatsImpl;->getRpmTimerLocked(Ljava/lang/String;)Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    move-result-object v15

    const-wide/16 v18, 0x0

    move-wide/from16 v21, p1

    move/from16 v20, v7

    invoke-virtual/range {v15 .. v22}, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;->update(JJIJ)V

    goto :goto_1

    :cond_4
    :goto_2
    return-void
.end method

.method public final updateSemModemActivityInfoLocked(Landroid/os/SemModemActivityInfo;)V
    .locals 5

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->toString()Ljava/lang/String;

    move-result-object v0

    const-string v1, "BatteryStatsImpl"

    invoke-static {v1, v0}, Landroid/util/Slog;->d(Ljava/lang/String;Ljava/lang/String;)I

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getSleepTimeMillis()I

    move-result v1

    int-to-long v1, v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getIdleTimeMillis()I

    move-result v1

    int-to-long v1, v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    const/4 v0, 0x0

    move v1, v0

    :goto_0
    const/4 v2, 0x5

    if-ge v1, v2, :cond_0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mTxTimeMillis:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v2, v2, v1

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getNrTxTimeMillis()[I

    move-result-object v3

    aget v3, v3, v1

    int-to-long v3, v3

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    add-int/lit8 v1, v1, 0x1

    goto :goto_0

    :cond_0
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mRxTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getNrRxTimeMillis()I

    move-result v3

    int-to-long v3, v3

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mTxByte:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getNrTxBytes()J

    move-result-wide v3

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mRxByte:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getNrRxBytes()J

    move-result-wide v3

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    :goto_1
    if-ge v0, v2, :cond_1

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mTxTimeMillis:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v1, v1, v0

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getLcTxTimeMillis()[I

    move-result-object v3

    aget v3, v3, v0

    int-to-long v3, v3

    invoke-virtual {v1, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_1

    :cond_1
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mRxTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getLcRxTimeMillis()I

    move-result v1

    int-to-long v1, v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mTxByte:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getLcTxBytes()J

    move-result-wide v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->mRxByte:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {p1}, Landroid/os/SemModemActivityInfo;->getLcRxBytes()J

    move-result-wide v0

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    return-void
.end method

.method public final updateSpeakerOutEnergyInfoLocked(Landroid/os/SpeakerOutEnergyInfo;JJ)V
    .locals 19

    move-object/from16 v0, p0

    move-wide/from16 v1, p2

    const/16 v3, 0x10

    new-array v7, v3, [J

    new-array v8, v3, [J

    const/4 v4, 0x0

    :goto_0
    if-ge v4, v3, :cond_0

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v5

    aget-wide v5, v5, v4

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

    invoke-virtual {v9}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v9

    aget-wide v11, v9, v4

    sub-long/2addr v5, v11

    aput-wide v5, v7, v4

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerCallTimeMillis()[J

    move-result-object v5

    aget-wide v5, v5, v4

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

    invoke-virtual {v9}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerCallTimeMillis()[J

    move-result-object v9

    aget-wide v11, v9, v4

    sub-long/2addr v5, v11

    aput-wide v5, v8, v4

    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_0
    const/4 v4, 0x0

    :goto_1
    const-wide/16 v11, 0x0

    if-ge v4, v3, :cond_3

    aget-wide v5, v7, v4

    cmp-long v5, v5, v11

    if-ltz v5, :cond_2

    aget-wide v5, v8, v4

    cmp-long v5, v5, v11

    if-gez v5, :cond_1

    goto :goto_2

    :cond_1
    add-int/lit8 v4, v4, 0x1

    goto :goto_1

    :cond_2
    :goto_2
    new-instance v13, Landroid/os/SpeakerOutEnergyInfo;

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getTimestamp()J

    move-result-wide v14

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v16

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerCallTimeMillis()[J

    move-result-object v17

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getEnergyUsed()I

    move-result v18

    invoke-direct/range {v13 .. v18}, Landroid/os/SpeakerOutEnergyInfo;-><init>(J[J[JI)V

    new-instance v4, Ljava/lang/StringBuilder;

    const-string v5, "Audio energy data was reset, new energy data is "

    invoke-direct {v4, v5}, Ljava/lang/StringBuilder;-><init>(Ljava/lang/String;)V

    invoke-virtual {v4, v13}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    const-string v5, "BatteryStatsImpl"

    invoke-static {v5, v4}, Landroid/util/Slog;->v(Ljava/lang/String;Ljava/lang/String;)I

    :goto_3
    move-object/from16 v4, p1

    goto :goto_4

    :cond_3
    new-instance v4, Landroid/os/SpeakerOutEnergyInfo;

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getTimestamp()J

    move-result-wide v5

    invoke-virtual/range {p1 .. p1}, Landroid/os/SpeakerOutEnergyInfo;->getEnergyUsed()I

    move-result v9

    iget-object v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

    invoke-virtual {v13}, Landroid/os/SpeakerOutEnergyInfo;->getEnergyUsed()I

    move-result v13

    sub-int/2addr v9, v13

    invoke-direct/range {v4 .. v9}, Landroid/os/SpeakerOutEnergyInfo;-><init>(J[J[JI)V

    move-object v13, v4

    goto :goto_3

    :goto_4
    iput-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastAudioOutEnergyInfo:Landroid/os/SpeakerOutEnergyInfo;

    iget-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v4, :cond_13

    const/4 v4, 0x1

    iput-boolean v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasSpeakerOutReporting:Z

    move-wide v7, v11

    const/4 v5, 0x0

    const/4 v6, 0x0

    :goto_5
    if-ge v5, v3, :cond_5

    invoke-virtual {v13}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v9

    aget-wide v14, v9, v5

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v9, v9, v5

    invoke-virtual {v9, v14, v15}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v9, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v9, v9, v5

    invoke-virtual {v13}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerCallTimeMillis()[J

    move-result-object v16

    move/from16 v17, v5

    aget-wide v4, v16, v17

    invoke-virtual {v9, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    cmp-long v4, v14, v7

    if-lez v4, :cond_4

    move-wide v7, v14

    move/from16 v6, v17

    :cond_4
    add-int/lit8 v5, v17, 0x1

    const/4 v4, 0x1

    goto :goto_5

    :cond_5
    const/16 v4, 0xb

    if-le v6, v4, :cond_6

    const/4 v4, 0x1

    goto :goto_6

    :cond_6
    const/4 v4, 0x0

    :goto_6
    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v5}, Lcom/android/internal/os/BatteryStatsHistory;->getHighSpeakerVolumeState()B

    move-result v5

    if-eq v5, v4, :cond_7

    iget-object v5, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {v5, v4}, Lcom/android/internal/os/BatteryStatsHistory;->setHighSpeakerVolumeState(B)V

    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move-wide/from16 v5, p4

    invoke-virtual {v4, v1, v2, v5, v6}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistoryItem(JJ)V

    :cond_7
    iget-object v4, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v4}, Landroid/util/SparseArray;->size()I

    move-result v4

    move-wide v6, v11

    const/4 v5, 0x0

    :goto_7
    if-ge v5, v4, :cond_a

    iget-object v14, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v14, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v14

    check-cast v14, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v14, v14, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v14, :cond_8

    goto :goto_9

    :cond_8
    const-wide/16 p4, 0x3e8

    mul-long v8, v1, p4

    if-nez v14, :cond_9

    move-wide v8, v11

    goto :goto_8

    :cond_9
    invoke-virtual {v14, v8, v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v8

    div-long v8, v8, p4

    :goto_8
    add-long/2addr v6, v8

    :goto_9
    add-int/lit8 v5, v5, 0x1

    goto :goto_7

    :cond_a
    const-wide/16 p4, 0x3e8

    cmp-long v5, v6, v11

    if-nez v5, :cond_b

    goto/16 :goto_f

    :cond_b
    const/4 v5, 0x0

    :goto_a
    if-ge v5, v4, :cond_13

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v8, v5}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v9, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-nez v9, :cond_d

    :cond_c
    move/from16 p1, v4

    goto :goto_e

    :cond_d
    mul-long v14, v1, p4

    if-nez v9, :cond_e

    move-wide v14, v11

    goto :goto_b

    :cond_e
    invoke-virtual {v9, v14, v15}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v14

    div-long v14, v14, p4

    :goto_b
    cmp-long v9, v14, v11

    if-lez v9, :cond_c

    const/4 v9, 0x0

    :goto_c
    if-ge v9, v3, :cond_11

    invoke-virtual {v13}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v16

    aget-wide v16, v16, v9

    cmp-long v16, v16, v11

    if-lez v16, :cond_10

    invoke-virtual {v13}, Landroid/os/SpeakerOutEnergyInfo;->getSpeakerMediaTimeMillis()[J

    move-result-object v16

    aget-wide v16, v16, v9

    mul-long v16, v16, v14

    move/from16 p1, v4

    div-long v3, v16, v6

    iget-object v10, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v10, :cond_f

    invoke-virtual {v8}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->initSpeakerTimeCounterLocked()V

    :cond_f
    iget-object v10, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v10, v10, v9

    invoke-virtual {v10, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    goto :goto_d

    :cond_10
    move/from16 p1, v4

    :goto_d
    add-int/lit8 v9, v9, 0x1

    move/from16 v4, p1

    const/16 v3, 0x10

    goto :goto_c

    :cond_11
    move/from16 p1, v4

    iget-object v3, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v3, :cond_12

    invoke-virtual {v3, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :cond_12
    :goto_e
    add-int/lit8 v5, v5, 0x1

    move/from16 v4, p1

    const/16 v3, 0x10

    goto :goto_a

    :cond_13
    :goto_f
    return-void
.end method

.method public updateSystemServerThreadStats()V
    .locals 14

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mSystemServerCpuThreadReader:Lcom/android/server/power/stats/SystemServerCpuThreadReader;

    iget-object v1, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mKernelCpuThreadReader:Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;

    invoke-virtual {v1}, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;->getCpuFrequencyCount()I

    move-result v1

    iget-object v2, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastThreadCpuTimesUs:[J

    iget-object v3, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mDeltaCpuThreadTimes:Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;

    if-nez v2, :cond_0

    new-array v2, v1, [J

    iput-object v2, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastThreadCpuTimesUs:[J

    new-array v2, v1, [J

    iput-object v2, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastBinderThreadCpuTimesUs:[J

    new-array v2, v1, [J

    iput-object v2, v3, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->threadCpuTimesUs:[J

    new-array v2, v1, [J

    iput-object v2, v3, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->binderThreadCpuTimesUs:[J

    :cond_0
    iget-object v2, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mKernelCpuThreadReader:Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;

    invoke-virtual {v2}, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader;->getProcessCpuUsage()Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;

    move-result-object v2

    if-nez v2, :cond_1

    const/4 v3, 0x0

    goto :goto_1

    :cond_1
    add-int/lit8 v1, v1, -0x1

    :goto_0
    if-ltz v1, :cond_2

    iget-object v4, v2, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;->threadCpuTimesMillis:[J

    aget-wide v4, v4, v1

    const-wide/16 v6, 0x3e8

    mul-long/2addr v4, v6

    iget-object v8, v2, Lcom/android/internal/os/KernelSingleProcessCpuThreadReader$ProcessCpuUsage;->selectedThreadCpuTimesMillis:[J

    aget-wide v8, v8, v1

    mul-long/2addr v8, v6

    iget-object v6, v3, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->threadCpuTimesUs:[J

    iget-object v7, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastThreadCpuTimesUs:[J

    aget-wide v10, v7, v1

    sub-long v10, v4, v10

    const-wide/16 v12, 0x0

    invoke-static {v12, v13, v10, v11}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v10

    aput-wide v10, v6, v1

    iget-object v6, v3, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->binderThreadCpuTimesUs:[J

    iget-object v7, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastBinderThreadCpuTimesUs:[J

    aget-wide v10, v7, v1

    sub-long v10, v8, v10

    invoke-static {v12, v13, v10, v11}, Ljava/lang/Math;->max(JJ)J

    move-result-wide v10

    aput-wide v10, v6, v1

    iget-object v6, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastThreadCpuTimesUs:[J

    aput-wide v4, v6, v1

    iget-object v4, v0, Lcom/android/server/power/stats/SystemServerCpuThreadReader;->mLastBinderThreadCpuTimesUs:[J

    aput-wide v8, v4, v1

    add-int/lit8 v1, v1, -0x1

    goto :goto_0

    :cond_2
    :goto_1
    if-nez v3, :cond_3

    return-void

    :cond_3
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBinderThreadCpuTimesUs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-nez v0, :cond_4

    new-instance v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-direct {v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;-><init>(Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;)V

    iput-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBinderThreadCpuTimesUs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    :cond_4
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mBinderThreadCpuTimesUs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v0, v3, Lcom/android/server/power/stats/SystemServerCpuThreadReader$SystemServiceCpuThreadTimes;->binderThreadCpuTimesUs:[J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->mTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->addCountLocked([JZ)V

    return-void
.end method

.method public updateSystemServiceCallStats()V
    .locals 23

    move-object/from16 v0, p0

    const/4 v4, 0x0

    const/4 v5, 0x0

    const-wide/16 v6, 0x0

    :goto_0
    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v8}, Landroid/util/SparseArray;->size()I

    move-result v8

    if-ge v4, v8, :cond_1

    iget-object v8, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v8, v4}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBinderCallStats:Landroid/util/ArraySet;

    invoke-virtual {v8}, Landroid/util/ArraySet;->size()I

    move-result v9

    add-int/lit8 v9, v9, -0x1

    :goto_1
    if-ltz v9, :cond_0

    invoke-virtual {v8, v9}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;

    int-to-long v11, v5

    iget-wide v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;->recordedCallCount:J

    add-long/2addr v11, v13

    long-to-int v5, v11

    iget-wide v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;->recordedCpuTimeMicros:J

    add-long/2addr v6, v10

    add-int/lit8 v9, v9, -0x1

    goto :goto_1

    :cond_0
    add-int/lit8 v4, v4, 0x1

    goto :goto_0

    :cond_1
    const/4 v4, 0x0

    const-wide/16 v8, 0x0

    :goto_2
    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v10}, Landroid/util/SparseArray;->size()I

    move-result v10

    if-ge v4, v10, :cond_6

    iget-object v10, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v10, v4}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBinderCallStats:Landroid/util/ArraySet;

    invoke-virtual {v11}, Landroid/util/ArraySet;->size()I

    move-result v12

    add-int/lit8 v12, v12, -0x1

    const/4 v13, 0x0

    const-wide/16 v14, 0x0

    :goto_3
    if-ltz v12, :cond_4

    invoke-virtual {v11, v12}, Landroid/util/ArraySet;->valueAt(I)Ljava/lang/Object;

    move-result-object v16

    move-object/from16 v1, v16

    check-cast v1, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;

    const-wide/16 v17, 0x0

    int-to-long v2, v13

    move-wide/from16 v19, v2

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;->callCount:J

    move-wide/from16 v21, v2

    add-long v2, v19, v21

    long-to-int v13, v2

    iget-wide v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;->recordedCallCount:J

    cmp-long v16, v2, v17

    if-lez v16, :cond_2

    move-wide/from16 v19, v2

    iget-wide v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$BinderCallStats;->recordedCpuTimeMicros:J

    mul-long v2, v21, v1

    div-long v2, v2, v19

    :goto_4
    add-long/2addr v14, v2

    goto :goto_5

    :cond_2
    if-lez v5, :cond_3

    mul-long v2, v21, v6

    move-wide/from16 v19, v2

    int-to-long v1, v5

    div-long v2, v19, v1

    goto :goto_4

    :cond_3
    :goto_5
    add-int/lit8 v12, v12, -0x1

    goto :goto_3

    :cond_4
    const-wide/16 v17, 0x0

    int-to-long v1, v13

    iget-wide v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBinderCallCount:J

    cmp-long v3, v1, v11

    if-gez v3, :cond_5

    if-lez v5, :cond_5

    sub-long/2addr v11, v1

    mul-long/2addr v11, v6

    int-to-long v1, v5

    div-long/2addr v11, v1

    add-long/2addr v14, v11

    :cond_5
    iput-wide v14, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemServiceTimeUs:J

    add-long/2addr v8, v14

    add-int/lit8 v4, v4, 0x1

    goto :goto_2

    :cond_6
    const-wide/16 v17, 0x0

    const/4 v1, 0x0

    :goto_6
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I

    move-result v2

    if-ge v1, v2, :cond_8

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    cmp-long v3, v8, v17

    if-lez v3, :cond_7

    iget-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemServiceTimeUs:J

    long-to-double v3, v3

    long-to-double v5, v8

    div-double/2addr v3, v5

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProportionalSystemServiceUsage:D

    goto :goto_7

    :cond_7
    const-wide/16 v3, 0x0

    iput-wide v3, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProportionalSystemServiceUsage:D

    :goto_7
    add-int/lit8 v1, v1, 0x1

    goto :goto_6

    :cond_8
    return-void
.end method

.method public final updateTimeBasesLocked(IJJZ)V
    .locals 11

    move-wide v3, p4

    move/from16 v5, p6

    invoke-static {p1}, Landroid/view/Display;->isOnState(I)Z

    move-result p1

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    const/4 v6, 0x1

    const/4 v7, 0x0

    if-eq v5, v0, :cond_0

    move v8, v6

    goto :goto_0

    :cond_0
    move v8, v7

    :goto_0
    if-eqz v5, :cond_1

    if-nez p1, :cond_1

    move v0, v6

    goto :goto_1

    :cond_1
    move v0, v7

    :goto_1
    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eq v0, v1, :cond_2

    move v9, v6

    goto :goto_2

    :cond_2
    move v9, v7

    :goto_2
    if-nez v9, :cond_3

    if-eqz v8, :cond_a

    :cond_3
    if-eqz v9, :cond_4

    invoke-virtual {p0, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateKernelWakelocksLocked(J)V

    :try_start_0
    const-string/jumbo v0, "batteryproperties"

    invoke-static {v0}, Landroid/os/ServiceManager;->getService(Ljava/lang/String;)Landroid/os/IBinder;

    move-result-object v0

    invoke-static {v0}, Landroid/os/IBatteryPropertiesRegistrar$Stub;->asInterface(Landroid/os/IBinder;)Landroid/os/IBatteryPropertiesRegistrar;

    move-result-object v0

    if-eqz v0, :cond_4

    invoke-interface {v0}, Landroid/os/IBatteryPropertiesRegistrar;->scheduleUpdate()V
    :try_end_0
    .catch Landroid/os/RemoteException; {:try_start_0 .. :try_end_0} :catch_0

    :catch_0
    :cond_4
    if-eqz v8, :cond_5

    invoke-virtual {p0, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateRpmStatsLocked(J)V

    :cond_5
    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-wide v1, p2

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    const/4 v10, 0x3

    if-eqz v8, :cond_7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0

    sub-int/2addr v0, v6

    move v8, v0

    :goto_3
    if-ltz v8, :cond_7

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, v8}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eqz v1, :cond_6

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    if-lt v1, v10, :cond_6

    move v5, v6

    goto :goto_4

    :cond_6
    move v5, v7

    :goto_4
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-wide v1, p2

    move-wide v3, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    add-int/lit8 v8, v8, -0x1

    goto :goto_3

    :cond_7
    if-eqz v9, :cond_a

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    if-eqz p6, :cond_8

    if-nez p1, :cond_8

    move v5, v6

    :goto_5
    move-wide v1, p2

    move-wide v3, p4

    goto :goto_6

    :cond_8
    move v5, v7

    goto :goto_5

    :goto_6
    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {p1}, Landroid/util/SparseArray;->size()I

    move-result p1

    sub-int/2addr p1, v6

    :goto_7
    if-ltz p1, :cond_a

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, p1}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBsi:Lcom/android/server/power/stats/BatteryStatsImpl;

    iget-object v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    iget-boolean v1, v1, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->mRunning:Z

    if-eqz v1, :cond_9

    iget v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessState:I

    if-lt v1, v10, :cond_9

    move v5, v6

    goto :goto_8

    :cond_9
    move v5, v7

    :goto_8
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-wide v1, p2

    move-wide v3, p4

    invoke-virtual/range {v0 .. v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->setRunning(JJZ)Z

    add-int/lit8 p1, p1, -0x1

    goto :goto_7

    :cond_a
    return-void
.end method

.method public final updateTxPowerSharing()V
    .locals 3

    monitor-enter p0

    :try_start_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingOn:Z

    if-eqz v0, :cond_0

    invoke-virtual {p0}, Lcom/android/server/power/stats/BatteryStatsImpl;->noteStopTxPowerSharingLocked()V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v0

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v2}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    iget-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingOn:Z

    if-nez v2, :cond_0

    const/4 v2, 0x1

    iput-boolean v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingOn:Z

    iget-object v2, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->startRunningLocked(J)V

    goto :goto_0

    :catchall_0
    move-exception v0

    goto :goto_1

    :cond_0
    :goto_0
    monitor-exit p0

    return-void

    :goto_1
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    throw v0
.end method

.method public final updateWifiBatteryStats(Landroid/os/connectivity/WifiActivityEnergyInfo;Landroid/net/NetworkStats;JJJ)V
    .locals 49

    move-object/from16 v1, p0

    move-object/from16 v0, p2

    monitor-enter p0

    if-eqz v0, :cond_0

    :try_start_0
    invoke-virtual {v1, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->notifyNetworkStatsUpdatedCallbacksLocked(Landroid/net/NetworkStats;)V

    goto :goto_0

    :catchall_0
    move-exception v0

    goto/16 :goto_17

    :cond_0
    :goto_0
    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryInternal:Z

    if-eqz v2, :cond_26

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mIgnoreNextExternalStats:Z

    if-eqz v2, :cond_1

    goto/16 :goto_16

    :cond_1
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const-wide/16 v9, 0x0

    if-eqz v2, :cond_2

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    if-eqz v2, :cond_2

    cmp-long v2, p3, v9

    if-lez v2, :cond_2

    new-instance v2, Landroid/util/SparseDoubleArray;

    invoke-direct {v2}, Landroid/util/SparseDoubleArray;-><init>()V

    :goto_1
    move-object v11, v2

    goto :goto_2

    :cond_2
    const/4 v2, 0x0

    goto :goto_1

    :goto_2
    new-instance v12, Landroid/util/SparseLongArray;

    invoke-direct {v12}, Landroid/util/SparseLongArray;-><init>()V

    new-instance v13, Landroid/util/SparseLongArray;

    invoke-direct {v13}, Landroid/util/SparseLongArray;-><init>()V

    new-instance v14, Landroid/util/SparseLongArray;

    invoke-direct {v14}, Landroid/util/SparseLongArray;-><init>()V

    new-instance v15, Landroid/util/SparseLongArray;

    invoke-direct {v15}, Landroid/util/SparseLongArray;-><init>()V

    const/16 v16, 0x0

    const-wide/16 v17, 0x3e8

    if-eqz v0, :cond_f

    invoke-virtual {v0}, Landroid/net/NetworkStats;->iterator()Ljava/util/Iterator;

    move-result-object v0

    move-wide/from16 v19, v9

    move-wide/from16 v21, v19

    :goto_3
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_e

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    move-object/from16 v23, v2

    check-cast v23, Landroid/net/NetworkStats$Entry;

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v2

    cmp-long v2, v2, v9

    if-nez v2, :cond_3

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v2

    cmp-long v2, v2, v9

    if-nez v2, :cond_3

    goto :goto_3

    :cond_3
    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getUid()I

    move-result v2

    invoke-virtual {v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl;->mapUid(I)I

    move-result v2

    move-wide/from16 v3, p5

    move-wide/from16 v5, p7

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v24

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v5

    cmp-long v5, v5, v9

    if-eqz v5, :cond_5

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v26

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v28

    const/16 v25, 0x2

    invoke-virtual/range {v24 .. v29}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getSet()I

    move-result v5

    if-nez v5, :cond_4

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v26

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v28

    const/16 v25, 0x8

    invoke-virtual/range {v24 .. v29}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    :cond_4
    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const/4 v6, 0x2

    aget-object v5, v5, v6

    move-wide/from16 v30, v9

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxBytes()J

    move-result-wide v9

    invoke-virtual {v5, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v5, v5, v6

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v9

    invoke-virtual {v5, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v5

    invoke-virtual {v12, v2, v5, v6}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v5

    add-long v21, v21, v5

    goto :goto_4

    :cond_5
    move-wide/from16 v30, v9

    :goto_4
    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v5

    cmp-long v5, v5, v30

    if-eqz v5, :cond_7

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v26

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v28

    const/16 v25, 0x3

    invoke-virtual/range {v24 .. v29}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getSet()I

    move-result v5

    if-nez v5, :cond_6

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v26

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v28

    const/16 v25, 0x9

    invoke-virtual/range {v24 .. v29}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->noteNetworkActivityLocked(IJJ)V

    move-object/from16 v5, v24

    goto :goto_5

    :cond_6
    move-object/from16 v5, v24

    :goto_5
    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    const/4 v9, 0x3

    aget-object v6, v6, v9

    move/from16 p2, v9

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxBytes()J

    move-result-wide v9

    invoke-virtual {v6, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v6, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v6, v6, p2

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v9

    invoke-virtual {v6, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v9

    invoke-virtual {v13, v2, v9, v10}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v9

    add-long v19, v19, v9

    goto :goto_6

    :cond_7
    move-object/from16 v5, v24

    :goto_6
    if-eqz v11, :cond_d

    if-nez p1, :cond_d

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    if-nez v2, :cond_d

    iget-object v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    mul-long v9, v3, v17

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v24

    div-long v37, v24, v17

    cmp-long v2, v37, v30

    if-lez v2, :cond_8

    iget-object v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :cond_8
    iget-object v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v24

    div-long v39, v24, v17

    cmp-long v2, v39, v30

    if-lez v2, :cond_9

    iget-object v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :cond_9
    move/from16 v2, v16

    move-wide/from16 v41, v30

    :goto_7
    const/4 v6, 0x5

    if-ge v2, v6, :cond_c

    iget-object v6, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v6, v6, v2

    if-eqz v6, :cond_b

    invoke-virtual {v6, v9, v10}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v24

    div-long v24, v24, v17

    cmp-long v6, v24, v30

    if-lez v6, :cond_a

    iget-object v6, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v6, v6, v2

    invoke-virtual {v6, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    :cond_a
    add-long v41, v41, v24

    :cond_b
    add-int/lit8 v2, v2, 0x1

    goto :goto_7

    :cond_c
    iget v2, v5, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    iget-object v5, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getRxPackets()J

    move-result-wide v33

    invoke-virtual/range {v23 .. v23}, Landroid/net/NetworkStats$Entry;->getTxPackets()J

    move-result-wide v35

    move-object/from16 v32, v5

    invoke-virtual/range {v32 .. v42}, Lcom/android/server/power/stats/WifiPowerCalculator;->calcPowerWithoutControllerDataMah(JJJJJ)D

    move-result-wide v5

    invoke-virtual {v11, v2, v5, v6}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    :cond_d
    move-wide/from16 v9, v30

    goto/16 :goto_3

    :cond_e
    move-wide/from16 v30, v9

    :goto_8
    move-wide/from16 v3, p5

    goto :goto_9

    :cond_f
    move-wide/from16 v30, v9

    move-wide/from16 v19, v30

    move-wide/from16 v21, v19

    goto :goto_8

    :goto_9
    if-eqz p1, :cond_22

    const/4 v0, 0x1

    :try_start_1
    iput-boolean v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerTxDurationMillis()J

    move-result-wide v26

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerRxDurationMillis()J

    move-result-wide v24

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerScanDurationMillis()J

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerIdleDurationMillis()J

    move-result-wide v28

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_1

    move/from16 v2, v16

    move-wide/from16 v5, v30

    move-wide/from16 v32, v5

    :goto_a
    if-ge v2, v0, :cond_10

    const-wide/16 v34, 0x0

    :try_start_2
    iget-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v9, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v10, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    move-wide/from16 v36, v5

    mul-long v5, v3, v17

    invoke-virtual {v10, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v38

    div-long v38, v38, v17

    add-long v36, v36, v38

    iget-object v9, v9, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v9, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    div-long v5, v5, v17

    add-long v32, v32, v5

    add-int/lit8 v2, v2, 0x1

    move-wide/from16 v5, v36

    goto :goto_a

    :cond_10
    move-wide/from16 v36, v5

    const-wide/16 v34, 0x0

    move/from16 v2, v16

    move-wide/from16 v9, v24

    move-wide/from16 v5, v26

    :goto_b
    if-ge v2, v0, :cond_17

    move/from16 p2, v0

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v0, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move/from16 v23, v2

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    move-wide/from16 v38, v5

    mul-long v5, v3, v17

    invoke-virtual {v2, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v40

    div-long v40, v40, v17

    cmp-long v2, v40, v30

    if-lez v2, :cond_13

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    cmp-long v2, v36, v24

    if-lez v2, :cond_11

    mul-long v42, v24, v40

    div-long v42, v42, v36

    move-wide/from16 v47, v42

    move-wide/from16 v42, v9

    move-wide/from16 v9, v47

    goto :goto_c

    :cond_11
    move-wide/from16 v42, v9

    move-wide/from16 v9, v40

    :goto_c
    cmp-long v2, v36, v26

    if-lez v2, :cond_12

    mul-long v40, v40, v26

    div-long v40, v40, v36

    :cond_12
    move-wide/from16 v7, v40

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v14, v2, v9, v10}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    iget v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v15, v2, v7, v8}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    sub-long v40, v42, v9

    sub-long v38, v38, v7

    move-wide/from16 v43, v40

    move-wide/from16 v41, v9

    move-wide/from16 v9, v43

    move-wide/from16 v43, v7

    goto :goto_d

    :cond_13
    move-wide/from16 v42, v9

    move-wide/from16 v43, v40

    move-wide/from16 v41, v43

    :goto_d
    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v5, v6}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v5

    div-long v5, v5, v17

    cmp-long v2, v5, v30

    if-lez v2, :cond_15

    iget-object v2, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    mul-long v5, v5, v28

    div-long v5, v5, v32

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateWifiControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    move-result-object v2

    iget-object v7, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-nez v7, :cond_14

    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->createTimeMultiStateCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v7

    iput-object v7, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_14
    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-static {v2, v5, v6, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    move-wide/from16 v45, v5

    goto :goto_e

    :cond_15
    move-wide/from16 v45, v30

    :goto_e
    if-eqz v11, :cond_16

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    move-object/from16 v40, v2

    invoke-virtual/range {v40 .. v46}, Lcom/android/server/power/stats/WifiPowerCalculator;->calcPowerFromControllerDataMah(JJJ)D

    move-result-wide v5

    iget v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUid:I

    invoke-virtual {v11, v0, v5, v6}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    :cond_16
    add-int/lit8 v2, v23, 0x1

    move/from16 v0, p2

    move-wide/from16 v5, v38

    goto/16 :goto_b

    :cond_17
    move-wide/from16 v38, v5

    move-wide/from16 v42, v9

    cmp-long v0, v19, v30

    if-eqz v0, :cond_18

    cmp-long v0, v38, v30

    if-eqz v0, :cond_18

    move/from16 v0, v16

    :goto_f
    invoke-virtual {v13}, Landroid/util/SparseLongArray;->size()I

    move-result v2

    if-ge v0, v2, :cond_18

    invoke-virtual {v13, v0}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v2

    invoke-virtual {v13, v0}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v5

    mul-long v5, v5, v38

    div-long v5, v5, v19

    invoke-virtual {v15, v2, v5, v6}, Landroid/util/SparseLongArray;->incrementValue(IJ)V

    add-int/lit8 v0, v0, 0x1

    goto :goto_f

    :cond_18
    cmp-long v0, v21, v30

    if-eqz v0, :cond_19

    cmp-long v0, v42, v30

    if-eqz v0, :cond_19

    move/from16 v0, v16

    :goto_10
    invoke-virtual {v12}, Landroid/util/SparseLongArray;->size()I

    move-result v2

    if-ge v0, v2, :cond_19

    invoke-virtual {v12, v0}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v2

    invoke-virtual {v12, v0}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v5

    mul-long v5, v5, v42

    div-long v5, v5, v21

    invoke-virtual {v14, v2, v5, v6}, Landroid/util/SparseLongArray;->incrementValue(IJ)V
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    add-int/lit8 v0, v0, 0x1

    goto :goto_10

    :cond_19
    move/from16 v0, v16

    :goto_11
    :try_start_3
    invoke-virtual {v15}, Landroid/util/SparseLongArray;->size()I

    move-result v2
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    if-ge v0, v2, :cond_1b

    :try_start_4
    invoke-virtual {v15, v0}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v2

    invoke-virtual {v15, v0}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v7

    move-wide/from16 v5, p7

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v9

    move-wide v12, v3

    invoke-virtual {v9}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateWifiControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    move-result-object v3

    invoke-static {v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v3

    aget-object v3, v3, v16

    invoke-static {v3, v7, v8, v12, v13}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    if-eqz v11, :cond_1a

    iget-object v3, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    const-wide/16 v4, 0x0

    move-wide v6, v7

    const-wide/16 v8, 0x0

    invoke-virtual/range {v3 .. v9}, Lcom/android/server/power/stats/WifiPowerCalculator;->calcPowerFromControllerDataMah(JJJ)D

    move-result-wide v3

    invoke-virtual {v11, v2, v3, v4}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V
    :try_end_4
    .catchall {:try_start_4 .. :try_end_4} :catchall_0

    :cond_1a
    add-int/lit8 v0, v0, 0x1

    move-wide v3, v12

    goto :goto_11

    :cond_1b
    move/from16 v0, v16

    :goto_12
    move-wide v12, v3

    :try_start_5
    invoke-virtual {v14}, Landroid/util/SparseLongArray;->size()I

    move-result v2

    if-ge v0, v2, :cond_1d

    invoke-virtual {v14, v0}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v7

    invoke-virtual {v14, v0}, Landroid/util/SparseLongArray;->valueAt(I)J

    move-result-wide v8

    invoke-virtual {v14, v0}, Landroid/util/SparseLongArray;->keyAt(I)I

    move-result v2

    move-wide/from16 v5, p7

    move-wide v3, v12

    invoke-virtual/range {v1 .. v6}, Lcom/android/server/power/stats/BatteryStatsImpl;->getUidStatsLocked(IJJ)Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    move-result-object v2
    :try_end_5
    .catchall {:try_start_5 .. :try_end_5} :catchall_1

    move-object v10, v1

    :try_start_6
    invoke-virtual {v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->getOrCreateWifiControllerActivityLocked()Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    move-result-object v1

    invoke-static {v1}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v1

    invoke-static {v1, v8, v9, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    if-eqz v11, :cond_1c

    iget-object v1, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    const-wide/16 v39, 0x0

    const-wide/16 v41, 0x0

    move-object/from16 v36, v1

    move-wide/from16 v37, v8

    invoke-virtual/range {v36 .. v42}, Lcom/android/server/power/stats/WifiPowerCalculator;->calcPowerFromControllerDataMah(JJJ)D

    move-result-wide v1

    invoke-virtual {v11, v7, v1, v2}, Landroid/util/SparseDoubleArray;->incrementValue(ID)V

    :cond_1c
    add-int/lit8 v0, v0, 0x1

    move-object v1, v10

    goto :goto_12

    :catchall_1
    move-exception v0

    move-object v10, v1

    goto/16 :goto_17

    :cond_1d
    move-object v10, v1

    move-wide v3, v12

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateRxTimeCounter(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v0

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerRxDurationMillis()J

    move-result-wide v1

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-static {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->-$$Nest$mgetOrCreateTxTimeCounters(Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;)[Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v0

    aget-object v0, v0, v16

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerTxDurationMillis()J

    move-result-wide v1

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mScanTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerScanDurationMillis()J

    move-result-wide v1

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-nez v1, :cond_1e

    invoke-virtual {v0}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->createTimeMultiStateCounter()Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    move-result-object v1

    iput-object v1, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    :cond_1e
    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerIdleDurationMillis()J

    move-result-wide v1

    invoke-static {v0, v1, v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->-$$Nest$mincrement(Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;JJ)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerProfile:Lcom/android/internal/os/PowerProfile;

    const-string/jumbo v1, "wifi.controller.voltage"

    invoke-virtual {v0, v1}, Lcom/android/internal/os/PowerProfile;->getAveragePower(Ljava/lang/String;)D

    move-result-wide v0

    const-wide v5, 0x408f400000000000L    # 1000.0

    div-double/2addr v0, v5

    cmpl-double v2, v0, v34

    if-eqz v2, :cond_1f

    invoke-virtual/range {p1 .. p1}, Landroid/os/connectivity/WifiActivityEnergyInfo;->getControllerEnergyUsedMicroJoules()J

    move-result-wide v5

    long-to-double v5, v5

    div-double/2addr v5, v0

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mPowerDrainMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    double-to-long v7, v5

    invoke-virtual {v2, v7, v8}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    move-wide v7, v5

    goto :goto_13

    :cond_1f
    move-wide/from16 v7, v34

    :goto_13
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    if-eqz v2, :cond_20

    invoke-virtual {v2}, Lcom/android/internal/os/RailStats;->getWifiTotalEnergyUseduWs()J

    move-result-wide v5

    long-to-double v5, v5

    div-double/2addr v5, v0

    double-to-long v0, v5

    goto :goto_14

    :cond_20
    move-wide/from16 v0, v30

    :goto_14
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->mMonitoredRailChargeConsumedMaMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    invoke-virtual {v2, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->addCountLocked(J)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    long-to-double v0, v0

    const-wide v12, 0x414b774000000000L    # 3600000.0

    div-double v5, v0, v12

    move-object v0, v2

    move-wide v1, v3

    move-wide/from16 v3, p7

    invoke-virtual/range {v0 .. v6}, Lcom/android/internal/os/BatteryStatsHistory;->recordWifiConsumedCharge(JJD)V

    move-wide v3, v1

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mTmpRailStats:Lcom/android/internal/os/RailStats;

    if-eqz v0, :cond_21

    invoke-virtual {v0}, Lcom/android/internal/os/RailStats;->resetWifiTotalEnergyUsed()V

    :cond_21
    if-eqz v11, :cond_23

    div-double/2addr v7, v12

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    move-object/from16 v23, v0

    invoke-virtual/range {v23 .. v29}, Lcom/android/server/power/stats/WifiPowerCalculator;->calcPowerFromControllerDataMah(JJJ)D

    move-result-wide v0

    invoke-static {v7, v8, v0, v1}, Ljava/lang/Math;->max(DD)D

    move-result-wide v0

    goto :goto_15

    :cond_22
    move-object v10, v1

    const-wide/16 v34, 0x0

    :cond_23
    move-wide/from16 v0, v34

    :goto_15
    if-eqz v11, :cond_25

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    const/4 v5, 0x4

    move-wide/from16 v7, p3

    invoke-virtual {v2, v5, v7, v8}, Lcom/android/internal/power/EnergyConsumerStats;->updateStandardBucket(IJ)V

    iget-boolean v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    if-nez v2, :cond_24

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    mul-long v1, v3, v17

    invoke-virtual {v0, v1, v2}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->getTimeSinceMarkLocked(J)J

    move-result-wide v0

    div-long v0, v0, v17

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v4}, Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;->setMark(J)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiPowerCalculator:Lcom/android/server/power/stats/WifiPowerCalculator;

    iget-object v2, v2, Lcom/android/server/power/stats/WifiPowerCalculator;->mPowerOnPowerEstimator:Lcom/android/server/power/stats/UsageBasedPowerEstimator;

    iget-wide v5, v2, Lcom/android/server/power/stats/UsageBasedPowerEstimator;->mAveragePowerMahPerMs:D

    long-to-double v0, v0

    mul-double/2addr v0, v5

    :cond_24
    const/4 v2, 0x4

    move-wide v5, v7

    move-wide v8, v3

    move-wide v3, v5

    move-wide v6, v0

    move-object v1, v10

    move-object v5, v11

    invoke-virtual/range {v1 .. v9}, Lcom/android/server/power/stats/BatteryStatsImpl;->distributeEnergyToUidsLocked(IJLandroid/util/SparseDoubleArray;DJ)V

    :cond_25
    monitor-exit p0

    return-void

    :cond_26
    :goto_16
    monitor-exit p0

    return-void

    :goto_17
    monitor-exit p0
    :try_end_6
    .catchall {:try_start_6 .. :try_end_6} :catchall_0

    throw v0
.end method

.method public final updateWifiState(Landroid/os/connectivity/WifiActivityEnergyInfo;JJJLandroid/app/usage/NetworkStatsManager;)V
    .locals 2

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiNetworkLock:Ljava/lang/Object;

    monitor-enter v1

    :try_start_0
    invoke-virtual {p0, p8}, Lcom/android/server/power/stats/BatteryStatsImpl;->readWifiNetworkStatsLocked(Landroid/app/usage/NetworkStatsManager;)Landroid/net/NetworkStats;

    move-result-object p8

    if-eqz p8, :cond_0

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWifiNetworkStats:Landroid/net/NetworkStats;

    invoke-virtual {p0, p8, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->networkStatsDelta(Landroid/net/NetworkStats;Landroid/net/NetworkStats;)Landroid/net/NetworkStats;

    move-result-object v0

    iput-object p8, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWifiNetworkStats:Landroid/net/NetworkStats;

    goto :goto_0

    :catchall_0
    move-exception v0

    move-object p0, v0

    goto :goto_1

    :cond_0
    const/4 v0, 0x0

    :goto_0
    monitor-exit v1
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-wide p7, p6

    move-wide p5, p4

    move-wide p3, p2

    move-object p2, v0

    invoke-virtual/range {p0 .. p8}, Lcom/android/server/power/stats/BatteryStatsImpl;->updateWifiBatteryStats(Landroid/os/connectivity/WifiActivityEnergyInfo;Landroid/net/NetworkStats;JJJ)V

    return-void

    :goto_1
    :try_start_1
    monitor-exit v1
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    throw p0
.end method

.method public final writeAsyncLocked()V
    .locals 2

    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;

    move-result-object v0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteAsyncRunnable:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;

    move-result-object v0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteAsyncRunnable:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    invoke-virtual {v0, p0}, Landroid/os/Handler;->post(Ljava/lang/Runnable;)Z

    return-void
.end method

.method public final writeDailyItemsLocked(Lcom/android/modules/utils/TypedXmlSerializer;)V
    .locals 13

    new-instance v0, Ljava/lang/StringBuilder;

    const/16 v1, 0x40

    invoke-direct {v0, v1}, Ljava/lang/StringBuilder;-><init>(I)V

    sget-object v1, Ljava/lang/Boolean;->TRUE:Ljava/lang/Boolean;

    const/4 v2, 0x0

    invoke-interface {p1, v2, v1}, Lcom/android/modules/utils/TypedXmlSerializer;->startDocument(Ljava/lang/String;Ljava/lang/Boolean;)V

    const-string/jumbo v1, "daily-items"

    invoke-interface {p1, v2, v1}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    const/4 v3, 0x0

    move v4, v3

    :goto_0
    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v5}, Ljava/util/ArrayList;->size()I

    move-result v5

    if-ge v4, v5, :cond_3

    iget-object v5, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyItems:Ljava/util/ArrayList;

    invoke-virtual {v5, v4}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v5

    check-cast v5, Landroid/os/BatteryStats$DailyItem;

    const-string/jumbo v6, "item"

    invoke-interface {p1, v2, v6}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    iget-wide v7, v5, Landroid/os/BatteryStats$DailyItem;->mStartTime:J

    const-string/jumbo v9, "start"

    invoke-interface {p1, v2, v9, v7, v8}, Lcom/android/modules/utils/TypedXmlSerializer;->attributeLong(Ljava/lang/String;Ljava/lang/String;J)Lorg/xmlpull/v1/XmlSerializer;

    const-string/jumbo v7, "end"

    iget-wide v8, v5, Landroid/os/BatteryStats$DailyItem;->mEndTime:J

    invoke-interface {p1, v2, v7, v8, v9}, Lcom/android/modules/utils/TypedXmlSerializer;->attributeLong(Ljava/lang/String;Ljava/lang/String;J)Lorg/xmlpull/v1/XmlSerializer;

    const-string/jumbo v7, "dis"

    iget-object v8, v5, Landroid/os/BatteryStats$DailyItem;->mDischargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-static {p1, v7, v8, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeDailyLevelSteps(Lcom/android/modules/utils/TypedXmlSerializer;Ljava/lang/String;Landroid/os/BatteryStats$LevelStepTracker;Ljava/lang/StringBuilder;)V

    const-string/jumbo v7, "chg"

    iget-object v8, v5, Landroid/os/BatteryStats$DailyItem;->mChargeSteps:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-static {p1, v7, v8, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeDailyLevelSteps(Lcom/android/modules/utils/TypedXmlSerializer;Ljava/lang/String;Landroid/os/BatteryStats$LevelStepTracker;Ljava/lang/StringBuilder;)V

    iget-object v7, v5, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    if-eqz v7, :cond_2

    move v7, v3

    :goto_1
    iget-object v8, v5, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v8}, Ljava/util/ArrayList;->size()I

    move-result v8

    if-ge v7, v8, :cond_2

    iget-object v8, v5, Landroid/os/BatteryStats$DailyItem;->mPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v8, v7}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Landroid/os/BatteryStats$PackageChange;

    iget-object v9, v8, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    if-nez v9, :cond_0

    const-string v9, "BatteryStatsImpl"

    const-string/jumbo v10, "There was an issue while writing the package name in internal storage."

    invoke-static {v9, v10}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    const-string/jumbo v9, "NULL"

    iput-object v9, v8, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    :cond_0
    iget-boolean v9, v8, Landroid/os/BatteryStats$PackageChange;->mUpdate:Z

    const-string/jumbo v10, "pkg"

    if-eqz v9, :cond_1

    const-string/jumbo v9, "upd"

    invoke-interface {p1, v2, v9}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    iget-object v11, v8, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    invoke-interface {p1, v2, v10, v11}, Lcom/android/modules/utils/TypedXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    const-string/jumbo v10, "ver"

    iget-wide v11, v8, Landroid/os/BatteryStats$PackageChange;->mVersionCode:J

    invoke-interface {p1, v2, v10, v11, v12}, Lcom/android/modules/utils/TypedXmlSerializer;->attributeLong(Ljava/lang/String;Ljava/lang/String;J)Lorg/xmlpull/v1/XmlSerializer;

    invoke-interface {p1, v2, v9}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    goto :goto_2

    :cond_1
    const-string/jumbo v9, "rem"

    invoke-interface {p1, v2, v9}, Lcom/android/modules/utils/TypedXmlSerializer;->startTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    iget-object v8, v8, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    invoke-interface {p1, v2, v10, v8}, Lcom/android/modules/utils/TypedXmlSerializer;->attribute(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    invoke-interface {p1, v2, v9}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    :goto_2
    add-int/lit8 v7, v7, 0x1

    goto :goto_1

    :cond_2
    invoke-interface {p1, v2, v6}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    add-int/lit8 v4, v4, 0x1

    goto/16 :goto_0

    :cond_3
    invoke-interface {p1, v2, v1}, Lcom/android/modules/utils/TypedXmlSerializer;->endTag(Ljava/lang/String;Ljava/lang/String;)Lorg/xmlpull/v1/XmlSerializer;

    invoke-interface {p1}, Lcom/android/modules/utils/TypedXmlSerializer;->endDocument()V

    return-void
.end method

.method public final writeParcelToFileLocked(Landroid/os/Parcel;Landroid/util/AtomicFile;)V
    .locals 6

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;

    invoke-virtual {v0}, Ljava/util/concurrent/locks/ReentrantLock;->lock()V

    const/4 v0, 0x0

    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v1

    invoke-virtual {p2}, Landroid/util/AtomicFile;->startWrite()Ljava/io/FileOutputStream;

    move-result-object v0

    invoke-virtual {p1}, Landroid/os/Parcel;->marshall()[B

    move-result-object p1

    invoke-virtual {v0, p1}, Ljava/io/FileOutputStream;->write([B)V

    invoke-virtual {v0}, Ljava/io/FileOutputStream;->flush()V

    invoke-virtual {p2, v0}, Landroid/util/AtomicFile;->finishWrite(Ljava/io/FileOutputStream;)V

    iget-object p1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mFrameworkStatsLogger:Lcom/android/server/power/stats/BatteryStatsImpl$FrameworkStatsLogger;

    const-string/jumbo v3, "batterystats"

    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    move-result-wide v4

    sub-long/2addr v4, v1

    invoke-virtual {p1}, Ljava/lang/Object;->getClass()Ljava/lang/Class;

    invoke-static {v3, v4, v5}, Lcom/android/internal/logging/EventLogTags;->writeCommitSysConfigFile(Ljava/lang/String;J)V
    :try_end_0
    .catch Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;

    invoke-virtual {p0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V

    return-void

    :catchall_0
    move-exception p1

    goto :goto_0

    :catch_0
    move-exception p1

    :try_start_1
    const-string v1, "BatteryStatsImpl"

    const-string v2, "Error writing battery statistics"

    invoke-static {v1, v2, p1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I

    invoke-virtual {p2, v0}, Landroid/util/AtomicFile;->failWrite(Ljava/io/FileOutputStream;)V
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;

    invoke-virtual {p0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V

    return-void

    :goto_0
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteLock:Ljava/util/concurrent/locks/ReentrantLock;

    invoke-virtual {p0}, Ljava/util/concurrent/locks/ReentrantLock;->unlock()V

    throw p1
.end method

.method public final writeSummaryToParcel(Landroid/os/Parcel;Z)V
    .locals 21

    move-object/from16 v1, p0

    move-object/from16 v3, p1

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->pullPendingStateUpdatesLocked()V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getStartClockTime()J

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->uptimeMillis()J

    move-result-wide v4

    const-wide/16 v8, 0x3e8

    mul-long/2addr v4, v8

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v0}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v6

    mul-long/2addr v6, v8

    const v0, 0x1000d7

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    move/from16 v2, p2

    invoke-virtual {v0, v3, v2}, Lcom/android/internal/os/BatteryStatsHistory;->writeSummaryToParcel(Landroid/os/Parcel;Z)V

    iget v0, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartCount:I

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v0, 0x0

    invoke-virtual {v1, v4, v5, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->computeUptime(JI)J

    move-result-wide v10

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    invoke-virtual {v1, v6, v7, v0}, Lcom/android/server/power/stats/BatteryStatsImpl;->computeRealtime(JI)J

    move-result-wide v10

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartClockTimeMs:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicStartTime:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMonotonicClock:Lcom/android/internal/os/MonotonicClock;

    invoke-virtual {v2}, Lcom/android/internal/os/MonotonicClock;->monotonicTime()J

    move-result-wide v10

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mStartPlatformVersion:Ljava/lang/String;

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEndPlatformVersion:Ljava/lang/String;

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->writeSummaryToParcel(Landroid/os/Parcel;JJ)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryScreenOffTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->writeSummaryToParcel(Landroid/os/Parcel;JJ)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeUnplugLevel:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargePlugLevel:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCurrentLevel:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryLevel:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEstimatedBatteryCapacityMah:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastLearnedBatteryCapacityUah:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMinLearnedBatteryCapacityUah:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMaxLearnedBatteryCapacityUah:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getLowDischargeAmountSinceCharge()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getHighDischargeAmountSinceCharge()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeAmountScreenOnSinceCharge()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeAmountScreenOffSinceCharge()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getDischargeAmountScreenDozeSinceCharge()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mProtectBatteryMode:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryPermil()I

    move-result v2

    invoke-virtual {v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->getBatteryCCInfo()I

    move-result v10

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargePermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelPermil:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isOnState(I)Z

    move-result v13

    invoke-virtual {v1, v11, v12, v2, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getScreenDischargeAmount(IIIZ)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargePermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelPermil:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isOffState(I)Z

    move-result v13

    invoke-virtual {v1, v11, v12, v2, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getScreenDischargeAmount(IIIZ)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenDozeSinceChargePermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeUnplugLevelPermil:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isDozeState(I)Z

    move-result v13

    invoke-virtual {v1, v11, v12, v2, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getScreenDischargeAmount(IIIZ)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenOnSinceChargePermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSubScreenOnUnplugLevelPermil:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isOnState(I)Z

    move-result v13

    invoke-virtual {v1, v11, v12, v2, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getScreenDischargeAmount(IIIZ)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSubScreenDozeSinceChargePermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSubScreenDozeUnplugLevelPermil:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isDozeState(I)Z

    move-result v13

    invoke-virtual {v1, v11, v12, v2, v13}, Lcom/android/server/power/stats/BatteryStatsImpl;->getScreenDischargeAmount(IIIZ)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOnSinceChargeCoulombCounter:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOnUnplugLevelCoulombCounter:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isOnState(I)Z

    move-result v13

    monitor-enter p0

    :try_start_0
    iget-boolean v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v14, :cond_0

    if-eqz v13, :cond_0

    if-ge v10, v12, :cond_0

    sub-int/2addr v12, v10

    add-int/2addr v11, v12

    :cond_0
    monitor-exit p0
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_1

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountScreenOffSinceChargeCoulombCounter:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffUnplugLevelCoulombCounter:I

    iget v13, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v13}, Landroid/view/Display;->isOffState(I)Z

    move-result v13

    monitor-enter p0

    :try_start_1
    iget-boolean v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBattery:Z

    if-eqz v14, :cond_1

    if-eqz v13, :cond_1

    if-ge v10, v12, :cond_1

    sub-int/2addr v12, v10

    add-int/2addr v11, v12

    :cond_1
    monitor-exit p0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_0

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOnSinceChargePermil:I

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOnUnplugLevelPermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v12}, Landroid/view/Display;->isOnState(I)Z

    move-result v12

    invoke-virtual {v1, v10, v11, v2, v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->getSilentScreenDischargeAmount(IIIZ)I

    move-result v10

    invoke-virtual {v3, v10}, Landroid/os/Parcel;->writeInt(I)V

    iget v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeAmountSilentOnScreenOffSinceChargePermil:I

    iget v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeSilentOnScreenOffUnplugLevelPermil:I

    iget v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenState:I

    invoke-static {v12}, Landroid/view/Display;->isOnState(I)Z

    move-result v12

    const/4 v13, 0x1

    xor-int/2addr v12, v13

    invoke-virtual {v1, v10, v11, v2, v12}, Lcom/android/server/power/stats/BatteryStatsImpl;->getSilentScreenDischargeAmount(IIIZ)I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v2, v3}, Landroid/os/BatteryStats$LevelStepTracker;->writeToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v2, v3}, Landroid/os/BatteryStats$LevelStepTracker;->writeToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyDischargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v2, v3}, Landroid/os/BatteryStats$LevelStepTracker;->writeToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyChargeStepTracker:Landroid/os/BatteryStats$LevelStepTracker;

    invoke-virtual {v2, v3}, Landroid/os/BatteryStats$LevelStepTracker;->writeToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenOffCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeScreenDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeLightDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDischargeDeepDozeCounter:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    if-eqz v2, :cond_2

    invoke-virtual {v2}, Ljava/util/ArrayList;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v10, v0

    :goto_0
    if-ge v10, v2, :cond_3

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyPackageChanges:Ljava/util/ArrayList;

    invoke-virtual {v11, v10}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/os/BatteryStats$PackageChange;

    iget-object v12, v11, Landroid/os/BatteryStats$PackageChange;->mPackageName:Ljava/lang/String;

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-boolean v12, v11, Landroid/os/BatteryStats$PackageChange;->mUpdate:Z

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-wide v11, v11, Landroid/os/BatteryStats$PackageChange;->mVersionCode:J

    invoke-virtual {v3, v11, v12}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v10, v10, 0x1

    goto :goto_0

    :cond_2
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_3
    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDailyStartTimeMs:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMinDailyDeadlineMs:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNextMaxDailyDeadlineMs:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBatteryTimeToFullSeconds:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mEnergyConsumerStatsConfig:Lcom/android/internal/power/EnergyConsumerStats$Config;

    invoke-static {v2, v3}, Lcom/android/internal/power/EnergyConsumerStats$Config;->writeToParcel(Lcom/android/internal/power/EnergyConsumerStats$Config;Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    invoke-static {v2, v3}, Lcom/android/internal/power/EnergyConsumerStats;->writeSummaryToParcel(Lcom/android/internal/power/EnergyConsumerStats;Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_1
    const/4 v10, 0x5

    if-ge v2, v10, :cond_4

    iget-object v10, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v10, v10, v2

    invoke-virtual {v10, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_1

    :cond_4
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    array-length v2, v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v11, v0

    :goto_2
    if-ge v11, v2, :cond_6

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerDisplayBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;

    aget-object v12, v12, v11

    iget-object v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v14, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v14, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v14, v0

    :goto_3
    if-ge v14, v10, :cond_5

    iget-object v15, v12, Lcom/android/server/power/stats/BatteryStatsImpl$DisplayBatteryStats;->screenBrightnessTimers:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v15, v15, v14

    invoke-virtual {v15, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v14, v14, 0x1

    goto :goto_3

    :cond_5
    add-int/lit8 v11, v11, 0x1

    goto :goto_2

    :cond_6
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenDozeTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_4
    if-ge v2, v10, :cond_7

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v11, v11, v2

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_4

    :cond_7
    move v2, v0

    :goto_5
    if-ge v2, v10, :cond_8

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v11, v11, v2

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_5

    :cond_8
    move v2, v0

    :goto_6
    if-ge v2, v10, :cond_9

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenAutoBrightnessTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v11, v11, v2

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_6

    :cond_9
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSubScreenHighBrightnessTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_7
    const/4 v11, 0x4

    if-ge v2, v11, :cond_a

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMainDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v11, v11, v2

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_7

    :cond_a
    move v2, v0

    :goto_8
    if-ge v2, v11, :cond_b

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCoverDisplayHrrTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v12, v12, v2

    invoke-virtual {v12, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_8

    :cond_b
    move v2, v0

    :goto_9
    const/16 v11, 0x10

    if-ge v2, v11, :cond_c

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v11, v11, v2

    iget-wide v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v11, v12}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSpeakerCallTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v11, v11, v2

    iget-wide v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v11, v12}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_9

    :cond_c
    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasSpeakerOutReporting:Z

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-wide v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mTxPowerSharingDischargeMah:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileActive5GTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mSilentLogOnScreenOffTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOnGpsTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-eqz v2, :cond_d

    array-length v2, v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v2, v0

    :goto_a
    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    array-length v14, v12

    if-ge v2, v14, :cond_e

    aget-object v12, v12, v2

    invoke-static {v3, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->writeSummaryToParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_a

    :cond_d
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_e
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    if-eqz v2, :cond_f

    array-length v2, v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v2, v0

    :goto_b
    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffKernelCpuSpeedTimeMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    array-length v14, v12

    if-ge v2, v14, :cond_10

    aget-object v12, v12, v2

    invoke-static {v3, v12}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->writeSummaryToParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_b

    :cond_f
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_10
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mInteractiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPowerSaveModeEnabledTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-wide v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestLightIdleTimeMs:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v14, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mLongestFullIdleTimeMs:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeLightTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdleModeFullTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceLightIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mDeviceIdlingTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_c
    sget v12, Lcom/android/server/power/stats/BatteryStatsImpl;->CELL_SIGNAL_STRENGTH_LEVEL_COUNT:I

    if-ge v2, v12, :cond_11

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v12, v12, v2

    invoke-virtual {v12, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_c

    :cond_11
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneSignalScanningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_d
    sget v12, Landroid/os/BatteryStats;->NUM_DATA_CONNECTION_TYPES:I

    if-ge v2, v12, :cond_12

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPhoneDataConnectionsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v12, v12, v2

    invoke-virtual {v12, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_d

    :cond_12
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNrNsaTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_e
    const/16 v12, 0xa

    if-ge v2, v12, :cond_13

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v12, v12, v2

    iget-wide v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v12, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v12, v12, v2

    iget-wide v14, v12, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_e

    :cond_13
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    array-length v2, v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v14, v0

    :goto_f
    if-ge v14, v2, :cond_1c

    iget-object v15, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mPerRatBatteryStats:[Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;

    aget-object v15, v15, v14

    if-nez v15, :cond_14

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    move-wide/from16 v16, v8

    move/from16 v18, v14

    goto/16 :goto_16

    :cond_14
    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    move-wide/from16 v16, v8

    iget-object v8, v15, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->perStateTimers:[[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v9, v8

    invoke-virtual {v3, v9}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v3, v10}, Landroid/os/Parcel;->writeInt(I)V

    move v12, v0

    :goto_10
    if-ge v12, v9, :cond_16

    move v11, v0

    :goto_11
    if-ge v11, v10, :cond_15

    aget-object v18, v8, v12

    aget-object v10, v18, v11

    invoke-virtual {v10, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v11, v11, 0x1

    const/4 v10, 0x5

    goto :goto_11

    :cond_15
    add-int/lit8 v12, v12, 0x1

    const/4 v10, 0x5

    const/16 v11, 0x10

    goto :goto_10

    :cond_16
    iget-object v8, v15, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerStateTxDurationMs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v8, :cond_18

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_17
    move/from16 v18, v14

    goto :goto_14

    :cond_18
    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    move v8, v0

    :goto_12
    if-ge v8, v9, :cond_17

    move v11, v0

    :goto_13
    const/4 v10, 0x5

    if-ge v11, v10, :cond_19

    iget-object v10, v15, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerStateTxDurationMs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v10, v10, v8

    aget-object v10, v10, v11

    move/from16 v18, v14

    iget-wide v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v11, v11, 0x1

    move/from16 v14, v18

    const/4 v13, 0x1

    goto :goto_13

    :cond_19
    move/from16 v18, v14

    add-int/lit8 v8, v8, 0x1

    const/4 v13, 0x1

    goto :goto_12

    :goto_14
    iget-object v8, v15, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerFrequencyRxDurationMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v8, :cond_1a

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_16

    :cond_1a
    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    move v8, v0

    :goto_15
    if-ge v8, v9, :cond_1b

    iget-object v10, v15, Lcom/android/server/power/stats/BatteryStatsImpl$RadioAccessTechnologyBatteryStats;->mPerFrequencyRxDurationMs:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v10, v10, v8

    iget-wide v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v10, v11}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v8, v8, 0x1

    goto :goto_15

    :cond_1b
    :goto_16
    add-int/lit8 v14, v18, 0x1

    move-wide/from16 v8, v16

    const/4 v10, 0x5

    const/16 v11, 0x10

    const/16 v12, 0xa

    const/4 v13, 0x1

    goto/16 :goto_f

    :cond_1c
    move-wide/from16 v16, v8

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActivePerAppTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveAdjustedTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v8, v9}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v8, v9}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mMobileRadioActiveUnknownCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v8, v9}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiMulticastWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGlobalWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    move v2, v0

    :goto_17
    const/16 v8, 0x8

    if-ge v2, v8, :cond_1d

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v8, v8, v2

    invoke-virtual {v8, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_17

    :cond_1d
    move v2, v0

    :goto_18
    const/16 v8, 0xd

    if-ge v2, v8, :cond_1e

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSupplStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v8, v8, v2

    invoke-virtual {v8, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_18

    :cond_1e
    move v2, v0

    :goto_19
    const/4 v10, 0x5

    if-ge v2, v10, :cond_1f

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiSignalStrengthsTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v8, v8, v2

    invoke-virtual {v8, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_19

    :cond_1f
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActiveTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWifiActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->writeSummaryToParcel(Landroid/os/Parcel;)V

    move v2, v0

    :goto_1a
    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mGpsSignalQualityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v9, v8

    if-ge v2, v9, :cond_20

    aget-object v8, v8, v2

    invoke-virtual {v8, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_1a

    :cond_20
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->writeSummaryToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ControllerActivityCounterImpl;->writeSummaryToParcel(Landroid/os/Parcel;)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNetworkModemActivity:Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;

    iget-object v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mSleepTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v8, v9}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mIdleTimeMillis:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v8, v8, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v8, v9}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v8, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mNrModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v8, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->writeSummaryToParcel(Landroid/os/Parcel;)V

    iget-object v2, v2, Lcom/android/server/power/stats/BatteryStatsImpl$ModemActivityCounterImpl;->mLcModemActivityInfo:Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$ModemTxRxCounterImpl;->writeSummaryToParcel(Landroid/os/Parcel;)V

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasWifiReporting:Z

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasBluetoothReporting:Z

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-boolean v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mHasModemReporting:Z

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mNumConnectivityChange:I

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mFlashlightOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mCameraOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mRpmStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_1b
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_22

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/util/Map$Entry;

    invoke-interface {v8}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;

    if-eqz v9, :cond_21

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-interface {v8}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v9, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_1b

    :cond_21
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_1b

    :cond_22
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenOffRpmStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_1c
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_24

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/util/Map$Entry;

    invoke-interface {v8}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;

    if-eqz v9, :cond_23

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-interface {v8}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v9, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_1c

    :cond_23
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_1c

    :cond_24
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelWakelockStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_1d
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_26

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/util/Map$Entry;

    invoke-interface {v8}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;

    if-eqz v9, :cond_25

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-interface {v8}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v9, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_1d

    :cond_25
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_1d

    :cond_26
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mWakeupReasonStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_1e
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_28

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/util/Map$Entry;

    invoke-interface {v8}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$SamplingTimer;

    if-eqz v9, :cond_27

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-interface {v8}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v9, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_1e

    :cond_27
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_1e

    :cond_28
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v2}, Landroid/util/LongSparseArray;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    move v2, v0

    :goto_1f
    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v8}, Landroid/util/LongSparseArray;->size()I

    move-result v8

    if-ge v2, v8, :cond_2a

    iget-object v8, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v8, v2}, Landroid/util/LongSparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;

    if-eqz v8, :cond_29

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v9, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mKernelMemoryStats:Landroid/util/LongSparseArray;

    invoke-virtual {v9, v2}, Landroid/util/LongSparseArray;->keyAt(I)J

    move-result-wide v9

    invoke-virtual {v3, v9, v10}, Landroid/os/Parcel;->writeLong(J)V

    invoke-virtual {v8, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_20

    :cond_29
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_20
    add-int/lit8 v2, v2, 0x1

    goto :goto_1f

    :cond_2a
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mScreenWakeStats:Ljava/util/HashMap;

    invoke-virtual {v2}, Ljava/util/HashMap;->entrySet()Ljava/util/Set;

    move-result-object v2

    invoke-interface {v2}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v2

    :goto_21
    invoke-interface {v2}, Ljava/util/Iterator;->hasNext()Z

    move-result v8

    if-eqz v8, :cond_2c

    invoke-interface {v2}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/util/Map$Entry;

    invoke-interface {v8}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v9

    check-cast v9, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-eqz v9, :cond_2b

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-interface {v8}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v8

    check-cast v8, Ljava/lang/String;

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v9, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_21

    :cond_2b
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_21

    :cond_2c
    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2}, Landroid/util/SparseArray;->size()I

    move-result v8

    invoke-virtual {v3, v8}, Landroid/os/Parcel;->writeInt(I)V

    move v9, v0

    :goto_22
    if-ge v9, v8, :cond_6a

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v9}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mUidStats:Landroid/util/SparseArray;

    invoke-virtual {v2, v9}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v2

    move-object v10, v2

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->writeSummaryToParcel(Landroid/os/Parcel;JJ)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mOnBatteryScreenOffBackgroundTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    move-object/from16 v3, p1

    invoke-virtual/range {v2 .. v7}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->writeSummaryToParcel(Landroid/os/Parcel;JJ)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v2, :cond_2d

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRunningTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_23

    :cond_2d
    const/4 v12, 0x1

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_23
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v2, :cond_2e

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFullWifiLockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_24

    :cond_2e
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_24
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v2, :cond_2f

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_25

    :cond_2f
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_25
    move v11, v0

    const/4 v2, 0x5

    :goto_26
    if-ge v11, v2, :cond_31

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v13, v13, v11

    if-eqz v13, :cond_30

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiBatchedScanTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v13, v13, v11

    invoke-virtual {v13, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_27

    :cond_30
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_27
    add-int/lit8 v11, v11, 0x1

    const/4 v12, 0x1

    goto :goto_26

    :cond_31
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiMulticastTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_32

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiMulticastTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_28

    :cond_32
    const/4 v12, 0x1

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_28
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_33

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAudioTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_29

    :cond_33
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_29
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVideoTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_34

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVideoTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2a

    :cond_34
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2a
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFlashlightTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_35

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mFlashlightTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2b

    :cond_35
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2b
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_36

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCameraTurnedOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2c

    :cond_36
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2c
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundActivityTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_37

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundActivityTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2d

    :cond_37
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2d
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v11, :cond_38

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mForegroundServiceTimer:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2e

    :cond_38
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2e
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v11, :cond_39

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mAggregatedPartialWakelockTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_2f

    :cond_39
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_2f
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    if-eqz v11, :cond_3a

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothDutyScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DutyTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_30

    :cond_3a
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_30
    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v11, :cond_3b

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/16 v11, 0x10

    goto :goto_32

    :cond_3b
    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    move v13, v0

    const/16 v11, 0x10

    :goto_31
    if-ge v13, v11, :cond_3c

    iget-object v14, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSpeakerMediaTimeCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v14, v14, v13

    iget-wide v14, v14, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v13, v13, 0x1

    goto :goto_31

    :cond_3c
    :goto_32
    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v13, :cond_3e

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v13, v13

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPerDisplayTopActivityTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    array-length v14, v13

    move v15, v0

    :goto_33
    if-ge v15, v14, :cond_3f

    aget-object v2, v13, v15

    if-eqz v2, :cond_3d

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_34

    :cond_3d
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_34
    add-int/lit8 v15, v15, 0x1

    const/4 v2, 0x5

    goto :goto_33

    :cond_3e
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_3f
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v2, :cond_40

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_35

    :cond_40
    const/4 v12, 0x1

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_35
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v2, :cond_41

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothUnoptimizedScanTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_36

    :cond_41
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_36
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-eqz v2, :cond_42

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_37

    :cond_42
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_37
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultBgCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-eqz v2, :cond_43

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mBluetoothScanResultBgCounter:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_38

    :cond_43
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_38
    move v2, v0

    :goto_39
    const/4 v13, 0x7

    if-ge v2, v13, :cond_45

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v13, v13, v2

    if-eqz v13, :cond_44

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStateTimer:[Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    aget-object v13, v13, v2

    invoke-virtual {v13, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_3a

    :cond_44
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_3a
    add-int/lit8 v2, v2, 0x1

    goto :goto_39

    :cond_45
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVibratorOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    if-eqz v2, :cond_46

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mVibratorOnTimer:Lcom/android/server/power/stats/BatteryStatsImpl$BatchTimer;

    invoke-virtual {v2, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_3b

    :cond_46
    const/4 v12, 0x1

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_3b
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    if-nez v2, :cond_47

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    goto :goto_3d

    :cond_47
    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    move v2, v0

    :goto_3c
    sget v13, Landroid/os/BatteryStats$Uid;->NUM_USER_ACTIVITY_TYPES:I

    if-ge v2, v13, :cond_48

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object v13, v13, v2

    invoke-virtual {v13, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v2, v2, 0x1

    goto :goto_3c

    :cond_48
    :goto_3d
    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-nez v2, :cond_49

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/16 v2, 0xa

    goto :goto_40

    :cond_49
    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    move v13, v0

    const/16 v2, 0xa

    :goto_3e
    if-ge v13, v2, :cond_4a

    iget-object v14, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mNetworkByteActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v14, v14, v13

    iget-wide v14, v14, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v14, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mNetworkPacketActivityCounters:[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    aget-object v14, v14, v13

    iget-wide v14, v14, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v14, v15}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v13, v13, 0x1

    goto :goto_3e

    :cond_4a
    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveTime:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-eqz v13, :cond_4b

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeBoolean(Z)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveTime:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    iget-object v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->mCounter:Lcom/android/internal/os/LongMultiStateCounter;

    invoke-virtual {v13, v3, v0}, Lcom/android/internal/os/LongMultiStateCounter;->writeToParcel(Landroid/os/Parcel;I)V

    goto :goto_3f

    :cond_4b
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeBoolean(Z)V

    :goto_3f
    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioActiveCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    :goto_40
    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUserCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSystemCpuTime:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-eqz v13, :cond_4f

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length v13, v13

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterSpeedTimesUs:[[Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    array-length v14, v13

    move v15, v0

    :goto_41
    if-ge v15, v14, :cond_50

    aget-object v2, v13, v15

    if-eqz v2, :cond_4e

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    array-length v11, v2

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    array-length v11, v2

    :goto_42
    if-ge v0, v11, :cond_4d

    move/from16 v19, v0

    aget-object v0, v2, v19

    if-eqz v0, :cond_4c

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    move-object/from16 v20, v13

    iget-wide v12, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v12, v13}, Landroid/os/Parcel;->writeLong(J)V

    const/4 v0, 0x0

    goto :goto_43

    :cond_4c
    move-object/from16 v20, v13

    const/4 v0, 0x0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_43
    add-int/lit8 v12, v19, 0x1

    move v0, v12

    move-object/from16 v13, v20

    const/4 v12, 0x1

    goto :goto_42

    :cond_4d
    move-object/from16 v20, v13

    const/4 v0, 0x0

    goto :goto_44

    :cond_4e
    move-object/from16 v20, v13

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :goto_44
    add-int/lit8 v15, v15, 0x1

    move-object/from16 v13, v20

    const/16 v2, 0xa

    const/16 v11, 0x10

    const/4 v12, 0x1

    goto :goto_41

    :cond_4f
    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    :cond_50
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v3, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->writeSummaryToParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mScreenOffCpuFreqTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    invoke-static {v3, v0}, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->writeSummaryToParcelLocked(Landroid/os/Parcel;Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuActiveTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    if-eqz v0, :cond_51

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->mCounter:Lcom/android/internal/os/LongMultiStateCounter;

    invoke-virtual {v0}, Lcom/android/internal/os/LongMultiStateCounter;->getStateCount()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuActiveTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeMultiStateCounter;->mCounter:Lcom/android/internal/os/LongMultiStateCounter;

    const/4 v2, 0x0

    invoke-virtual {v0, v3, v2}, Lcom/android/internal/os/LongMultiStateCounter;->writeToParcel(Landroid/os/Parcel;I)V

    goto :goto_45

    :cond_51
    const/4 v2, 0x0

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_45
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mCpuClusterTimesMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounterArray;->mCounts:[J

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeLongArray([J)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    if-eqz v0, :cond_52

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v0}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getStateCount()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    const/4 v2, 0x0

    invoke-virtual {v0, v3, v2}, Lcom/android/internal/os/LongArrayMultiStateCounter;->writeToParcel(Landroid/os/Parcel;I)V

    goto :goto_46

    :cond_52
    const/4 v2, 0x0

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_46
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    if-eqz v0, :cond_53

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v0}, Lcom/android/internal/os/LongArrayMultiStateCounter;->getStateCount()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcStateScreenOffTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$TimeInFreqMultiStateCounter;->mCounter:Lcom/android/internal/os/LongArrayMultiStateCounter;

    invoke-virtual {v0, v3, v2}, Lcom/android/internal/os/LongArrayMultiStateCounter;->writeToParcel(Landroid/os/Parcel;I)V

    goto :goto_47

    :cond_53
    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_47
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-eqz v0, :cond_54

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mMobileRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    goto :goto_48

    :cond_54
    const/4 v2, 0x0

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_48
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    if-eqz v0, :cond_55

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWifiRadioApWakeupCount:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    goto :goto_49

    :cond_55
    const/4 v2, 0x0

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_49
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mUidEnergyConsumerStats:Lcom/android/internal/power/EnergyConsumerStats;

    invoke-static {v0, v3}, Lcom/android/internal/power/EnergyConsumerStats;->writeSummaryToParcel(Lcom/android/internal/power/EnergyConsumerStats;Landroid/os/Parcel;)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mWakelockStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->mMap:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v11, 0x0

    :goto_4a
    if-ge v11, v2, :cond_5a

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Ljava/lang/String;

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;

    iget-object v14, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerFull:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v14, :cond_56

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v14, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerFull:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v14, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    const/4 v14, 0x0

    goto :goto_4b

    :cond_56
    const/4 v12, 0x1

    const/4 v14, 0x0

    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :goto_4b
    iget-object v15, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerPartial:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v15, :cond_57

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v15, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerPartial:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v15, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_4c

    :cond_57
    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :goto_4c
    iget-object v15, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerWindow:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v15, :cond_58

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v15, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerWindow:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v15, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_4d

    :cond_58
    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :goto_4d
    iget-object v15, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerDraw:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    if-eqz v15, :cond_59

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v13, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Wakelock;->mTimerDraw:Lcom/android/server/power/stats/BatteryStatsImpl$StopwatchTimer;

    invoke-virtual {v13, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$Timer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_4e

    :cond_59
    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :goto_4e
    add-int/lit8 v11, v11, 0x1

    goto :goto_4a

    :cond_5a
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSyncStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->mMap:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v11, 0x0

    :goto_4f
    if-ge v11, v2, :cond_5b

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Ljava/lang/String;

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v13, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v11, v11, 0x1

    goto :goto_4f

    :cond_5b
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobStats:Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;

    iget-object v0, v0, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$1;->mMap:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v2

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v11, 0x0

    :goto_50
    if-ge v11, v2, :cond_5c

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Ljava/lang/String;

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-virtual {v0, v11}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v13

    check-cast v13, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v13, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    add-int/lit8 v11, v11, 0x1

    goto :goto_50

    :cond_5c
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobCompletions:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v2, 0x0

    :goto_51
    if-ge v2, v0, :cond_5e

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobCompletions:Landroid/util/ArrayMap;

    invoke-virtual {v11, v2}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/lang/String;

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobCompletions:Landroid/util/ArrayMap;

    invoke-virtual {v11, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Landroid/util/SparseIntArray;

    invoke-virtual {v11}, Landroid/util/SparseIntArray;->size()I

    move-result v13

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v14, 0x0

    :goto_52
    if-ge v14, v13, :cond_5d

    invoke-virtual {v11, v14}, Landroid/util/SparseIntArray;->keyAt(I)I

    move-result v15

    invoke-virtual {v3, v15}, Landroid/os/Parcel;->writeInt(I)V

    invoke-virtual {v11, v14}, Landroid/util/SparseIntArray;->valueAt(I)I

    move-result v15

    invoke-virtual {v3, v15}, Landroid/os/Parcel;->writeInt(I)V

    add-int/lit8 v14, v14, 0x1

    goto :goto_52

    :cond_5d
    add-int/lit8 v2, v2, 0x1

    goto :goto_51

    :cond_5e
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredEventCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v0, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsDeferredCount:Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v0, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessTimeMs:Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;

    iget-wide v13, v0, Lcom/android/server/power/stats/BatteryStatsImpl$LongSamplingCounter;->mCount:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    const/4 v0, 0x0

    :goto_53
    sget-object v2, Landroid/os/BatteryStats;->JOB_FRESHNESS_BUCKETS:[J

    array-length v2, v2

    if-ge v0, v2, :cond_60

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object v2, v2, v0

    if-eqz v2, :cond_5f

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v2, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mJobsFreshnessBuckets:[Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    aget-object v2, v2, v0

    invoke-virtual {v2, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    goto :goto_54

    :cond_5f
    const/4 v2, 0x0

    invoke-virtual {v3, v2}, Landroid/os/Parcel;->writeInt(I)V

    :goto_54
    add-int/lit8 v0, v0, 0x1

    goto :goto_53

    :cond_60
    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSensorStats:Landroid/util/SparseArray;

    invoke-virtual {v0}, Landroid/util/SparseArray;->size()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v2, 0x0

    :goto_55
    if-ge v2, v0, :cond_62

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSensorStats:Landroid/util/SparseArray;

    invoke-virtual {v11, v2}, Landroid/util/SparseArray;->keyAt(I)I

    move-result v11

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mSensorStats:Landroid/util/SparseArray;

    invoke-virtual {v11, v2}, Landroid/util/SparseArray;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;

    iget-object v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;->mTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    if-eqz v13, :cond_61

    const/4 v12, 0x1

    invoke-virtual {v3, v12}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v11, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Sensor;->mTimer:Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;

    invoke-virtual {v11, v3, v6, v7}, Lcom/android/server/power/stats/BatteryStatsImpl$DualTimer;->writeSummaryFromParcelLocked(Landroid/os/Parcel;J)V

    goto :goto_56

    :cond_61
    const/4 v12, 0x1

    const/4 v14, 0x0

    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :goto_56
    add-int/lit8 v2, v2, 0x1

    goto :goto_55

    :cond_62
    const/4 v12, 0x1

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStats:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v2, 0x0

    :goto_57
    if-ge v2, v0, :cond_65

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStats:Landroid/util/ArrayMap;

    invoke-virtual {v11, v2}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Ljava/lang/String;

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mProcessStats:Landroid/util/ArrayMap;

    invoke-virtual {v11, v2}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v11

    check-cast v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;

    iget-wide v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mUserTimeMs:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mSystemTimeMs:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mForegroundTimeMs:J

    invoke-virtual {v3, v13, v14}, Landroid/os/Parcel;->writeLong(J)V

    iget v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mStarts:I

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    iget v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mNumCrashes:I

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    iget v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mNumAnrs:I

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    iget-object v13, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mExcessivePower:Ljava/util/ArrayList;

    if-nez v13, :cond_64

    const/4 v14, 0x0

    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    :cond_63
    move-wide/from16 v19, v6

    goto :goto_59

    :cond_64
    const/4 v14, 0x0

    invoke-virtual {v13}, Ljava/util/ArrayList;->size()I

    move-result v13

    invoke-virtual {v3, v13}, Landroid/os/Parcel;->writeInt(I)V

    move v15, v14

    :goto_58
    if-ge v15, v13, :cond_63

    iget-object v12, v11, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Proc;->mExcessivePower:Ljava/util/ArrayList;

    invoke-virtual {v12, v15}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;

    move-result-object v12

    check-cast v12, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;

    iget v14, v12, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->type:I

    invoke-virtual {v3, v14}, Landroid/os/Parcel;->writeInt(I)V

    move-wide/from16 v19, v6

    iget-wide v6, v12, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->overTime:J

    invoke-virtual {v3, v6, v7}, Landroid/os/Parcel;->writeLong(J)V

    iget-wide v6, v12, Landroid/os/BatteryStats$Uid$Proc$ExcessivePower;->usedTime:J

    invoke-virtual {v3, v6, v7}, Landroid/os/Parcel;->writeLong(J)V

    add-int/lit8 v15, v15, 0x1

    move-wide/from16 v6, v19

    const/4 v12, 0x1

    const/4 v14, 0x0

    goto :goto_58

    :goto_59
    add-int/lit8 v2, v2, 0x1

    move-wide/from16 v6, v19

    const/4 v12, 0x1

    goto :goto_57

    :cond_65
    move-wide/from16 v19, v6

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPackageStats:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->size()I

    move-result v0

    invoke-virtual {v3, v0}, Landroid/os/Parcel;->writeInt(I)V

    if-lez v0, :cond_69

    iget-object v0, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid;->mPackageStats:Landroid/util/ArrayMap;

    invoke-virtual {v0}, Landroid/util/ArrayMap;->entrySet()Ljava/util/Set;

    move-result-object v0

    invoke-interface {v0}, Ljava/util/Set;->iterator()Ljava/util/Iterator;

    move-result-object v0

    :cond_66
    invoke-interface {v0}, Ljava/util/Iterator;->hasNext()Z

    move-result v2

    if-eqz v2, :cond_69

    invoke-interface {v0}, Ljava/util/Iterator;->next()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Ljava/util/Map$Entry;

    invoke-interface {v2}, Ljava/util/Map$Entry;->getKey()Ljava/lang/Object;

    move-result-object v6

    check-cast v6, Ljava/lang/String;

    invoke-virtual {v3, v6}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    invoke-interface {v2}, Ljava/util/Map$Entry;->getValue()Ljava/lang/Object;

    move-result-object v2

    check-cast v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;

    iget-object v6, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mWakeupAlarms:Landroid/util/ArrayMap;

    invoke-virtual {v6}, Landroid/util/ArrayMap;->size()I

    move-result v6

    invoke-virtual {v3, v6}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v7, 0x0

    :goto_5a
    if-ge v7, v6, :cond_67

    iget-object v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mWakeupAlarms:Landroid/util/ArrayMap;

    invoke-virtual {v10, v7}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/lang/String;

    invoke-virtual {v3, v10}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mWakeupAlarms:Landroid/util/ArrayMap;

    invoke-virtual {v10, v7}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;

    invoke-virtual {v10, v3}, Lcom/android/server/power/stats/BatteryStatsImpl$Counter;->writeSummaryFromParcelLocked(Landroid/os/Parcel;)V

    add-int/lit8 v7, v7, 0x1

    goto :goto_5a

    :cond_67
    iget-object v6, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mServiceStats:Landroid/util/ArrayMap;

    invoke-virtual {v6}, Landroid/util/ArrayMap;->size()I

    move-result v6

    invoke-virtual {v3, v6}, Landroid/os/Parcel;->writeInt(I)V

    const/4 v7, 0x0

    :goto_5b
    if-ge v7, v6, :cond_66

    iget-object v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mServiceStats:Landroid/util/ArrayMap;

    invoke-virtual {v10, v7}, Landroid/util/ArrayMap;->keyAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Ljava/lang/String;

    invoke-virtual {v3, v10}, Landroid/os/Parcel;->writeString(Ljava/lang/String;)V

    iget-object v10, v2, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg;->mServiceStats:Landroid/util/ArrayMap;

    invoke-virtual {v10, v7}, Landroid/util/ArrayMap;->valueAt(I)Ljava/lang/Object;

    move-result-object v10

    check-cast v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;

    iget-object v11, v1, Lcom/android/server/power/stats/BatteryStatsImpl;->mOnBatteryTimeBase:Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;

    invoke-virtual {v11, v4, v5}, Lcom/android/server/power/stats/BatteryStatsImpl$TimeBase;->getUptime(J)J

    move-result-wide v11

    div-long v11, v11, v16

    iget-boolean v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mRunning:Z

    if-nez v13, :cond_68

    iget-wide v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mStartTimeMs:J

    goto :goto_5c

    :cond_68
    iget-wide v13, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mStartTimeMs:J

    add-long/2addr v13, v11

    iget-wide v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mRunningSinceMs:J

    sub-long v11, v13, v11

    :goto_5c
    invoke-virtual {v3, v11, v12}, Landroid/os/Parcel;->writeLong(J)V

    iget v11, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mStarts:I

    invoke-virtual {v3, v11}, Landroid/os/Parcel;->writeInt(I)V

    iget v10, v10, Lcom/android/server/power/stats/BatteryStatsImpl$Uid$Pkg$Serv;->mLaunches:I

    invoke-virtual {v3, v10}, Landroid/os/Parcel;->writeInt(I)V

    add-int/lit8 v7, v7, 0x1

    goto :goto_5b

    :cond_69
    add-int/lit8 v9, v9, 0x1

    move-wide/from16 v6, v19

    const/4 v0, 0x0

    goto/16 :goto_22

    :cond_6a
    return-void

    :catchall_0
    move-exception v0

    :try_start_2
    monitor-exit p0
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_0

    throw v0

    :catchall_1
    move-exception v0

    :try_start_3
    monitor-exit p0
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    throw v0
.end method

.method public final writeSyncLocked()V
    .locals 3

    invoke-static {}, Lcom/android/internal/os/BackgroundThread;->getHandler()Landroid/os/Handler;

    move-result-object v0

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mWriteAsyncRunnable:Lcom/android/server/power/stats/BatteryStatsImpl$$ExternalSyntheticLambda7;

    invoke-virtual {v0, v1}, Landroid/os/Handler;->removeCallbacks(Ljava/lang/Runnable;)V

    iget-object v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    if-nez v0, :cond_0

    const-string v0, "BatteryStatsImpl"

    const-string/jumbo v1, "writeStatsLocked: no file associated with this instance"

    invoke-static {v0, v1}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I

    goto :goto_0

    :cond_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mShuttingDown:Z

    if-eqz v0, :cond_1

    goto :goto_0

    :cond_1
    invoke-static {}, Landroid/os/Parcel;->obtain()Landroid/os/Parcel;

    move-result-object v0

    :try_start_0
    invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J

    const/4 v1, 0x0

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeSummaryToParcel(Landroid/os/Parcel;Z)V

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mClock:Lcom/android/internal/os/Clock;

    invoke-virtual {v1}, Lcom/android/internal/os/Clock;->elapsedRealtime()J

    move-result-wide v1

    iput-wide v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mLastWriteTimeMs:J

    iget-object v1, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mStatsFile:Landroid/util/AtomicFile;

    invoke-virtual {p0, v0, v1}, Lcom/android/server/power/stats/BatteryStatsImpl;->writeParcelToFileLocked(Landroid/os/Parcel;Landroid/util/AtomicFile;)V
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    invoke-virtual {v0}, Landroid/os/Parcel;->recycle()V

    :goto_0
    iget-boolean v0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mShuttingDown:Z

    if-eqz v0, :cond_2

    return-void

    :cond_2
    iget-object p0, p0, Lcom/android/server/power/stats/BatteryStatsImpl;->mHistory:Lcom/android/internal/os/BatteryStatsHistory;

    invoke-virtual {p0}, Lcom/android/internal/os/BatteryStatsHistory;->writeHistory()V

    return-void

    :catchall_0
    move-exception p0

    invoke-virtual {v0}, Landroid/os/Parcel;->recycle()V

    throw p0
.end method
